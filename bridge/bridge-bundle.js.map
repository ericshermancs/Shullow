{
  "version": 3,
  "sources": ["modules/mapUtilities.js", "modules/hijack.js", "modules/discovery.js", "modules/portal.js", "../overlays/siteConfig.js", "../overlays/OverlayRegistry.js", "main.js", "modules/ManagerBase.js", "entry.js", "modules/renderer.js"],
  "sourcesContent": ["// [SOURCE: bridge/modules/mapUtilities.js]\n/**\r\n * POI Bridge: Map Utilities Module\r\n * Provides shared utilities for map rendering across different platforms.\r\n */\r\n\r\n/**\r\n * MapUtils - Static utility methods for map operations\r\n */\r\nclass MapUtils {\r\n  /**\r\n   * Generates a fallback SVG marker icon\r\n   * @param {string} color - Primary fill color (default: #ff0000)\r\n   * @param {string} secondaryColor - Stroke color (default: #ffffff)\r\n   * @param {number} size - Size in pixels (default: 32)\r\n   * @returns {string} Data URI for the SVG\r\n   */\r\n  static generateFallbackSVG(color = '#ff0000', secondaryColor = '#ffffff', size = 32) {\r\n    const svg = `<svg width=\"${size}\" height=\"${size}\" viewBox=\"0 0 24 24\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\r\n      <path d=\"M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z\" fill=\"${color}\" stroke=\"${secondaryColor}\" stroke-width=\"1\"/>\r\n    </svg>`;\r\n    return `data:image/svg+xml;charset=utf-8,${encodeURIComponent(svg)}`;\r\n  }\r\n\r\n  /**\r\n   * Creates marker element styles as a CSS string\r\n   * @param {Object} options - Style options\r\n   * @param {string} options.backgroundImage - URL or data URI for the marker image\r\n   * @param {number} options.size - Size in pixels (default: 32)\r\n   * @param {number} options.zIndex - z-index value (default: 102)\r\n   * @returns {string} CSS style string\r\n   */\r\n  static getMarkerStyles(options = {}) {\r\n    const { backgroundImage, size = 32, zIndex = 102 } = options;\r\n    return `\r\n      position: absolute;\r\n      width: ${size}px;\r\n      height: ${size}px;\r\n      background-image: url('${backgroundImage}');\r\n      background-size: contain;\r\n      background-repeat: no-repeat;\r\n      pointer-events: auto;\r\n      cursor: pointer;\r\n      z-index: ${zIndex};\r\n      will-change: transform;\r\n      top: 0;\r\n      left: 0;\r\n      filter: drop-shadow(0px 2px 4px rgba(0,0,0,0.4));\r\n    `.trim().replace(/\\s+/g, ' ');\r\n  }\r\n\r\n  /**\r\n   * Extracts domain from a URL\r\n   * @param {string} url - The URL to extract domain from\r\n   * @returns {string} The domain (e.g., 'zillow.com')\r\n   */\r\n  static getDomain(url) {\r\n    try {\r\n      const parsed = new URL(url);\r\n      // Remove 'www.' prefix if present\r\n      return parsed.hostname.replace(/^www\\./, '');\r\n    } catch (e) {\r\n      return '';\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Generates a unique ID for a POI\r\n   * @param {Object} poi - POI object\r\n   * @returns {string} Unique identifier\r\n   */\r\n  static getPoiId(poi) {\r\n    return poi.id || poi.name || `${poi.latitude}_${poi.longitude}`;\r\n  }\r\n}\r\n\r\n/**\r\n * MarkerPool - Recycles DOM elements to reduce GC pressure\r\n */\r\nclass MarkerPool {\r\n  constructor() {\r\n    this.pool = [];\r\n    this.maxPoolSize = 100; // Limit pool size to prevent memory bloat\r\n  }\r\n\r\n  /**\r\n   * Acquires an element from the pool or creates a new one\r\n   * @param {Function} createFn - Factory function to create new element if pool is empty\r\n   * @returns {HTMLElement} DOM element\r\n   */\r\n  acquire(createFn) {\r\n    if (this.pool.length > 0) {\r\n      return this.pool.pop();\r\n    }\r\n    return createFn ? createFn() : document.createElement('div');\r\n  }\r\n\r\n  /**\r\n   * Releases an element back to the pool for reuse\r\n   * @param {HTMLElement} element - Element to return to pool\r\n   */\r\n  release(element) {\r\n    if (!element) return;\r\n    \r\n    // Detach from DOM if attached\r\n    if (element.parentNode) {\r\n      element.remove();\r\n    }\r\n    \r\n    // Only pool if under max size\r\n    if (this.pool.length < this.maxPoolSize) {\r\n      this.pool.push(element);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Clears all elements from the pool\r\n   */\r\n  clear() {\r\n    this.pool = [];\r\n  }\r\n\r\n  /**\r\n   * Gets the current pool size\r\n   * @returns {number} Number of elements in pool\r\n   */\r\n  get size() {\r\n    return this.pool.length;\r\n  }\r\n}\r\n\r\n/**\r\n * MapTypeDetector - Identifies map library type from instance\r\n */\r\nclass MapTypeDetector {\r\n  /**\r\n   * Checks if the map instance is a Google Maps instance\r\n   * @param {Object} map - Map instance to check\r\n   * @returns {boolean} True if Google Maps\r\n   */\r\n  static isGoogleMap(map) {\r\n    if (!map) return false;\r\n    return (\r\n      map.overlayMapTypes !== undefined ||\r\n      typeof map.getDiv === 'function' ||\r\n      (typeof map.setCenter === 'function' && typeof map.fitBounds === 'function' && !map.addSource)\r\n    );\r\n  }\r\n\r\n  /**\r\n   * Checks if the map instance is a Mapbox GL JS instance\r\n   * @param {Object} map - Map instance to check\r\n   * @returns {boolean} True if Mapbox GL JS\r\n   */\r\n  static isMapbox(map) {\r\n    if (!map) return false;\r\n    return (\r\n      map.addSource !== undefined &&\r\n      map.addLayer !== undefined &&\r\n      typeof map.on === 'function'\r\n    );\r\n  }\r\n\r\n  /**\r\n   * Checks if the map instance is a Leaflet instance\r\n   * @param {Object} map - Map instance to check\r\n   * @returns {boolean} True if Leaflet\r\n   */\r\n  static isLeaflet(map) {\r\n    if (!map) return false;\r\n    return (\r\n      map._leaflet_id !== undefined ||\r\n      (typeof map.addLayer === 'function' && typeof map.removeLayer === 'function' && !map.addSource)\r\n    );\r\n  }\r\n\r\n  /**\r\n   * Detects and returns the map type as a string\r\n   * @param {Object} map - Map instance to check\r\n   * @returns {string} 'google' | 'mapbox' | 'leaflet' | 'unknown'\r\n   */\r\n  static detect(map) {\r\n    if (this.isGoogleMap(map)) return 'google';\r\n    if (this.isMapbox(map)) return 'mapbox';\r\n    if (this.isLeaflet(map)) return 'leaflet';\r\n    return 'unknown';\r\n  }\r\n}\r\n\r\n// Export for different module systems\r\nif (typeof module !== 'undefined' && module.exports) {\r\n  module.exports = { MapUtils, MarkerPool, MapTypeDetector };\r\n}\r\nif (typeof window !== 'undefined') {\r\n  window.MapUtils = MapUtils;\r\n  window.MarkerPool = MarkerPool;\r\n  window.MapTypeDetector = MapTypeDetector;\r\n}\r\n", "// [SOURCE: bridge/modules/hijack.js]\n/**\r\n * POI Bridge: Hijack Module\r\n * Captures map instances via constructor interception.\r\n * \r\n * Converted to OOP class extending ManagerBase for singleton pattern\r\n * and initialization lifecycle management.\r\n */\r\n\r\n/**\r\n * MapHijackManager - Captures and manages map instances\r\n * \r\n * Features:\r\n * - Intercepts Google Maps and Mapbox constructors\r\n * - Attaches event listeners for bounds updates\r\n * - Maintains a Set of active map instances\r\n * - Provides backdoor capture via prototype hijacking\r\n */\r\nclass MapHijackManager extends ManagerBase {\r\n  constructor() {\r\n    super();\r\n    this.activeMaps = new Set();\r\n    this.originalConstructors = {};\r\n  }\r\n\r\n  /**\r\n   * @override\r\n   * Called during initialization\r\n   */\r\n  async onInitialize() {\r\n    this.interceptConstructors();\r\n    this.log('MapHijackManager initialized');\r\n  }\r\n\r\n  /**\r\n   * @override\r\n   * Cleanup and restore original constructors\r\n   */\r\n  cleanup() {\r\n    // Note: We don't restore constructors as it could break the page\r\n    // Just clear our state\r\n    this.activeMaps.clear();\r\n    this.initialized = false;\r\n    this.log('MapHijackManager cleaned up');\r\n  }\r\n\r\n  /**\r\n   * Attaches event listeners to a captured map instance\r\n   * @param {Object} instance - The map instance\r\n   */\r\n  attachListeners(instance) {\r\n    if (!instance || instance._poiListener) return;\r\n    console.log('[Shullow] Attaching listeners to captured instance');\r\n    \r\n    // Unwrap if it's a wrapper (Redfin specific)\r\n    let target = instance;\r\n    if (!target.addListener && !target.on) {\r\n       if (target.map && (target.map.addListener || target.map.on)) target = target.map;\r\n       else if (target.getMap && typeof target.getMap === 'function') {\r\n          const m = target.getMap();\r\n          if (m && (m.addListener || m.on)) target = m;\r\n       }\r\n    }\r\n\r\n    try {\r\n      if (target.on) { // Mapbox\r\n        const update = () => {\r\n          if (typeof target.getBounds === 'function') {\r\n            const b = target.getBounds();\r\n            if (b) {\r\n              window.poiPortal.update({\r\n                north: b.getNorth(), south: b.getSouth(),\r\n                east: b.getEast(), west: b.getWest()\r\n              }, 'instance-event');\r\n            }\r\n          }\r\n        };\r\n        // Redfin might throttle 'move', try 'moveend' too\r\n        const safeUpdate = () => {\r\n           try { update(); } catch(e) {}\r\n        };\r\n        \r\n        // OPTIMIZATION: Only listen to 'moveend' to reduce flicker and load during drag\r\n        // 'move' fires 60fps, which is unnecessary for POI updates\r\n        // target.on('move', safeUpdate); \r\n        target.on('moveend', safeUpdate);\r\n        // target.on('zoom', safeUpdate);\r\n        target.on('zoomend', safeUpdate);\r\n        \r\n        instance._poiListener = true; // Mark original instance as processed\r\n      } else if (target.addListener) { // Google Maps\r\n        const update = () => {\r\n          // console.log('[Shullow] Google Maps event fired');\r\n          if (typeof target.getBounds === 'function') {\r\n            const b = target.getBounds();\r\n            // Google Maps getBounds returns LatLngBounds\r\n            // getNorthEast() and getSouthWest() are standard\r\n            if (b && b.getNorthEast && b.getSouthWest) {\r\n              window.poiPortal.update({\r\n                north: b.getNorthEast().lat(), south: b.getSouthWest().lat(),\r\n                east: b.getNorthEast().lng(), west: b.getSouthWest().lng()\r\n              }, 'instance-event');\r\n            }\r\n          }\r\n        };\r\n        \r\n        // OPTIMIZATION: Only listen to 'idle' (fires when map is stable)\r\n        // target.addListener('bounds_changed', update);\r\n        target.addListener('idle', update); \r\n        // target.addListener('center_changed', update);\r\n        // target.addListener('zoom_changed', update);\r\n        instance._poiListener = true; // Mark original instance as processed\r\n      }\r\n    } catch(e) {\r\n      console.error('[Shullow] Failed to attach listeners', e);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Gets all active map instances as an array\r\n   * @returns {Array} Array of active map instances\r\n   */\r\n  getActiveMaps() {\r\n    return Array.from(this.activeMaps);\r\n  }\r\n\r\n  /**\r\n   * Intercepts map constructors (main initialization logic)\r\n   * Previously the apply() method\r\n   */\r\n  interceptConstructors() {\r\n    const self = this;\r\n    console.log('[MapHijackManager] interceptConstructors called');\r\n    \r\n    // TRAP: Google Maps (window.google)\r\n    if (window.google?.maps?.Map) {\r\n       console.log('[MapHijackManager] window.google.maps.Map found, hijacking immediately');\r\n       this.hijackGoogle(window.google.maps);\r\n    } else {\r\n       console.log('[MapHijackManager] window.google.maps.Map not found yet, setting up property trap');\r\n       if (!window._poiTrappedGoogle) {\r\n          try {\r\n            let _google = window.google;\r\n          \r\n            Object.defineProperty(window, 'google', {\r\n               get() { return _google; },\r\n               set(val) {\r\n                  _google = val;\r\n                  console.log('[MapHijackManager] google property set, val.maps:', !!val?.maps);\r\n                \r\n                  // If maps is already there, hijack immediately\r\n                  if (val?.maps) {\r\n                     if (val.maps.Map) {\r\n                        console.log('[MapHijackManager] Hijacking from property setter');\r\n                        self.hijackGoogle(val.maps);\r\n                     }\r\n                   \r\n                     // ALWAYS replace google.maps with a Proxy to catch lazy definition of Map\r\n                     try {\r\n                        const mapsProxy = new Proxy(val.maps, {\r\n                           set(target, prop, value) {\r\n                              if (prop === 'Map') {\r\n                                 const Original = value;\r\n                                 function HijackedMap(...args) {\r\n                                    if (!new.target) return new HijackedMap(...args);\r\n                                    const instance = new Original(...args);\r\n                                    self.activeMaps.add(instance);\r\n                                    self.attachListeners(instance);\r\n                                    return instance;\r\n                                 }\r\n                                 HijackedMap.prototype = Original.prototype;\r\n                                 HijackedMap._isHijacked = true;\r\n                                 Object.assign(HijackedMap, Original);\r\n                                 target[prop] = HijackedMap;\r\n                                 return true;\r\n                              }\r\n                              target[prop] = value;\r\n                              return true;\r\n                           }\r\n                        });\r\n                        _google.maps = mapsProxy;\r\n                     } catch(e) {}\r\n                  }\r\n               },\r\n               configurable: true\r\n            });\r\n          } catch(e) {\r\n            console.warn('[MapHijackManager] Failed to set property trap on window.google:', e.message);\r\n          }\r\n          // Always mark as trapped (even if it failed) to avoid retrying and throwing every loop\r\n          window._poiTrappedGoogle = true;\r\n       }\r\n    }\r\n\r\n    try {\r\n      if (window.mapboxgl?.Map && !window.mapboxgl.Map._isHijacked) {\r\n        const Original = window.mapboxgl.Map;\r\n        function HijackedMap(...args) {\r\n          const instance = new Original(...args);\r\n          self.activeMaps.add(instance);\r\n          self.attachListeners(instance);\r\n          return instance;\r\n        }\r\n        HijackedMap.prototype = Original.prototype;\r\n        HijackedMap._isHijacked = true;\r\n        Object.assign(HijackedMap, Original);\r\n        window.mapboxgl.Map = HijackedMap;\r\n      }\r\n    } catch(e) {}\r\n  }\r\n\r\n  /**\r\n   * Hijacks Google Maps constructor and prototype methods\r\n   * @param {Object} mapsObj - The google.maps object\r\n   */\r\n  hijackGoogle(mapsObj) {\r\n    const self = this;\r\n    console.log('[MapHijackManager] hijackGoogle called, mapsObj.Map:', !!mapsObj.Map);\r\n    try {\r\n       if (mapsObj.Map && !mapsObj.Map._isHijacked) {\r\n         console.log('[MapHijackManager] Hijacking google.maps.Map constructor');\r\n         const Original = mapsObj.Map;\r\n         function HijackedMap(...args) {\r\n           if (!new.target) return new HijackedMap(...args);\r\n           console.log('[MapHijackManager] Google Maps constructor called, capturing instance');\r\n           const instance = new Original(...args);\r\n           self.activeMaps.add(instance);\r\n           self.attachListeners(instance);\r\n           return instance;\r\n         }\r\n         HijackedMap.prototype = Original.prototype;\r\n         HijackedMap._isHijacked = true;\r\n         Object.assign(HijackedMap, Original);\r\n         mapsObj.Map = HijackedMap;\r\n         console.log('[MapHijackManager] Hijack complete');\r\n       } else {\r\n         console.log('[MapHijackManager] Map already hijacked or not available');\r\n       }\r\n       \r\n       // BACKDOOR: Prototype Hijack\r\n       // Even if constructor hijack fails (race condition), we catch the instance \r\n       // when it calls standard methods.\r\n       if (mapsObj.Map && mapsObj.Map.prototype) {\r\n          const proto = mapsObj.Map.prototype;\r\n          const methods = ['setCenter', 'setZoom', 'setOptions', 'fitBounds', 'panTo', 'panBy', 'set'];\r\n          \r\n          methods.forEach(method => {\r\n             if (proto[method] && !proto[method]._isHijacked) {\r\n                const origMethod = proto[method];\r\n                proto[method] = function(...args) {\r\n                   // Capture instance using Duck Typing\r\n                   // Use window.poiHijack.activeMaps directly to avoid scope issues\r\n                   if (this && typeof this.getDiv === 'function' && typeof this.getBounds === 'function') {\r\n                      if (window.poiHijack && window.poiHijack.activeMaps && !window.poiHijack.activeMaps.has(this)) {\r\n                         console.log('[Shullow] Backdoor capture via', method);\r\n                         window.poiHijack.activeMaps.add(this);\r\n                         window.poiHijack.attachListeners(this);\r\n                      }\r\n                   }\r\n                   return origMethod.apply(this, args);\r\n                };\r\n                proto[method]._isHijacked = true;\r\n             }\r\n          });\r\n       }\r\n     } catch(e) {\r\n       console.error('[MapHijackManager] Error in hijackGoogle:', e);\r\n     }\r\n  }\r\n\r\n  /**\r\n   * Public method to trigger constructor interception\r\n   * (maintains backwards compatibility with existing code)\r\n   */\r\n  apply() {\r\n    this.interceptConstructors();\r\n  }\r\n}\r\n\r\n// Create singleton instance and expose on window for backwards compatibility\r\nconst hijackManager = new MapHijackManager();\r\nwindow.poiHijack = hijackManager;\r\n\r\n// Export for different module systems\r\nif (typeof module !== 'undefined' && module.exports) {\r\n  module.exports = MapHijackManager;\r\n}", "// [SOURCE: bridge/modules/discovery.js]\n/**\r\n * POI Bridge: Discovery Module\r\n * Penetrates Shadow DOM and React trees to find existing maps.\r\n * \r\n * Converted to OOP class extending ManagerBase for singleton pattern\r\n * and initialization lifecycle management.\r\n * \r\n * NOTE: Site-specific logic is now handled by siteConfig.js which provides\r\n * selectors, features flags, and Shadow DOM detection capabilities.\r\n * \r\n * PHASE 6.5: This module now registers discovered maps with OverlayRegistry.\r\n * Domain detection happens AT DISCOVERY TIME, not globally.\r\n */\r\n\r\n/**\r\n * MapDiscoveryManager - Discovers map instances in the DOM\r\n * \r\n * Features:\r\n * - Shadow DOM traversal\r\n * - React Fiber scanning\r\n * - Web Components detection (gmp-map, gmp-advanced-marker)\r\n * - Multiple fallback selector strategies\r\n * - Phase 6.5: Registers maps with OverlayRegistry for domain isolation\r\n */\r\nclass MapDiscoveryManager extends ManagerBase {\r\n  constructor() {\r\n    super();\r\n    this.observers = [];\r\n    this.scanInterval = null;\r\n    this._idleCounter = 0;\r\n  }\r\n\r\n  /**\r\n   * Attempts to extract a map-like instance from a candidate object\r\n   * @param {any} candidate\r\n   * @returns {any|null}\r\n   * @private\r\n   */\r\n  _extractMapFromCandidate(candidate) {\r\n    try {\r\n      if (!candidate || typeof candidate !== 'object') return null;\r\n      if (typeof candidate.getBounds === 'function' || typeof candidate.setCenter === 'function') {\r\n        return candidate;\r\n      }\r\n\r\n      const visited = new WeakSet();\r\n      const queue = [candidate];\r\n      let depth = 0;\r\n\r\n      while (queue.length > 0 && depth < 2) {\r\n        const nextQueue = [];\r\n        for (const obj of queue) {\r\n          if (!obj || typeof obj !== 'object') continue;\r\n          if (visited.has(obj)) continue;\r\n          visited.add(obj);\r\n\r\n          const keys = Object.keys(obj);\r\n          for (const key of keys) {\r\n            try {\r\n              const val = obj[key];\r\n              if (!val || typeof val !== 'object') continue;\r\n              if (typeof val.getBounds === 'function' || typeof val.setCenter === 'function') {\r\n                return val;\r\n              }\r\n              nextQueue.push(val);\r\n            } catch (e) {}\r\n          }\r\n        }\r\n        queue.length = 0;\r\n        queue.push(...nextQueue);\r\n        depth++;\r\n      }\r\n    } catch (e) {}\r\n\r\n    return null;\r\n  }\r\n\r\n  /**\r\n   * Registers a discovered map with the OverlayRegistry\r\n   * Domain detection happens HERE at discovery time.\r\n   * @param {Object} map - The map instance\r\n   * @param {HTMLElement} [container] - The container element\r\n   * @private\r\n   */\r\n  _registerMap(map, container = null) {\r\n    if (!map) return;\r\n    \r\n    console.log('[MapDiscoveryManager] _registerMap called with map:', map);\r\n    \r\n    // Add to hijack's activeMaps for backwards compatibility\r\n    window.poiHijack.activeMaps.add(map);\r\n    window.poiHijack.attachListeners(map);\r\n\r\n    // PHASE 6.5: Register with OverlayRegistry\r\n    // Domain is detected HERE and locked to this map\r\n    if (window.overlayRegistry) {\r\n      console.log('[MapDiscoveryManager] Calling overlayRegistry.register()');\r\n      const entry = window.overlayRegistry.register(map, container);\r\n      if (entry && entry.overlay) {\r\n        this.log(`Registered map ${entry.id} with overlay for domain: ${entry.domain}`);\r\n      }\r\n    } else {\r\n      console.warn('[MapDiscoveryManager] overlayRegistry not available!');\r\n    }\r\n  }\r\n\r\n  /**\r\n   * @override\r\n   * Called during initialization\r\n   */\r\n  async onInitialize() {\r\n    this.log('MapDiscoveryManager initialized');\r\n  }\r\n\r\n  /**\r\n   * @override\r\n   * Cleanup observers and intervals\r\n   */\r\n  cleanup() {\r\n    this.stopScanning();\r\n    this.observers.forEach(obs => obs.disconnect());\r\n    this.observers = [];\r\n    this.initialized = false;\r\n    this.log('MapDiscoveryManager cleaned up');\r\n  }\r\n\r\n  /**\r\n   * Starts continuous scanning for maps\r\n   */\r\n  startScanning() {\r\n    if (this.scanInterval) return;\r\n    this.scanInterval = setInterval(() => this.run(), 1000);\r\n    this.log('Started scanning');\r\n  }\r\n\r\n  /**\r\n   * Stops continuous scanning\r\n   */\r\n  stopScanning() {\r\n    if (this.scanInterval) {\r\n      clearInterval(this.scanInterval);\r\n      this.scanInterval = null;\r\n      this.log('Stopped scanning');\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Finds all elements matching selector within Shadow DOM\r\n   * @param {Node} root - Root node to search from\r\n   * @param {string} selector - CSS selector\r\n   * @param {Array} found - Accumulator array\r\n   * @returns {Array} Found elements\r\n   */\r\n  findAllInShadow(root, selector, found = []) {\r\n    if (!root) return found;\r\n    try {\r\n      const elements = root.querySelectorAll(selector);\r\n      elements.forEach(el => found.push(el));\r\n      \r\n      // Optimization: Limit shadow root crawl depth or skip common non-map containers\r\n      // This is a heavy operation.\r\n      const all = root.querySelectorAll('*');\r\n      for (const s of all) {\r\n        if (s.shadowRoot) {\r\n           // Skip known non-map custom elements if possible\r\n           if (s.tagName.includes('ICON') || s.tagName.includes('BUTTON')) continue;\r\n           this.findAllInShadow(s.shadowRoot, selector, found);\r\n        }\r\n      }\r\n    } catch(e) {}\r\n    return found;\r\n  }\r\n\r\n  /**\r\n   * Main discovery run - finds and registers maps\r\n   */\r\n  run() {\r\n    // IDLE CHECK: If we already have active maps, we don't need to scan aggressively.\r\n    // Scan only every 10th call (assuming 1s loop = every 10s)\r\n    if (window.poiHijack.activeMaps.size > 0) {\r\n       this._idleCounter = (this._idleCounter || 0) + 1;\r\n       if (this._idleCounter % 10 !== 0) return; \r\n    }\r\n    \r\n    console.log('[MapDiscoveryManager] run() called, activeMaps:', window.poiHijack.activeMaps.size);\r\n    \r\n    // A. Mapbox Global Registry\r\n    this._discoverMapboxGlobal();\r\n    \r\n    // B. Web Components (Realtor/Homes)\r\n    this._discoverWebComponents();\r\n    \r\n    // C. DOM & Fiber\r\n    this._discoverDOMAndFiber();\r\n    \r\n    // D. FALLBACK: If we still have 0 maps, try window.google.maps directly (for hijacked instances)\r\n    if (window.poiHijack.activeMaps.size === 0 && window.google?.maps) {\r\n      console.log('[MapDiscoveryManager] No maps found via discovery, checking window.google.maps...');\r\n      // The hijack should have captured any maps created via the Google Maps constructor\r\n      // If not, there might be maps created before hijack was installed\r\n      // Try to find them via window.google.maps internals (varies by version)\r\n      if (window.google.maps._instances) {\r\n        console.log('[MapDiscoveryManager] Found window.google.maps._instances');\r\n        for (const instance of window.google.maps._instances) {\r\n          if (instance && typeof instance.getBounds === 'function') {\r\n            console.log('[MapDiscoveryManager] Registering map from window.google.maps._instances');\r\n            this._registerMap(instance, null);\r\n          }\r\n        }\r\n      }\r\n    }\r\n    \r\n    console.log('[MapDiscoveryManager] run() complete, now have:', window.poiHijack.activeMaps.size, 'maps');\r\n  }\r\n\r\n  /**\r\n   * Discover maps via Mapbox global registry\r\n   * @private\r\n   */\r\n  _discoverMapboxGlobal() {\r\n    try { \r\n      if (window.mapboxgl?.getInstances) {\r\n        const instances = window.mapboxgl.getInstances();\r\n        console.log('[MapDiscoveryManager] Mapbox global registry found:', instances?.length || 0, 'instances');\r\n        instances?.forEach(map => {\r\n          if (map && typeof map.getBounds === 'function') {\r\n            // PHASE 6.5: Use _registerMap instead of direct add\r\n            const container = map._container || null;\r\n            console.log('[MapDiscoveryManager] Registering Mapbox map');\r\n            this._registerMap(map, container);\r\n          }\r\n        });\r\n      }\r\n    } catch(e) {\r\n      console.error('[MapDiscoveryManager] Error in Mapbox discovery:', e);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Discover maps via Web Components (Shadow DOM)\r\n   * @private\r\n   */\r\n  _discoverWebComponents() {\r\n    try {\r\n      // Only look for gmp-map (map containers), NOT gmp-advanced-marker (individual markers)\r\n      // gmp-advanced-marker elements will have map references that shouldn't be treated as new maps\r\n      const elements = this.findAllInShadow(document, 'gmp-map');\r\n      \r\n      elements.forEach(el => {\r\n        const map = el.map || el.innerMap || el.getMap?.();\r\n        if (map && typeof map.getBounds === 'function') {\r\n          console.log('[MapDiscoveryManager] Registering gmp-map');\r\n           // PHASE 6.5: Use _registerMap, pass the element as container context\r\n           this._registerMap(map, el);\r\n        }\r\n      });\r\n    } catch(e) {\r\n      console.error('[MapDiscoveryManager] Error in web components discovery:', e);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Discover maps via DOM selectors and React Fiber\r\n   * @private\r\n   */\r\n  _discoverDOMAndFiber() {\r\n    const selectors = [\r\n       '.gm-style', \r\n       '.mapboxgl-map', \r\n       '.leaflet-container', \r\n       'canvas',\r\n       '#map-container',\r\n       '.map-container',\r\n       '[data-rf-test-id=\"map\"]',\r\n       'div[class*=\"Map\"]',\r\n       'div[class*=\"map\"]'\r\n    ];\r\n    const mapProps = ['map', 'mapInstance', 'innerMap', '__google_map__', 'mapObject', 'viewer', '__e3_'];\r\n    \r\n    let foundCount = 0;\r\n    console.log('[MapDiscoveryManager] _discoverDOMAndFiber: checking', selectors.length, 'selectors...');\r\n    \r\n    // Quick test: can we find .gm-style directly?\r\n    const quickTest = document.querySelector('.gm-style');\r\n    console.log('[MapDiscoveryManager] Quick test: document.querySelector(\".gm-style\"):', !!quickTest);\r\n    \r\n    // If found, try to get map from it\r\n    if (quickTest) {\r\n      let curr = quickTest;\r\n      for (let i = 0; i < 5 && curr; i++) {\r\n        for (const p of mapProps) {\r\n          try {\r\n            const candidate = curr[p];\r\n            if (candidate && typeof candidate.getBounds === 'function') {\r\n              console.log('[MapDiscoveryManager] FOUND MAP via property', p);\r\n              foundCount++;\r\n              this._registerMap(candidate, quickTest);\r\n              break;\r\n            }\r\n          } catch(e) {}\r\n        }\r\n        curr = curr.parentElement;\r\n      }\r\n    }\r\n    \r\n    selectors.forEach(sel => {\r\n      try {\r\n        const elements = this.findAllInShadow(document, sel);\r\n        console.log('[MapDiscoveryManager] Selector \"' + sel + '\": found', elements.length, 'elements');\r\n        \r\n        elements.forEach(el => {\r\n          let curr = el;\r\n          \r\n          for (let i = 0; i < 5 && curr; i++) {\r\n            for (const p of mapProps) { \r\n              try { \r\n                const candidate = curr[p];\r\n                if (candidate && typeof candidate.getBounds === 'function') {\r\n                  console.log('[MapDiscoveryManager] Found map instance via', p, 'on selector:', sel);\r\n                  foundCount++;\r\n                  this._registerMap(candidate, el);\r\n                } else if (candidate && typeof candidate === 'object') {\r\n                  const extracted = this._extractMapFromCandidate(candidate);\r\n                  if (extracted) {\r\n                    console.log('[MapDiscoveryManager] Extracted map instance via', p, 'on selector:', sel);\r\n                    foundCount++;\r\n                    this._registerMap(extracted, el);\r\n                  }\r\n                }\r\n              } catch(e) {} \r\n            }\r\n            const fiberKey = Object.keys(curr).find(k => k.startsWith('__reactFiber'));\r\n            if (fiberKey) {\r\n              let fiber = curr[fiberKey];\r\n              while (fiber) {\r\n                if (fiber.memoizedProps) { \r\n                  for (const p of mapProps) { \r\n                    try { \r\n                      const val = fiber.memoizedProps[p];\r\n                      if (val && (typeof val.getBounds === 'function' || typeof val.setCenter === 'function')) {\r\n                        console.log('[MapDiscoveryManager] Found map via Fiber prop:', p);\r\n                        this._registerMap(val, el);\r\n                      } else if (val && typeof val === 'object') {\r\n                        const extracted = this._extractMapFromCandidate(val);\r\n                        if (extracted) {\r\n                          console.log('[MapDiscoveryManager] Extracted map via Fiber prop:', p);\r\n                          this._registerMap(extracted, el);\r\n                        }\r\n                      }\r\n                    } catch(e) {} \r\n                  } \r\n                }\r\n                fiber = fiber.return;\r\n              }\r\n            }\r\n            curr = curr.parentElement || (curr.parentNode instanceof ShadowRoot ? curr.parentNode.host : null);\r\n          }\r\n        });\r\n      } catch(e) {\r\n        console.error('[MapDiscoveryManager] Error processing selector \"' + sel + '\":', e);\r\n      }\r\n    });\r\n    console.log('[MapDiscoveryManager] _discoverDOMAndFiber found:', foundCount, 'maps total');\r\n  }\r\n\r\n  /**\r\n   * Discovers maps and returns them (for use by overlays)\r\n   * @returns {Array} Array of discovered map instances\r\n   */\r\n  discoverMaps() {\r\n    this.run();\r\n    return Array.from(window.poiHijack.activeMaps);\r\n  }\r\n}\r\n\r\n// Create singleton instance and expose on window for backwards compatibility\r\nconst discoveryManager = new MapDiscoveryManager();\r\nwindow.poiDiscovery = discoveryManager;\r\n\r\n// Export for different module systems\r\nif (typeof module !== 'undefined' && module.exports) {\r\n  module.exports = MapDiscoveryManager;\r\n}\r\n", "// [SOURCE: bridge/modules/portal.js]\n/**\r\n * POI Bridge: Portal Module\r\n * Handles cross-world communication and attribute mirroring.\r\n * \r\n * Converted to OOP class extending ManagerBase for singleton pattern\r\n * and initialization lifecycle management.\r\n */\r\n\r\n/**\r\n * PortalManager - Cross-world communication manager\r\n * \r\n * Features:\r\n * - Bounds update with priority system\r\n * - DOM attribute mirroring for isolated world access\r\n * - postMessage for content script communication\r\n */\r\nclass PortalManager extends ManagerBase {\r\n  constructor() {\r\n    super();\r\n    this.lastBounds = null;\r\n    this.lastUpdateTime = 0;\r\n    this.lastPriority = 0;\r\n    this.messageHandlers = new Map();\r\n    \r\n    // Priority levels for different data sources\r\n    this.PRIORITIES = {\r\n      'instance-event': 100,      // Highest: Direct user interaction\r\n      'redfin-redux-sub': 90,     // High: Real-time subscription\r\n      'redfin-api': 85,           // High: API response is very fresh\r\n      'instance-capture': 80,     // Medium: Extracted from active map instance\r\n      'redfin-redux': 50,         // Low: Polled state (might be slightly stale)\r\n      'redfin-global': 40,        // Lower: Polled global variable (often stale)\r\n      'network-url': 20,          // Lowest: One-off network sniff\r\n      'network-body': 20\r\n    };\r\n  }\r\n\r\n  /**\r\n   * @override\r\n   * Called during initialization\r\n   */\r\n  async onInitialize() {\r\n    this.setupMessageListeners();\r\n    this.log('PortalManager initialized');\r\n  }\r\n\r\n  /**\r\n   * @override\r\n   * Cleanup resources\r\n   */\r\n  cleanup() {\r\n    this.messageHandlers.clear();\r\n    this.initialized = false;\r\n    this.log('PortalManager cleaned up');\r\n  }\r\n\r\n  /**\r\n   * Sets up message listeners\r\n   * @private\r\n   */\r\n  setupMessageListeners() {\r\n    // Can be extended by subclasses or at runtime\r\n  }\r\n\r\n  /**\r\n   * Registers a message handler\r\n   * @param {string} type - Message type\r\n   * @param {Function} handler - Handler function\r\n   */\r\n  registerHandler(type, handler) {\r\n    this.messageHandlers.set(type, handler);\r\n  }\r\n\r\n  /**\r\n   * Extracts bounds from a map instance\r\n   * @param {Object} map - Map instance\r\n   * @returns {Object|null} Bounds object\r\n   */\r\n  extractBounds(map) {\r\n    try {\r\n      const b = map.getBounds();\r\n      if (!b) return null;\r\n      \r\n      // Google Maps format\r\n      if (b.getNorthEast) {\r\n        return {\r\n          north: b.getNorthEast().lat(),\r\n          south: b.getSouthWest().lat(),\r\n          east: b.getNorthEast().lng(),\r\n          west: b.getSouthWest().lng()\r\n        };\r\n      }\r\n      \r\n      // Mapbox format\r\n      if (b.getNorth) {\r\n        return {\r\n          north: b.getNorth(),\r\n          south: b.getSouth(),\r\n          east: b.getEast(),\r\n          west: b.getWest()\r\n        };\r\n      }\r\n    } catch(e) {}\r\n    return null;\r\n  }\r\n\r\n  /**\r\n   * Filters POIs by priority within given bounds\r\n   * @param {Array} pois - Array of POIs\r\n   * @param {Object} bounds - Bounds to filter by\r\n   * @returns {Array} Filtered POIs\r\n   */\r\n  filterByPriority(pois, bounds) {\r\n    if (!bounds || !pois) return pois;\r\n    \r\n    return pois.filter(poi => {\r\n      const lat = parseFloat(poi.latitude);\r\n      const lng = parseFloat(poi.longitude);\r\n      return (\r\n        lat >= bounds.south &&\r\n        lat <= bounds.north &&\r\n        lng >= bounds.west &&\r\n        lng <= bounds.east\r\n      );\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Sends a message to the content script\r\n   * @param {string} type - Message type\r\n   * @param {Object} data - Message data\r\n   */\r\n  notifyContentScript(type, data) {\r\n    window.postMessage({ type, ...data }, '*');\r\n  }\r\n\r\n  /**\r\n   * Updates bounds with priority checking\r\n   * @param {Object} bounds - Bounds object\r\n   * @param {string} method - Source method name\r\n   */\r\n  update(bounds, method) {\r\n    if (!bounds || typeof bounds.north !== 'number' || isNaN(bounds.north)) return;\r\n    \r\n    // Priority Check\r\n    const priority = this.PRIORITIES[method] || 30;\r\n    const now = Date.now();\r\n    \r\n    // STRICTER LOCK: If we have locked onto a high-quality source (>= 80),\r\n    // ignore any low-quality polling (< 80) PERMANENTLY unless the high-quality source goes silent for > 5 seconds.\r\n    if (this.lastPriority >= 80 && priority < 80) {\r\n       if (now - this.lastUpdateTime < 5000) return;\r\n       // Reset lock if silence for 5s\r\n       this.lastPriority = 0; \r\n    }\r\n\r\n    // Always allow high-priority updates (e.g. from user interaction or API)\r\n    // Only filter low-priority polling if a high-priority event happened very recently\r\n    if (priority <= 50 && this.lastPriority > 50 && (now - this.lastUpdateTime < 500)) {\r\n       return;\r\n    }\r\n\r\n    // Round for stability and JSON comparison\r\n    const rounded = {\r\n      north: parseFloat(bounds.north.toFixed(6)),\r\n      south: parseFloat(bounds.south.toFixed(6)),\r\n      east: parseFloat(bounds.east.toFixed(6)),\r\n      west: parseFloat(bounds.west.toFixed(6))\r\n    };\r\n\r\n    const json = JSON.stringify(rounded);\r\n    \r\n    // Update state even if bounds are same, to refresh priority timestamp if it's high priority\r\n    if (priority >= this.lastPriority) {\r\n        this.lastPriority = priority;\r\n        this.lastUpdateTime = now;\r\n    }\r\n\r\n    if (json === this.lastBounds) return;\r\n    this.lastBounds = json;\r\n\r\n    const timestamp = now.toString();\r\n\r\n    // Mirror to DOM for Isolated World access\r\n    document.documentElement.setAttribute('data-poi-bounds', json);\r\n    document.documentElement.setAttribute('data-poi-map-type', method);\r\n    document.documentElement.setAttribute('data-poi-timestamp', timestamp);\r\n    \r\n    const payload = { \r\n      type: 'POI_BOUNDS_UPDATE', \r\n      bounds: rounded, \r\n      method: method, \r\n      url: window.location.href, \r\n      isIframe: window.self !== window.top,\r\n      timestamp: timestamp\r\n    };\r\n    \r\n    window.postMessage(payload, '*');\r\n    if (window.self !== window.top) window.parent.postMessage(payload, '*');\r\n  }\r\n}\r\n\r\n// Create singleton instance and expose on window for backwards compatibility\r\nconst portalManager = new PortalManager();\r\nwindow.poiPortal = portalManager;\r\n\r\n// Export for different module systems\r\nif (typeof module !== 'undefined' && module.exports) {\r\n  module.exports = PortalManager;\r\n}\r\n", "// [SOURCE: overlays/siteConfig.js]\n/**\r\n * siteConfig.js - Centralized site-specific configuration\r\n * \r\n * Simplified replacement for the overlay class hierarchy.\r\n * Contains all site-specific settings including:\r\n * - Domain detection selectors\r\n * - Map type identification\r\n * - Style overrides (z-index, etc.)\r\n * - Special behaviors/features per site\r\n */\r\n\r\n// Default styles applied to all sites unless overridden\r\nconst DEFAULT_STYLES = {\r\n  markerZIndex: 103,\r\n  markerHoverZIndex: 1000000,\r\n  containerZIndex: null,\r\n  markerOpacity: 1.0,\r\n  markerSize: 32\r\n};\r\n\r\nconst SITE_CONFIG = {\r\n  'zillow.com': {\r\n    displayName: 'Zillow',\r\n    mapType: 'mapbox',\r\n    \r\n    // Container detection - ordered by priority\r\n    selectors: [\r\n      '.mapboxgl-map',\r\n      '#search-page-map',\r\n      '[data-testid=\"map\"]',\r\n      '.map-container',\r\n      '#map'\r\n    ],\r\n    \r\n    // Style overrides (merged with DEFAULT_STYLES, null removes a key)\r\n    styles: {\r\n      // Inherits all defaults\r\n    },\r\n    \r\n    // Special features\r\n    features: {\r\n      reduxStore: false,\r\n      shadowDOM: false,\r\n      boundsTracking: true\r\n    }\r\n  },\r\n  \r\n  'redfin.com': {\r\n    displayName: 'Redfin',\r\n    mapType: 'google',\r\n    \r\n    selectors: [\r\n      '.gm-style',\r\n      '[data-rf-test-id=\"map\"]',\r\n      '#map-container',\r\n      '.MapContainer',\r\n      '.HomeViews'\r\n    ],\r\n    \r\n    styles: {\r\n      // Could override here, e.g.: markerZIndex: 10000\r\n      // Or remove: containerZIndex: null\r\n\r\n    },\r\n    \r\n    features: {\r\n      reduxStore: true, // Redfin-specific: subscribe to Redux for bounds\r\n      shadowDOM: false,\r\n      boundsTracking: true\r\n    }\r\n  },\r\n  \r\n  'realtor.com': {\r\n    displayName: 'Realtor',\r\n    mapType: 'auto', // Can be either Google or Mapbox\r\n    \r\n    selectors: [\r\n      '.mapboxgl-map',\r\n      '.gm-style',\r\n      'gmp-map',\r\n      '#map-container',\r\n      '[data-testid=\"map\"]',\r\n      '.map-container',\r\n      '#mapboxgl-map'\r\n    ],\r\n    \r\n    styles: {\r\n      // Inherits defaults\r\n    },\r\n    \r\n    features: {\r\n      reduxStore: false,\r\n      shadowDOM: true, // Realtor uses Shadow DOM\r\n      boundsTracking: true\r\n    }\r\n  },\r\n  \r\n  'homes.com': {\r\n    displayName: 'Homes.com',\r\n    mapType: 'google',\r\n    \r\n    selectors: [\r\n      '.gm-style',\r\n      '#map',\r\n      '.map-container',\r\n      '[data-testid=\"map\"]'\r\n    ],\r\n    \r\n    styles: {\r\n      // Inherits defaults\r\n      markerZIndex: -100\r\n    },\r\n    \r\n    features: {\r\n      reduxStore: false,\r\n      shadowDOM: false,\r\n      boundsTracking: true\r\n    }\r\n  },\r\n  \r\n  'onekeymls.com': {\r\n    displayName: 'OneKey MLS',\r\n    mapType: 'mapbox',\r\n    \r\n    selectors: [\r\n      '.mapboxgl-map',\r\n      '#map',\r\n      '.map-container'\r\n    ],\r\n    \r\n    styles: {\r\n      // Inherits defaults\r\n    },\r\n    \r\n    features: {\r\n      reduxStore: false,\r\n      shadowDOM: false,\r\n      boundsTracking: true\r\n    }\r\n  },\r\n  \r\n  // Default fallback for unknown sites\r\n  'default': {\r\n    displayName: 'Generic',\r\n    mapType: 'auto',\r\n    \r\n    selectors: [\r\n      '.mapboxgl-map',\r\n      '.gm-style',\r\n      'gmp-map',\r\n      '#map',\r\n      '[role=\"application\"]',\r\n      '.map-container'\r\n    ],\r\n    \r\n    styles: {\r\n      // Uses DEFAULT_STYLES as-is\r\n    },\r\n    \r\n    features: {\r\n      reduxStore: false,\r\n      shadowDOM: false,\r\n      boundsTracking: true\r\n    }\r\n  }\r\n};\r\n\r\n// Domain aliases\r\nconst DOMAIN_ALIASES = {\r\n  'www.zillow.com': 'zillow.com',\r\n  'www.redfin.com': 'redfin.com',\r\n  'www.homes.com': 'homes.com',\r\n  'www.onekeymls.com': 'onekeymls.com',\r\n  'www.realtor.com': 'realtor.com'\r\n};\r\n\r\n/**\r\n * SiteConfigManager - Utility for working with site configurations\r\n */\r\nclass SiteConfigManager {\r\n  constructor() {\r\n    this.config = SITE_CONFIG;\r\n    this.aliases = DOMAIN_ALIASES;\r\n    this.defaultStyles = DEFAULT_STYLES;\r\n    this.debug = false;\r\n    \r\n    console.log('[SiteConfig] Initialized with', Object.keys(this.config).length, 'site configs');\r\n  }\r\n  \r\n  setDebug(enabled) {\r\n    this.debug = enabled;\r\n  }\r\n  \r\n  log(...args) {\r\n    if (this.debug) {\r\n      console.log('[SiteConfig]', ...args);\r\n    }\r\n  }\r\n  \r\n  /**\r\n   * Merges site-specific styles with defaults\r\n   * - Starts with DEFAULT_STYLES\r\n   * - Applies site-specific overrides\r\n   * - Removes keys where site value is null\r\n   */\r\n  _mergeStyles(siteStyles) {\r\n    const merged = { ...this.defaultStyles };\r\n    \r\n    if (!siteStyles) return merged;\r\n    \r\n    for (const [key, value] of Object.entries(siteStyles)) {\r\n      if (value === null) {\r\n        // null means remove this style key\r\n        delete merged[key];\r\n      } else {\r\n        // Override or add new key\r\n        merged[key] = value;\r\n      }\r\n    }\r\n    \r\n    return merged;\r\n  }\r\n  \r\n  /**\r\n   * Normalizes a domain (removes www, applies aliases)\r\n   */\r\n  normalizeDomain(domain) {\r\n    if (!domain) return 'default';\r\n    \r\n    let normalized = domain.toLowerCase().trim();\r\n    \r\n    // Apply alias\r\n    if (this.aliases[normalized]) {\r\n      normalized = this.aliases[normalized];\r\n    }\r\n    \r\n    // Remove www. prefix if not aliased\r\n    if (normalized.startsWith('www.')) {\r\n      normalized = normalized.substring(4);\r\n    }\r\n    \r\n    return normalized;\r\n  }\r\n  \r\n  /**\r\n   * Gets configuration for a domain with merged styles\r\n   */\r\n  getConfig(domain) {\r\n    const normalized = this.normalizeDomain(domain);\r\n    \r\n    this.log(`Getting config for domain: ${domain} (normalized: ${normalized})`);\r\n    \r\n    let siteConfig = null;\r\n    \r\n    // Try exact match\r\n    if (this.config[normalized]) {\r\n      siteConfig = this.config[normalized];\r\n      this.log(`Exact match for ${normalized}`);\r\n    } else {\r\n      // Try partial match (e.g., \"zillow.com\" matches \"www.zillow.com\")\r\n      for (const [key, value] of Object.entries(this.config)) {\r\n        if (key !== 'default' && (normalized.includes(key) || key.includes(normalized))) {\r\n          this.log(`Partial match: ${normalized} -> ${key}`);\r\n          siteConfig = value;\r\n          break;\r\n        }\r\n      }\r\n    }\r\n    \r\n    // Fallback to default\r\n    if (!siteConfig) {\r\n      this.log(`No match for ${normalized}, using default`);\r\n      siteConfig = this.config.default;\r\n    }\r\n    \r\n    // Return config with merged styles\r\n    const result = {\r\n      ...siteConfig,\r\n      domain: normalized,\r\n      styles: this._mergeStyles(siteConfig.styles)\r\n    };\r\n    \r\n    this.log(`Config result for ${domain}:`, result);\r\n    \r\n    return result;\r\n  }\r\n  \r\n  /**\r\n   * Detects a map container for the given domain\r\n   */\r\n  detectContainer(domain) {\r\n    const config = this.getConfig(domain);\r\n    \r\n    // If site uses Shadow DOM, search within it\r\n    if (config.features.shadowDOM) {\r\n      return this._detectInShadowDOM(config.selectors);\r\n    }\r\n    \r\n    // Standard DOM search\r\n    for (const selector of config.selectors) {\r\n      try {\r\n        const el = document.querySelector(selector);\r\n        if (el) {\r\n          this.log(`Detected container for ${domain}: ${selector}`);\r\n          return el;\r\n        }\r\n      } catch (e) {\r\n        // Invalid selector, skip\r\n      }\r\n    }\r\n    \r\n    return null;\r\n  }\r\n  \r\n  /**\r\n   * Searches for elements within Shadow DOM\r\n   */\r\n  _detectInShadowDOM(selectors, root = document.body, found = null) {\r\n    if (!root) return found;\r\n    \r\n    try {\r\n      // Try each selector on current level\r\n      if (!found) {\r\n        for (const selector of selectors) {\r\n          const elements = root.querySelectorAll(selector);\r\n          if (elements.length > 0) {\r\n            found = elements[0];\r\n            break;\r\n          }\r\n        }\r\n      }\r\n      \r\n      // Recurse into shadow roots\r\n      if (!found) {\r\n        const all = root.querySelectorAll('*');\r\n        for (const el of all) {\r\n          if (el.shadowRoot) {\r\n            // Skip common UI elements\r\n            if (el.tagName.includes('ICON') || el.tagName.includes('BUTTON')) {\r\n              continue;\r\n            }\r\n            found = this._detectInShadowDOM(selectors, el.shadowRoot, found);\r\n            if (found) break;\r\n          }\r\n        }\r\n      }\r\n    } catch (e) {\r\n      // Ignore errors\r\n    }\r\n    \r\n    return found;\r\n  }\r\n  \r\n  /**\r\n   * Applies site-specific styles to markers\r\n   */\r\n  applyMarkerStyles(element, domain, isHover = false) {\r\n    const config = this.getConfig(domain);\r\n    const zIndex = isHover \r\n      ? config.styles.markerHoverZIndex \r\n      : config.styles.markerZIndex;\r\n    \r\n    if (zIndex !== null) {\r\n      element.style.zIndex = zIndex.toString();\r\n    }\r\n  }\r\n  \r\n  /**\r\n   * Gets all configured sites\r\n   */\r\n  getAllSites() {\r\n    return Object.keys(this.config).filter(k => k !== 'default');\r\n  }\r\n}\r\n\r\n// Export\r\nif (typeof module !== 'undefined' && module.exports) {\r\n  module.exports = { DEFAULT_STYLES, SITE_CONFIG, DOMAIN_ALIASES, SiteConfigManager };\r\n}\r\nif (typeof window !== 'undefined') {\r\n  window.DEFAULT_STYLES = DEFAULT_STYLES;\r\n  window.SITE_CONFIG = SITE_CONFIG;\r\n  window.DOMAIN_ALIASES = DOMAIN_ALIASES;\r\n  window.SiteConfigManager = SiteConfigManager;\r\n  window.siteConfig = new SiteConfigManager();\r\n}\r\n", "// [SOURCE: overlays/OverlayRegistry.js]\n/**\r\n * OverlayRegistry.js - Registry for map instances and their site configurations\r\n * \r\n * CRITICAL: This registry implements Phase 6.5 - Multi-Map Isolation\r\n * \r\n * Problem Being Solved:\r\n * When loading sites like realtor.com, scripts would read DOM elements and see\r\n * domains from iframes/ads (not realtor.com), which would overwrite the global\r\n * domain variable, causing the incorrect configuration to be used.\r\n * \r\n * Solution:\r\n * - Each map instance gets a unique ID at discovery time\r\n * - Domain detection happens at discovery time for THAT specific map\r\n * - The site config is locked to that map and cannot be changed\r\n * - Network requests cannot change the site config assignment\r\n * - Each map maintains its own isolated configuration\r\n */\r\n\r\n/**\r\n * MapEntry - Represents a registered map instance\r\n */\r\nclass MapEntry {\r\n  /**\r\n   * @param {string} id - Unique map identifier\r\n   * @param {Object} mapInstance - The map instance\r\n   * @param {string} domain - Domain detected at discovery time\r\n   * @param {Object} siteConfig - The site configuration object\r\n   */\r\n  constructor(id, mapInstance, domain, siteConfig) {\r\n    this.id = id;\r\n    this.mapInstance = mapInstance;\r\n    this.domain = domain;\r\n    this.siteConfig = siteConfig;\r\n    this.createdAt = Date.now();\r\n    this.lastUpdate = Date.now();\r\n    this.bounds = null;\r\n    this.isActive = true;\r\n    \r\n    // Lock the domain - it cannot be changed after creation\r\n    Object.defineProperty(this, 'domain', {\r\n      value: domain,\r\n      writable: false,\r\n      configurable: false\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Updates the last activity timestamp\r\n   */\r\n  touch() {\r\n    this.lastUpdate = Date.now();\r\n  }\r\n\r\n  /**\r\n   * Deactivates this entry\r\n   */\r\n  deactivate() {\r\n    this.isActive = false;\r\n  }\r\n}\r\n\r\n/**\r\n * OverlayRegistry - Singleton registry for map-siteConfig associations\r\n * \r\n * Key guarantees:\r\n * 1. Domain is detected once at registration time\r\n * 2. Domain cannot be changed after registration\r\n * 3. Each map has exactly one site configuration\r\n * 4. Network activity cannot affect domain/config assignments\r\n */\r\nclass OverlayRegistry {\r\n  constructor() {\r\n    /**\r\n     * Map from map ID to MapEntry\r\n     * @type {Map<string, MapEntry>}\r\n     */\r\n    this.entries = new Map();\r\n    \r\n    /**\r\n     * WeakMap from map instance to map ID (for reverse lookup)\r\n     * @type {WeakMap<Object, string>}\r\n     */\r\n    this.instanceToId = new WeakMap();\r\n    \r\n    /**\r\n     * Counter for generating unique IDs\r\n     */\r\n    this.idCounter = 0;\r\n    \r\n    /**\r\n     * Debug mode\r\n     */\r\n    this.debug = false;\r\n  }\r\n\r\n  /**\r\n   * Sets the overlay factory\r\n   * @param {OverlayFactory} factory - The factory instance\r\n   */\r\n  /**\r\n   * @deprecated No longer needed - using siteConfig directly\r\n   */\r\n  setFactory(factory) {\r\n    // No-op for backwards compatibility\r\n  }\r\n\r\n  /**\r\n   * Enable/disable debug logging\r\n   * @param {boolean} enabled - Debug flag\r\n   */\r\n  setDebug(enabled) {\r\n    this.debug = enabled;\r\n  }\r\n\r\n  /**\r\n   * Log helper\r\n   * @param {...any} args - Arguments to log\r\n   */\r\n  log(...args) {\r\n    if (this.debug) {\r\n      console.log('[OverlayRegistry]', ...args);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Generates a unique map ID\r\n   * @returns {string} Unique ID\r\n   */\r\n  generateId() {\r\n    return `map_${++this.idCounter}_${Date.now()}`;\r\n  }\r\n\r\n  /**\r\n   * Extracts the domain from a map instance's container context\r\n   * This is called ONCE at registration time and cannot be changed.\r\n   * \r\n   * @param {Object} mapInstance - The map instance\r\n   * @param {HTMLElement} [container] - Optional container element\r\n   * @returns {string} The detected domain (empty string if unknown)\r\n   * @private\r\n   */\r\n  _extractDomainFromMap(mapInstance, container = null) {\r\n    let domain = '';\r\n    \r\n    // Priority 1: Explicit container\r\n    if (container && container.ownerDocument) {\r\n      try {\r\n        const doc = container.ownerDocument;\r\n        // Only trust if same-origin\r\n        if (doc.location) {\r\n          domain = doc.location.hostname;\r\n        }\r\n      } catch (e) {\r\n        // Cross-origin, ignore\r\n      }\r\n    }\r\n    \r\n    // Priority 2: Map's getDiv (Google Maps)\r\n    if (!domain && mapInstance && typeof mapInstance.getDiv === 'function') {\r\n      try {\r\n        const div = mapInstance.getDiv();\r\n        if (div && div.ownerDocument && div.ownerDocument.location) {\r\n          domain = div.ownerDocument.location.hostname;\r\n        }\r\n      } catch (e) {}\r\n    }\r\n    \r\n    // Priority 3: Map's _container (Mapbox)\r\n    if (!domain && mapInstance && mapInstance._container) {\r\n      try {\r\n        const c = mapInstance._container;\r\n        if (c.ownerDocument && c.ownerDocument.location) {\r\n          domain = c.ownerDocument.location.hostname;\r\n        }\r\n      } catch (e) {}\r\n    }\r\n    \r\n    // Priority 4: Map's container property (generic)\r\n    if (!domain && mapInstance && mapInstance.container) {\r\n      try {\r\n        const c = mapInstance.container;\r\n        const el = (typeof c === 'string') ? document.getElementById(c) : c;\r\n        if (el && el.ownerDocument && el.ownerDocument.location) {\r\n          domain = el.ownerDocument.location.hostname;\r\n        }\r\n      } catch (e) {}\r\n    }\r\n    \r\n    // Priority 5: Top-level window (ONLY if in main frame)\r\n    if (!domain) {\r\n      try {\r\n        if (window === window.top) {\r\n          domain = window.location.hostname;\r\n        }\r\n      } catch (e) {\r\n        // Cross-origin iframe\r\n      }\r\n    }\r\n    \r\n    this.log(`Extracted domain for map: ${domain || '(unknown)'}`);\r\n    return domain || '';\r\n  }\r\n\r\n  /**\r\n   * Registers a map instance with the registry\r\n   * Domain detection happens HERE and is locked.\r\n   * \r\n   * @param {Object} mapInstance - The map instance\r\n   * @param {HTMLElement} [container] - Optional container element\r\n   * @returns {MapEntry} The registry entry\r\n   */\r\n  register(mapInstance, container = null) {\r\n    // Log registration attempt\r\n    console.log('[OverlayRegistry] register() called for mapInstance:', mapInstance, 'container:', container);\r\n\r\n    // Check if already registered\r\n    if (this.instanceToId.has(mapInstance)) {\r\n      const existingId = this.instanceToId.get(mapInstance);\r\n      const entry = this.entries.get(existingId);\r\n      if (entry) {\r\n        entry.touch();\r\n        this.log(`Map already registered: ${existingId}`);\r\n        return entry;\r\n      }\r\n    }\r\n\r\n    // Generate unique ID\r\n    const id = this.generateId();\r\n\r\n    // Extract domain AT THIS MOMENT - this is locked and cannot change\r\n    const domain = this._extractDomainFromMap(mapInstance, container);\r\n    console.log('[OverlayRegistry] Extracted domain:', domain);\r\n\r\n    // Get site configuration from siteConfig\r\n    let siteConfig = null;\r\n    if (window.siteConfig && typeof window.siteConfig.getConfig === 'function') {\r\n      siteConfig = window.siteConfig.getConfig(domain);\r\n      console.log('[OverlayRegistry] Loaded siteConfig for domain:', domain, siteConfig);\r\n    } else {\r\n      console.warn('[OverlayRegistry] window.siteConfig not available, using fallback');\r\n      siteConfig = {\r\n        displayName: domain || 'Unknown',\r\n        mapType: 'auto',\r\n        selectors: [],\r\n        styles: {},\r\n        features: {}\r\n      };\r\n    }\r\n\r\n    // Create entry\r\n    const entry = new MapEntry(id, mapInstance, domain, siteConfig);\r\n    console.log('[OverlayRegistry] MapEntry created:', entry);\r\n\r\n    // Store in registries\r\n    this.entries.set(id, entry);\r\n    this.instanceToId.set(mapInstance, id);\r\n\r\n    // Tag the map instance with its ID\r\n    if (mapInstance) {\r\n      try {\r\n        mapInstance._poiRegistryId = id;\r\n      } catch (e) {}\r\n    }\r\n\r\n    this.log(`Registered map: ${id} for domain: ${domain}`);\r\n    \r\n    return entry;\r\n  }\r\n\r\n  /**\r\n   * Gets a map entry by map instance\r\n   * @param {Object} mapInstance - The map instance\r\n   * @returns {MapEntry|null} The entry or null\r\n   */\r\n  getByInstance(mapInstance) {\r\n    const id = this.instanceToId.get(mapInstance);\r\n    return id ? this.entries.get(id) : null;\r\n  }\r\n\r\n  /**\r\n   * Gets a map entry by ID\r\n   * @param {string} id - The map ID\r\n   * @returns {MapEntry|null} The entry or null\r\n   */\r\n  getById(id) {\r\n    return this.entries.get(id) || null;\r\n  }\r\n\r\n  /**\r\n   * Gets the overlay for a map instance\r\n   * @param {Object} mapInstance - The map instance\r\n   * @returns {MapOverlayBase|null} The overlay or null\r\n   */\r\n  getOverlay(mapInstance) {\r\n    const entry = this.getByInstance(mapInstance);\r\n    return entry ? entry.overlay : null;\r\n  }\r\n\r\n  /**\r\n   * Gets all active entries\r\n   * @returns {MapEntry[]} Array of active entries\r\n   */\r\n  getActiveEntries() {\r\n    return Array.from(this.entries.values()).filter(e => e.isActive);\r\n  }\r\n\r\n  /**\r\n   * Gets all entries for a specific domain\r\n   * @param {string} domain - The domain to filter by\r\n   * @returns {MapEntry[]} Array of entries\r\n   */\r\n  getByDomain(domain) {\r\n    const normalized = domain.toLowerCase().replace(/^www\\./, '');\r\n    return Array.from(this.entries.values()).filter(e => {\r\n      const entryDomain = e.domain.toLowerCase().replace(/^www\\./, '');\r\n      return entryDomain === normalized || entryDomain.endsWith(`.${normalized}`);\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Unregisters a map instance\r\n   * @param {Object} mapInstance - The map instance\r\n   * @returns {boolean} True if successfully unregistered\r\n   */\r\n  unregister(mapInstance) {\r\n    const id = this.instanceToId.get(mapInstance);\r\n    if (!id) return false;\r\n    \r\n    const entry = this.entries.get(id);\r\n    if (entry) {\r\n      entry.deactivate();\r\n      this.entries.delete(id);\r\n    }\r\n    \r\n    this.instanceToId.delete(mapInstance);\r\n    this.log(`Unregistered map: ${id}`);\r\n    return true;\r\n  }\r\n\r\n  /**\r\n   * Updates bounds for a map entry\r\n   * NOTE: This does NOT change the domain or overlay!\r\n   * \r\n   * @param {Object} mapInstance - The map instance\r\n   * @param {Object} bounds - The bounds object\r\n   */\r\n  updateBounds(mapInstance, bounds) {\r\n    const entry = this.getByInstance(mapInstance);\r\n    if (entry) {\r\n      entry.bounds = bounds;\r\n      entry.touch();\r\n      // Do NOT change entry.domain or entry.overlay - they are locked\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Cleans up stale entries (maps that have been removed)\r\n   * @param {number} [maxAge=300000] - Maximum age in milliseconds (default 5 minutes)\r\n   */\r\n  cleanup(maxAge = 300000) {\r\n    const now = Date.now();\r\n    const toRemove = [];\r\n    \r\n    this.entries.forEach((entry, id) => {\r\n      // Check if map instance is still valid\r\n      let isValid = false;\r\n      try {\r\n        const map = entry.mapInstance;\r\n        if (map) {\r\n          // Google Maps\r\n          if (typeof map.getDiv === 'function') {\r\n            const div = map.getDiv();\r\n            isValid = div && document.contains(div);\r\n          }\r\n          // Mapbox\r\n          else if (map._container) {\r\n            isValid = document.contains(map._container);\r\n          }\r\n          // Generic\r\n          else if (map.container) {\r\n            const c = typeof map.container === 'string' \r\n              ? document.getElementById(map.container) \r\n              : map.container;\r\n            isValid = c && document.contains(c);\r\n          }\r\n        }\r\n      } catch (e) {}\r\n      \r\n      // Remove if invalid or too old\r\n      if (!isValid || (now - entry.lastUpdate > maxAge)) {\r\n        toRemove.push(id);\r\n      }\r\n    });\r\n    \r\n    for (const id of toRemove) {\r\n      const entry = this.entries.get(id);\r\n      if (entry) {\r\n        entry.deactivate();\r\n        this.entries.delete(id);\r\n        // Note: Can't remove from WeakMap, but that's fine - it'll be garbage collected\r\n      }\r\n      this.log(`Cleaned up stale entry: ${id}`);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Gets registry statistics\r\n   * @returns {Object} Stats object\r\n   */\r\n  getStats() {\r\n    const entries = Array.from(this.entries.values());\r\n    return {\r\n      total: entries.length,\r\n      active: entries.filter(e => e.isActive).length,\r\n      domains: [...new Set(entries.map(e => e.domain))],\r\n      oldestEntry: entries.length > 0 \r\n        ? Math.min(...entries.map(e => e.createdAt))\r\n        : null\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Clears all entries\r\n   */\r\n  clear() {\r\n    this.entries.forEach(entry => entry.deactivate());\r\n    this.entries.clear();\r\n    // WeakMap entries will be garbage collected\r\n    this.idCounter = 0;\r\n    this.log('Registry cleared');\r\n  }\r\n\r\n  /**\r\n   * Get debug info about all registered overlays\r\n   * Useful for debugging map detection issues\r\n   */\r\n  getDebugInfo() {\r\n    const info = [];\r\n    this.entries.forEach((entry, id) => {\r\n      info.push({\r\n        id: entry.id,\r\n        domain: entry.domain,\r\n        overlayClass: entry.overlay ? entry.overlay.constructor.name : 'none',\r\n        overlayId: entry.overlay ? entry.overlay.siteId : 'none',\r\n        isActive: entry.isActive,\r\n        createdAt: new Date(entry.createdAt).toISOString(),\r\n        lastUpdate: new Date(entry.lastUpdate).toISOString()\r\n      });\r\n    });\r\n    return info;\r\n  }\r\n\r\n  /**\r\n   * Log all overlays info to console\r\n   */\r\n  logDebugInfo() {\r\n    const info = this.getDebugInfo();\r\n    console.log('[OverlayRegistry] Current overlays:', info);\r\n    return info;\r\n  }\r\n}\r\n\r\n// Singleton instance\r\nconst overlayRegistry = new OverlayRegistry();\r\n\r\n// Export for different module systems\r\nif (typeof module !== 'undefined' && module.exports) {\r\n  module.exports = { OverlayRegistry, MapEntry, overlayRegistry };\r\n}\r\n// Always attach to window if available (for debugging)\r\nif (typeof window !== 'undefined') {\r\n  window.OverlayRegistry = OverlayRegistry;\r\n  window.MapEntry = MapEntry;\r\n  window.overlayRegistry = overlayRegistry;\r\n  if (window.overlayRegistry) {\r\n    console.log('[OverlayRegistry] overlayRegistry attached to window:', window.overlayRegistry);\r\n  }\r\n}\r\n", "// [SOURCE: bridge/main.js]\n/**\r\n * POI Bridge: Main Entry\r\n * Orchestrates the lifecycle of the bridge in the page's MAIN world.\r\n * \r\n * Event-driven architecture:\r\n * - Bridge starts immediately on script load\r\n * - Announces readiness via POI_BRIDGE_READY \u2192 content script responds with POI data\r\n * - Listens for POI_DATA_UPDATE from content script \u2192 renders via poiRenderer (native markers)\r\n * - Loop continuously re-renders from cached POI data for any newly discovered maps\r\n * \r\n * Rendering: ALL rendering goes through window.poiRenderer (poi-native-marker).\r\n * Site configurations from siteConfig.js provide per-site styles, selectors, and features.\r\n */\r\n(function() {\r\n  const PREFIX = '[BRIDGE] ';\r\n  let attempts = 0;\r\n  let registryInitialized = false;\r\n  let lastReceivedPois = []; // Cache POIs received from content script\r\n\r\n  function extractBounds(map) {\r\n    try {\r\n      const b = map.getBounds();\r\n      if (!b) return null;\r\n      if (b.getNorthEast) return { north: b.getNorthEast().lat(), south: b.getSouthWest().lat(), east: b.getNorthEast().lng(), west: b.getSouthWest().lng() };\r\n      if (b.getNorth) return { north: b.getNorth(), south: b.getSouth(), east: b.getEast(), west: b.getWest() };\r\n    } catch(e) {}\r\n    return null;\r\n  }\r\n\r\n  /**\r\n   * Initializes the overlay registry\r\n   * Only called once when all dependencies are ready\r\n   */\r\n  function initializeRegistry() {\r\n    if (registryInitialized) return;\r\n    \r\n    if (window.overlayRegistry) {\r\n      registryInitialized = true;\r\n      console.log(PREFIX + 'OverlayRegistry initialized');\r\n    }\r\n  }\r\n\r\n  let loopCount = 0;\r\n  function loop() {\r\n    loopCount++;\r\n    // Log heartbeat every 20 iterations (10 seconds)\r\n    if (loopCount % 20 === 0) {\r\n      const maps = window.poiHijack ? window.poiHijack.activeMaps.size : '?';\r\n      console.log(`${PREFIX}heartbeat #${loopCount}: maps=${maps}, cachedPois=${lastReceivedPois.length}`);\r\n    }\r\n\r\n    // 1. Dependency Guard\r\n    if (!window.poiHijack || !window.poiDiscovery || !window.poiPortal) {\r\n      if (attempts < 20) {\r\n         attempts++;\r\n         return; \r\n      }\r\n      console.warn(PREFIX + 'Bridge modules missing after 20s.');\r\n      return;\r\n    }\r\n\r\n    // 2. Initialize Registry (once) \u2014 still used for domain detection & bounds tracking\r\n    initializeRegistry();\r\n    \r\n    // 3. RE-HIJACK: Try to hijack Google Maps if it loaded after initial attempt\r\n    if (window.google?.maps?.Map && !window.google.maps.Map._isHijacked) {\r\n      console.log(PREFIX + 'Google Maps now available, hijacking...');\r\n      window.poiHijack.hijackGoogle(window.google.maps);\r\n    }\r\n\r\n    // 4. Announce bridge readiness (once)\r\n    if (!window.poiBridgeReady) {\r\n       window.poiBridgeReady = true;\r\n       console.log(PREFIX + 'POI Bridge Active');\r\n       document.documentElement.setAttribute('data-poi-bridge-status', 'ONLINE');\r\n       // Event: Tell content script we're ready to receive POI data\r\n       window.postMessage({ type: 'POI_BRIDGE_READY' }, '*');\r\n    }\r\n\r\n    // 5. Capture & Discovery (isolated try-catches)\r\n    try {\r\n      window.poiHijack.apply();\r\n    } catch(e) {\r\n      console.error(PREFIX + 'Hijack error:', e);\r\n    }\r\n    \r\n    try {\r\n      window.poiDiscovery.run();\r\n    } catch(e) {\r\n      console.error(PREFIX + 'Discovery error:', e);\r\n    }\r\n\r\n    try {\r\n      // 6. Update Portal from captured instances\r\n      for (const map of window.poiHijack.activeMaps) {\r\n        const res = extractBounds(map);\r\n        if (res && res.north) { \r\n          window.poiPortal.update(res, 'instance-capture'); \r\n          if (window.overlayRegistry) {\r\n            window.overlayRegistry.updateBounds(map, res);\r\n          }\r\n          break; \r\n        }\r\n      }\r\n      \r\n      // 7. Continuous re-render via native renderer\r\n      // poiRenderer iterates poiHijack.activeMaps directly \u2014 the sole rendering path.\r\n      if (window.poiRenderer && lastReceivedPois.length > 0) {\r\n        window.poiRenderer.update(lastReceivedPois);\r\n      }\r\n    } catch(e) {\r\n      console.error(PREFIX + 'Loop error:', e);\r\n    }\r\n  }\r\n\r\n  // \u2500\u2500\u2500 Start Orchestration \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\r\n  setInterval(loop, 500);\r\n  \r\n  // Periodic registry cleanup (every 5 minutes)\r\n  setInterval(() => {\r\n    if (window.overlayRegistry) {\r\n      window.overlayRegistry.cleanup();\r\n    }\r\n  }, 300000);\r\n  \r\n  // \u2500\u2500\u2500 Listen for Data from Content Script \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\r\n  window.addEventListener('message', (event) => {\r\n    if (!event.data) return;\r\n\r\n    if (event.data.type === 'POI_DATA_UPDATE') {\r\n       console.log(`${PREFIX}POI_DATA_UPDATE received: ${event.data.pois.length} POIs`);\r\n       lastReceivedPois = event.data.pois;\r\n\r\n       // Render via native renderer \u2014 the sole rendering path\r\n       if (window.poiRenderer) {\r\n          window.poiRenderer.update(event.data.pois);\r\n       }\r\n    }\r\n  });\r\n  \r\n  // Force immediate apply on script load\r\n  if (window.poiHijack) window.poiHijack.apply();\r\n  \r\n  loop();\r\n})();\r\n", "// [SOURCE: bridge/modules/ManagerBase.js]\n/**\r\n * POI Bridge: Manager Base Class\r\n * Base class for all manager singletons with initialization lifecycle.\r\n */\r\n\r\n/**\r\n * ManagerBase - Abstract base class for manager singletons\r\n * \r\n * Provides:\r\n * - Singleton pattern enforcement\r\n * - Initialization lifecycle management\r\n * - Cleanup interface\r\n * \r\n * @abstract\r\n */\r\nclass ManagerBase {\r\n  /**\r\n   * Creates a new ManagerBase instance (or returns existing singleton)\r\n   */\r\n  constructor() {\r\n    // Singleton pattern enforcement\r\n    if (this.constructor.instance) {\r\n      return this.constructor.instance;\r\n    }\r\n    this.constructor.instance = this;\r\n    \r\n    this.initialized = false;\r\n    this.initializing = false;\r\n    this._debug = false;\r\n  }\r\n\r\n  /**\r\n   * Enable or disable debug logging\r\n   * @param {boolean} enabled - Enable debug mode\r\n   */\r\n  setDebug(enabled) {\r\n    this._debug = enabled;\r\n  }\r\n\r\n  /**\r\n   * Logs debug messages if debug mode is enabled\r\n   * @param {...any} args - Arguments to log\r\n   */\r\n  log(...args) {\r\n    if (this._debug) {\r\n      console.log(`[${this.constructor.name}]`, ...args);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Logs warnings regardless of debug mode\r\n   * @param {...any} args - Arguments to log\r\n   */\r\n  warn(...args) {\r\n    console.warn(`[${this.constructor.name}]`, ...args);\r\n  }\r\n\r\n  /**\r\n   * Logs errors regardless of debug mode\r\n   * @param {...any} args - Arguments to log\r\n   */\r\n  error(...args) {\r\n    console.error(`[${this.constructor.name}]`, ...args);\r\n  }\r\n\r\n  /**\r\n   * Initializes the manager (idempotent - only runs once)\r\n   * @returns {Promise<void>}\r\n   */\r\n  async initialize() {\r\n    if (this.initialized) {\r\n      this.log('Already initialized, skipping');\r\n      return;\r\n    }\r\n\r\n    if (this.initializing) {\r\n      this.log('Initialization in progress, waiting...');\r\n      // Wait for existing initialization to complete\r\n      while (this.initializing) {\r\n        await new Promise(resolve => setTimeout(resolve, 10));\r\n      }\r\n      return;\r\n    }\r\n\r\n    this.initializing = true;\r\n    this.log('Initializing...');\r\n\r\n    try {\r\n      await this.onInitialize();\r\n      this.initialized = true;\r\n      this.log('Initialization complete');\r\n    } catch (e) {\r\n      this.error('Initialization failed:', e);\r\n      throw e;\r\n    } finally {\r\n      this.initializing = false;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Called during initialization - must be implemented by subclasses\r\n   * @abstract\r\n   * @returns {Promise<void>}\r\n   */\r\n  async onInitialize() {\r\n    throw new Error('Must implement onInitialize()');\r\n  }\r\n\r\n  /**\r\n   * Cleans up resources and resets state\r\n   * @abstract\r\n   */\r\n  cleanup() {\r\n    throw new Error('Must implement cleanup()');\r\n  }\r\n\r\n  /**\r\n   * Resets the singleton instance (useful for testing)\r\n   */\r\n  static reset() {\r\n    if (this.instance) {\r\n      try {\r\n        this.instance.cleanup();\r\n      } catch (e) {\r\n        console.warn('Cleanup during reset failed:', e);\r\n      }\r\n      this.instance = null;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Gets the singleton instance\r\n   * @returns {ManagerBase} The singleton instance\r\n   */\r\n  static getInstance() {\r\n    if (!this.instance) {\r\n      this.instance = new this();\r\n    }\r\n    return this.instance;\r\n  }\r\n}\r\n\r\nif (typeof window !== 'undefined') {\r\n  window.ManagerBase = ManagerBase;\r\n}\r\n", "// [SOURCE: bridge/entry.js]\n// bridge/entry.js\r\n// Imports all bridge modules for bundling\r\n\r\nimport '../bridge/main.js';\r\n\r\n// Bridge modules (base classes first)\r\nimport '../bridge/modules/ManagerBase.js';\r\nimport '../bridge/modules/mapUtilities.js';\r\nimport '../bridge/modules/hijack.js';\r\nimport '../bridge/modules/discovery.js';\r\n// import '../bridge/modules/sniff.js'; // DISABLED: Network sniffing removed for security (bounds tracked via instance events)\r\nimport '../bridge/modules/portal.js';\r\nimport '../bridge/modules/renderer.js';\r\n\r\n// Site configuration and registry\r\nimport '../overlays/siteConfig.js';\r\nimport '../overlays/OverlayRegistry.js';\r\n\r\n", "// [SOURCE: bridge/modules/renderer.js]\n/**\r\n * POI Bridge: Renderer Module\r\n * The PRIMARY rendering engine for all map types.\r\n * Handles injecting native map markers (poi-native-marker) into hijacked map instances.\r\n * \r\n * Supports:\r\n * - Google Maps (via PoiBatchOverlay / PoiCustomOverlay with google.maps.OverlayView)\r\n * - Mapbox GL JS (via mapboxgl.Marker with poi-native-marker-mapbox class)\r\n * \r\n * Site-specific overlay classes (overlays/ folder) handle domain detection,\r\n * bounds tracking, and OverlayRegistry management \u2014 but NOT rendering.\r\n * All rendering flows through window.poiRenderer.update(pois).\r\n */\r\nwindow.poiRenderer = {\r\n  activeMarkers: new Map(), // Map<id, NativeMarker>\r\n  lastPoiData: [],\r\n  configCache: new WeakMap(), // Cache configs per map instance\r\n  siteConfigReady: false,\r\n  \r\n  /**\r\n   * Checks if siteConfig is ready and initializes it\r\n   */\r\n  ensureSiteConfig() {\r\n    if (this.siteConfigReady) return true;\r\n    \r\n    if (window.siteConfig && typeof window.siteConfig.getConfig === 'function') {\r\n      this.siteConfigReady = true;\r\n      console.log('[Renderer] siteConfig ready');\r\n      return true;\r\n    }\r\n    \r\n    return false;\r\n  },\r\n  \r\n  /**\r\n   * Gets the domain for a map instance\r\n   */\r\n  getMapDomain(map) {\r\n    try {\r\n      // Try getDiv for Google Maps\r\n      if (typeof map.getDiv === 'function') {\r\n        const div = map.getDiv();\r\n        if (div && div.ownerDocument && div.ownerDocument.location) {\r\n          return div.ownerDocument.location.hostname;\r\n        }\r\n      }\r\n      \r\n      // Try _container for Mapbox\r\n      if (map._container && map._container.ownerDocument && map._container.ownerDocument.location) {\r\n        return map._container.ownerDocument.location.hostname;\r\n      }\r\n      \r\n      // Fallback to window\r\n      if (window === window.top) {\r\n        return window.location.hostname;\r\n      }\r\n    } catch (e) {\r\n      // Cross-origin or error\r\n    }\r\n    return '';\r\n  },\r\n  \r\n  /**\r\n   * Gets site configuration for a map (cached per map instance)\r\n   */\r\n  getSiteConfig(map) {\r\n    // Check cache first\r\n    if (this.configCache.has(map)) {\r\n      return this.configCache.get(map);\r\n    }\r\n    \r\n    // Ensure siteConfig is ready\r\n    if (!this.ensureSiteConfig()) {\r\n      console.warn('[Renderer] siteConfig not ready yet, using defaults');\r\n      const defaults = { styles: { markerZIndex: 5000, markerHoverZIndex: 1000000 } };\r\n      return defaults;\r\n    }\r\n    \r\n    const domain = this.getMapDomain(map);\r\n    const config = window.siteConfig.getConfig(domain);\r\n    \r\n    // Cache it\r\n    this.configCache.set(map, config);\r\n    \r\n    return config;\r\n  },\r\n  \r\n   clear() {\r\n      this.lastPoiData = [];\r\n      // Clear Mapbox markers\r\n      this.activeMarkers.forEach((marker) => {\r\n         if (marker && typeof marker.remove === 'function') {\r\n            marker.remove();\r\n         } else if (marker && typeof marker.setMap === 'function') {\r\n            marker.setMap(null);\r\n         }\r\n      });\r\n      this.activeMarkers.clear();\r\n\r\n      // Clear Google batch overlays if present\r\n      if (window.poiHijack && window.poiHijack.activeMaps) {\r\n         for (const map of window.poiHijack.activeMaps) {\r\n            if (map && map._poiBatchLayer) {\r\n               try {\r\n                  map._poiBatchLayer.setMap(null);\r\n               } catch (e) {}\r\n               if (map._poiBatchLayer.container) {\r\n                  map._poiBatchLayer.container.remove();\r\n               }\r\n               map._poiBatchLayer = null;\r\n            }\r\n         }\r\n      }\r\n   },\r\n  \r\n  update(pois) {\r\n    this.lastPoiData = pois;\r\n    \r\n    // We iterate over all active maps found by Hijack module\r\n    if (!window.poiHijack || !window.poiHijack.activeMaps) return;\r\n    \r\n    for (const map of window.poiHijack.activeMaps) {\r\n      if (this.isGoogleMap(map)) {\r\n        this.renderGoogle(map, pois);\r\n      } else if (this.isMapbox(map)) {\r\n        this.renderMapbox(map, pois);\r\n      }\r\n    }\r\n  },\r\n\r\n  isGoogleMap(map) {\r\n    return (map.overlayMapTypes !== undefined || typeof map.getDiv === 'function');\r\n  },\r\n\r\n  isMapbox(map) {\r\n    return (map.addSource !== undefined && map.addLayer !== undefined && map.on !== undefined);\r\n  },\r\n\r\n  renderGoogle(map, pois) {\r\n    // Check if OverlayView is available\r\n    if (!window.google || !window.google.maps || !window.google.maps.OverlayView) return;\r\n\r\n    // Define Custom Overlay Class if not defined\r\n    if (!window.PoiCustomOverlay) {\r\n       class PoiCustomOverlay extends window.google.maps.OverlayView {\r\n          constructor(poi, element) {\r\n             super();\r\n             this.poi = poi;\r\n             this.element = element;\r\n          }\r\n          onAdd() {\r\n             this.getPanes().floatPane.appendChild(this.element);\r\n          }\r\n          draw() {\r\n             const overlayProjection = this.getProjection();\r\n             const position = new window.google.maps.LatLng(this.poi.latitude, this.poi.longitude);\r\n             const pos = overlayProjection.fromLatLngToDivPixel(position);\r\n             if (pos) {\r\n                this.element.style.left = pos.x + 'px';\r\n                this.element.style.top = pos.y + 'px';\r\n             }\r\n          }\r\n          onRemove() {\r\n             if (this.element.parentNode) this.element.parentNode.removeChild(this.element);\r\n          }\r\n       }\r\n       window.PoiCustomOverlay = PoiCustomOverlay;\r\n    }\r\n\r\n    // NEW: Batch Overlay for Massive Performance\r\n    // Instead of N overlay views, we use ONE overlay view for ALL markers on this map.\r\n    if (!window.PoiBatchOverlay) {\r\n       class PoiBatchOverlay extends window.google.maps.OverlayView {\r\n          constructor(mapInstance) {\r\n             super();\r\n             this.mapInstance = mapInstance;\r\n             this.container = document.createElement('div');\r\n             this.container.style.cssText = 'position: absolute; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none;';\r\n             this.pois = [];\r\n             this.markerPool = []; // Pool of DIVs\r\n             this.activeElements = new Map(); // POI ID -> Element\r\n             this.hasPendingDraw = false;\r\n             \r\n             // Event Delegation\r\n             this.container.addEventListener('click', (e) => {\r\n                const target = e.target.closest('.poi-native-marker');\r\n                if (target) {\r\n                   e.stopPropagation();\r\n                   // Read data attributes\r\n                   const id = target.getAttribute('data-id');\r\n                   const lat = parseFloat(target.getAttribute('data-lat'));\r\n                   const lng = parseFloat(target.getAttribute('data-lng'));\r\n                   window.postMessage({ type: 'POI_MARKER_CLICK', id, lat, lng }, '*');\r\n                }\r\n             }, true); // Capture phase to beat Google Maps listeners\r\n             \r\n             this.container.addEventListener('mouseenter', (e) => {\r\n                const target = e.target.closest('.poi-native-marker');\r\n                if (target) {\r\n                   const config = window.poiRenderer.getSiteConfig(this.mapInstance);\r\n                   target.style.zIndex = (config.styles.markerHoverZIndex || 1000000).toString();\r\n                   const id = target.getAttribute('data-id');\r\n                   const lat = parseFloat(target.getAttribute('data-lat'));\r\n                   const lng = parseFloat(target.getAttribute('data-lng'));\r\n                   const message = { type: 'POI_MARKER_HOVER', id, lat, lng };\r\n                   console.log('[Renderer] Posting hover event:', message);\r\n                   window.postMessage(message, '*');\r\n                }\r\n             }, true);\r\n             \r\n             this.container.addEventListener('mouseleave', (e) => {\r\n                const target = e.target.closest('.poi-native-marker');\r\n                if (target) {\r\n                   const config = window.poiRenderer.getSiteConfig(this.mapInstance);\r\n                   target.style.zIndex = (config.styles.markerZIndex || 5000).toString();\r\n                   const id = target.getAttribute('data-id');\r\n                   window.postMessage({ type: 'POI_MARKER_LEAVE', id }, '*');\r\n                }\r\n             }, true);\r\n          }\r\n          \r\n          updatePois(newPois) {\r\n             this.pois = newPois;\r\n             // Trigger redraw\r\n             if (this.getProjection()) this.draw();\r\n          }\r\n\r\n          onAdd() {\r\n             this.getPanes().floatPane.appendChild(this.container);\r\n          }\r\n\r\n          onRemove() {\r\n             if (this.container.parentNode) this.container.parentNode.removeChild(this.container);\r\n          }\r\n\r\n          draw() {\r\n             if (this.hasPendingDraw) return;\r\n             this.hasPendingDraw = true;\r\n             \r\n             requestAnimationFrame(() => {\r\n                this.hasPendingDraw = false;\r\n                this._drawBatch();\r\n             });\r\n          }\r\n          \r\n          _drawBatch() {\r\n             const projection = this.getProjection();\r\n             if (!projection) return;\r\n             \r\n             const bounds = this.mapInstance.getBounds();\r\n             if (!bounds) return;\r\n             \r\n             // Diff Strategy:\r\n             // 1. Identify POIs currently in view\r\n             // 2. Recycle elements for POIs no longer in view\r\n             // 3. Create/Reuse elements for POIs now in view\r\n             \r\n             const visibleIds = new Set();\r\n             const fragment = document.createDocumentFragment();\r\n             \r\n             this.pois.forEach(poi => {\r\n                const lat = parseFloat(poi.latitude);\r\n                const lng = parseFloat(poi.longitude);\r\n                const latLng = new window.google.maps.LatLng(lat, lng);\r\n                \r\n                // Bounds Check\r\n                if (!bounds.contains(latLng)) return;\r\n                \r\n                const id = poi.id || poi.name;\r\n                visibleIds.add(id);\r\n                \r\n                const pos = projection.fromLatLngToDivPixel(latLng);\r\n                \r\n                let el = this.activeElements.get(id);\r\n                \r\n                if (!el) {\r\n                   // Get from pool or create\r\n                   if (this.markerPool.length > 0) {\r\n                      el = this.markerPool.pop();\r\n                   } else {\r\n                      el = document.createElement('div');\r\n                      el.className = 'poi-native-marker';\r\n                      // Styles are set once, only transform changes\r\n                      const config = window.poiRenderer.getSiteConfig(this.mapInstance);\r\n                      const baseZIndex = config.styles.markerZIndex || 5000;\r\n                      el.style.cssText = `\r\n                        position: absolute; width: 32px; height: 32px;\r\n                        background-size: contain; background-repeat: no-repeat;\r\n                        pointer-events: auto; cursor: pointer; z-index: ${baseZIndex};\r\n                        will-change: transform; top: 0; left: 0;\r\n                        filter: drop-shadow(0px 2px 4px rgba(0,0,0,0.4));\r\n                      `;\r\n                   }\r\n                   \r\n                   // Update visual content (Logo/Color)\r\n                   const color = poi.color || '#ff0000';\r\n                   const secondaryColor = poi.secondaryColor || '#ffffff';\r\n                   // Inline SVG construction (optimized string concat)\r\n                   const svg = `data:image/svg+xml;charset=utf-8,` + encodeURIComponent(`\r\n                     <svg width=\"32\" height=\"32\" viewBox=\"0 0 24 24\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\r\n                       <path d=\"M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z\" fill=\"${color}\" stroke=\"${secondaryColor}\" stroke-width=\"1\"/>\r\n                     </svg>`);\r\n                   el.style.backgroundImage = `url('${poi.logoData || svg}')`;\r\n                   \r\n                   // Store Data Attributes for Delegation\r\n                   el.setAttribute('data-id', id);\r\n                   el.setAttribute('data-lat', lat);\r\n                   el.setAttribute('data-lng', lng);\r\n                   \r\n                   this.activeElements.set(id, el);\r\n                   fragment.appendChild(el);\r\n                } else {\r\n                   // Ensure it's attached (might be re-added if logic changes, but usually stays in DOM)\r\n                   // If we are reusing, we don't append to fragment unless it was detached.\r\n                   // Here we assume it stays attached.\r\n                }\r\n                \r\n                // Update Position (Transform is faster than top/left)\r\n                // translate(-50%, -100%) handles the anchor point (bottom center)\r\n                el.style.transform = `translate(-50%, -100%) translate(${Math.round(pos.x)}px, ${Math.round(pos.y)}px)`;\r\n             });\r\n             \r\n             // Append new elements\r\n             if (fragment.childElementCount > 0) {\r\n                this.container.appendChild(fragment);\r\n             }\r\n             \r\n             // Cleanup hidden elements (Return to pool)\r\n             this.activeElements.forEach((el, id) => {\r\n                if (!visibleIds.has(id)) {\r\n                   el.remove(); // Detach from DOM\r\n                   this.markerPool.push(el); // Add to pool\r\n                   this.activeElements.delete(id);\r\n                }\r\n             });\r\n          }\r\n       }\r\n       window.PoiBatchOverlay = PoiBatchOverlay;\r\n    }\r\n\r\n    // Identify/Create Batch Layer for this map instance\r\n    if (!map._poiBatchLayer) {\r\n       map._poiBatchLayer = new window.PoiBatchOverlay(map);\r\n       map._poiBatchLayer.setMap(map);\r\n    }\r\n    \r\n    // Update Data\r\n    map._poiBatchLayer.updatePois(pois);\r\n  },\r\n\r\n  renderMapbox(map, pois) {\r\n    if (!window.mapboxgl || !window.mapboxgl.Marker) return;\r\n    \r\n    if (!map._poiUid) map._poiUid = Math.random().toString(36).substr(2, 9);\r\n    const usedIds = new Set();\r\n\r\n    pois.forEach(poi => {\r\n       const id = `${map._poiUid}-${poi.id || poi.name}`;\r\n       usedIds.add(id);\r\n       \r\n       if (this.activeMarkers.has(id)) return;\r\n\r\n       const el = document.createElement('div');\r\n       el.className = 'poi-native-marker-mapbox';\r\n       const color = poi.color || '#ff0000';\r\n       const secondaryColor = poi.secondaryColor || '#ffffff';\r\n       const logo = poi.logoData;\r\n       \r\n       // Fallback SVG if no logo\r\n       const fallbackSvg = `data:image/svg+xml;charset=utf-8,${encodeURIComponent(`\r\n         <svg width=\"32\" height=\"32\" viewBox=\"0 0 24 24\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\r\n           <path d=\"M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z\" fill=\"${color}\" stroke=\"${secondaryColor}\" stroke-width=\"1\"/>\r\n         </svg>\r\n       `)}`;\r\n\r\n       const config = this.getSiteConfig(map);\r\n       const baseZIndex = config.styles.markerZIndex || 5000;\r\n       \r\n       el.style.cssText = `\r\n         width: 32px; height: 32px; cursor: pointer; z-index: ${baseZIndex};\r\n         background-image: url('${logo || fallbackSvg}');\r\n         background-size: contain; background-repeat: no-repeat;\r\n         filter: drop-shadow(0px 2px 4px rgba(0,0,0,0.4));\r\n       `;\r\n       \r\n       el.onclick = (e) => {\r\n          e.stopPropagation();\r\n          window.postMessage({ type: 'POI_MARKER_CLICK', id: poi.id, lat: poi.latitude, lng: poi.longitude }, '*');\r\n       };\r\n       \r\n       // Hover Listeners\r\n       el.onmouseenter = () => {\r\n          const hoverZIndex = config.styles.markerHoverZIndex || 1000000;\r\n          el.style.zIndex = hoverZIndex.toString();\r\n          const message = { type: 'POI_MARKER_HOVER', id: poi.id, lat: poi.latitude, lng: poi.longitude };\r\n          console.log('[Renderer] Posting hover event (Mapbox):', message);\r\n          window.postMessage(message, '*');\r\n       };\r\n       \r\n       el.onmouseleave = () => {\r\n          el.style.zIndex = baseZIndex.toString();\r\n          window.postMessage({ type: 'POI_MARKER_LEAVE', id: poi.id }, '*');\r\n       };\r\n\r\n       const marker = new window.mapboxgl.Marker({ element: el })\r\n          .setLngLat([parseFloat(poi.longitude), parseFloat(poi.latitude)])\r\n          .addTo(map);\r\n          \r\n       this.activeMarkers.set(id, marker);\r\n    });\r\n\r\n    for (const [id, marker] of this.activeMarkers) {\r\n       if (id.startsWith(map._poiUid) && !usedIds.has(id)) {\r\n          marker.remove();\r\n          this.activeMarkers.delete(id);\r\n       }\r\n    }\r\n  }\r\n};\r\n"],
  "mappings": "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",
  "names": ["HijackedMap", "entry", "ManagerBase"]
}
