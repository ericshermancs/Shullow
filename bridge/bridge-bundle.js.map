{
  "version": 3,
  "sources": ["modules/mapUtilities.js", "modules/hijack.js", "modules/discovery.js", "modules/portal.js", "../overlays/ZillowOverlay.js", "../overlays/RedfinOverlay.js", "../overlays/HomesComOverlay.js", "../overlays/OneKeyOverlay.js", "../overlays/RealtorOverlay.js", "../overlays/GenericMapOverlay.js", "../overlays/OverlayRegistry.js", "../overlays/overlayFactory.js", "main.js", "modules/ManagerBase.js", "entry.js", "modules/renderer.js", "../overlays/MapOverlayBase.js", "../overlays/GoogleMapsOverlayBase.js", "../overlays/MapboxOverlayBase.js"],
  "sourcesContent": ["// [SOURCE: bridge/modules/mapUtilities.js]\n/**\r\n * POI Bridge: Map Utilities Module\r\n * Provides shared utilities for map rendering across different platforms.\r\n */\r\n\r\n/**\r\n * MapUtils - Static utility methods for map operations\r\n */\r\nclass MapUtils {\r\n  /**\r\n   * Generates a fallback SVG marker icon\r\n   * @param {string} color - Primary fill color (default: #ff0000)\r\n   * @param {string} secondaryColor - Stroke color (default: #ffffff)\r\n   * @param {number} size - Size in pixels (default: 32)\r\n   * @returns {string} Data URI for the SVG\r\n   */\r\n  static generateFallbackSVG(color = '#ff0000', secondaryColor = '#ffffff', size = 32) {\r\n    const svg = `<svg width=\"${size}\" height=\"${size}\" viewBox=\"0 0 24 24\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\r\n      <path d=\"M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z\" fill=\"${color}\" stroke=\"${secondaryColor}\" stroke-width=\"1\"/>\r\n    </svg>`;\r\n    return `data:image/svg+xml;charset=utf-8,${encodeURIComponent(svg)}`;\r\n  }\r\n\r\n  /**\r\n   * Creates marker element styles as a CSS string\r\n   * @param {Object} options - Style options\r\n   * @param {string} options.backgroundImage - URL or data URI for the marker image\r\n   * @param {number} options.size - Size in pixels (default: 32)\r\n   * @param {number} options.zIndex - z-index value (default: 102)\r\n   * @returns {string} CSS style string\r\n   */\r\n  static getMarkerStyles(options = {}) {\r\n    const { backgroundImage, size = 32, zIndex = 102 } = options;\r\n    return `\r\n      position: absolute;\r\n      width: ${size}px;\r\n      height: ${size}px;\r\n      background-image: url('${backgroundImage}');\r\n      background-size: contain;\r\n      background-repeat: no-repeat;\r\n      pointer-events: auto;\r\n      cursor: pointer;\r\n      z-index: ${zIndex};\r\n      will-change: transform;\r\n      top: 0;\r\n      left: 0;\r\n      filter: drop-shadow(0px 2px 4px rgba(0,0,0,0.4));\r\n    `.trim().replace(/\\s+/g, ' ');\r\n  }\r\n\r\n  /**\r\n   * Extracts domain from a URL\r\n   * @param {string} url - The URL to extract domain from\r\n   * @returns {string} The domain (e.g., 'zillow.com')\r\n   */\r\n  static getDomain(url) {\r\n    try {\r\n      const parsed = new URL(url);\r\n      // Remove 'www.' prefix if present\r\n      return parsed.hostname.replace(/^www\\./, '');\r\n    } catch (e) {\r\n      return '';\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Generates a unique ID for a POI\r\n   * @param {Object} poi - POI object\r\n   * @returns {string} Unique identifier\r\n   */\r\n  static getPoiId(poi) {\r\n    return poi.id || poi.name || `${poi.latitude}_${poi.longitude}`;\r\n  }\r\n}\r\n\r\n/**\r\n * MarkerPool - Recycles DOM elements to reduce GC pressure\r\n */\r\nclass MarkerPool {\r\n  constructor() {\r\n    this.pool = [];\r\n    this.maxPoolSize = 100; // Limit pool size to prevent memory bloat\r\n  }\r\n\r\n  /**\r\n   * Acquires an element from the pool or creates a new one\r\n   * @param {Function} createFn - Factory function to create new element if pool is empty\r\n   * @returns {HTMLElement} DOM element\r\n   */\r\n  acquire(createFn) {\r\n    if (this.pool.length > 0) {\r\n      return this.pool.pop();\r\n    }\r\n    return createFn ? createFn() : document.createElement('div');\r\n  }\r\n\r\n  /**\r\n   * Releases an element back to the pool for reuse\r\n   * @param {HTMLElement} element - Element to return to pool\r\n   */\r\n  release(element) {\r\n    if (!element) return;\r\n    \r\n    // Detach from DOM if attached\r\n    if (element.parentNode) {\r\n      element.remove();\r\n    }\r\n    \r\n    // Only pool if under max size\r\n    if (this.pool.length < this.maxPoolSize) {\r\n      this.pool.push(element);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Clears all elements from the pool\r\n   */\r\n  clear() {\r\n    this.pool = [];\r\n  }\r\n\r\n  /**\r\n   * Gets the current pool size\r\n   * @returns {number} Number of elements in pool\r\n   */\r\n  get size() {\r\n    return this.pool.length;\r\n  }\r\n}\r\n\r\n/**\r\n * MapTypeDetector - Identifies map library type from instance\r\n */\r\nclass MapTypeDetector {\r\n  /**\r\n   * Checks if the map instance is a Google Maps instance\r\n   * @param {Object} map - Map instance to check\r\n   * @returns {boolean} True if Google Maps\r\n   */\r\n  static isGoogleMap(map) {\r\n    if (!map) return false;\r\n    return (\r\n      map.overlayMapTypes !== undefined ||\r\n      typeof map.getDiv === 'function' ||\r\n      (typeof map.setCenter === 'function' && typeof map.fitBounds === 'function' && !map.addSource)\r\n    );\r\n  }\r\n\r\n  /**\r\n   * Checks if the map instance is a Mapbox GL JS instance\r\n   * @param {Object} map - Map instance to check\r\n   * @returns {boolean} True if Mapbox GL JS\r\n   */\r\n  static isMapbox(map) {\r\n    if (!map) return false;\r\n    return (\r\n      map.addSource !== undefined &&\r\n      map.addLayer !== undefined &&\r\n      typeof map.on === 'function'\r\n    );\r\n  }\r\n\r\n  /**\r\n   * Checks if the map instance is a Leaflet instance\r\n   * @param {Object} map - Map instance to check\r\n   * @returns {boolean} True if Leaflet\r\n   */\r\n  static isLeaflet(map) {\r\n    if (!map) return false;\r\n    return (\r\n      map._leaflet_id !== undefined ||\r\n      (typeof map.addLayer === 'function' && typeof map.removeLayer === 'function' && !map.addSource)\r\n    );\r\n  }\r\n\r\n  /**\r\n   * Detects and returns the map type as a string\r\n   * @param {Object} map - Map instance to check\r\n   * @returns {string} 'google' | 'mapbox' | 'leaflet' | 'unknown'\r\n   */\r\n  static detect(map) {\r\n    if (this.isGoogleMap(map)) return 'google';\r\n    if (this.isMapbox(map)) return 'mapbox';\r\n    if (this.isLeaflet(map)) return 'leaflet';\r\n    return 'unknown';\r\n  }\r\n}\r\n\r\n// Export for different module systems\r\nif (typeof module !== 'undefined' && module.exports) {\r\n  module.exports = { MapUtils, MarkerPool, MapTypeDetector };\r\n} else if (typeof window !== 'undefined') {\r\n  window.MapUtils = MapUtils;\r\n  window.MarkerPool = MarkerPool;\r\n  window.MapTypeDetector = MapTypeDetector;\r\n}\r\n", "// [SOURCE: bridge/modules/hijack.js]\n/**\r\n * POI Bridge: Hijack Module\r\n * Captures map instances via constructor interception.\r\n * \r\n * Converted to OOP class extending ManagerBase for singleton pattern\r\n * and initialization lifecycle management.\r\n */\r\n\r\n/**\r\n * MapHijackManager - Captures and manages map instances\r\n * \r\n * Features:\r\n * - Intercepts Google Maps and Mapbox constructors\r\n * - Attaches event listeners for bounds updates\r\n * - Maintains a Set of active map instances\r\n * - Provides backdoor capture via prototype hijacking\r\n */\r\nclass MapHijackManager extends ManagerBase {\r\n  constructor() {\r\n    super();\r\n    this.activeMaps = new Set();\r\n    this.originalConstructors = {};\r\n  }\r\n\r\n  /**\r\n   * @override\r\n   * Called during initialization\r\n   */\r\n  async onInitialize() {\r\n    this.interceptConstructors();\r\n    this.log('MapHijackManager initialized');\r\n  }\r\n\r\n  /**\r\n   * @override\r\n   * Cleanup and restore original constructors\r\n   */\r\n  cleanup() {\r\n    // Note: We don't restore constructors as it could break the page\r\n    // Just clear our state\r\n    this.activeMaps.clear();\r\n    this.initialized = false;\r\n    this.log('MapHijackManager cleaned up');\r\n  }\r\n\r\n  /**\r\n   * Attaches event listeners to a captured map instance\r\n   * @param {Object} instance - The map instance\r\n   */\r\n  attachListeners(instance) {\r\n    if (!instance || instance._poiListener) return;\r\n    console.log('[POI TITAN] Attaching listeners to captured instance');\r\n    \r\n    // Unwrap if it's a wrapper (Redfin specific)\r\n    let target = instance;\r\n    if (!target.addListener && !target.on) {\r\n       if (target.map && (target.map.addListener || target.map.on)) target = target.map;\r\n       else if (target.getMap && typeof target.getMap === 'function') {\r\n          const m = target.getMap();\r\n          if (m && (m.addListener || m.on)) target = m;\r\n       }\r\n    }\r\n\r\n    try {\r\n      if (target.on) { // Mapbox\r\n        const update = () => {\r\n          if (typeof target.getBounds === 'function') {\r\n            const b = target.getBounds();\r\n            if (b) {\r\n              window.poiPortal.update({\r\n                north: b.getNorth(), south: b.getSouth(),\r\n                east: b.getEast(), west: b.getWest()\r\n              }, 'instance-event');\r\n            }\r\n          }\r\n        };\r\n        // Redfin might throttle 'move', try 'moveend' too\r\n        const safeUpdate = () => {\r\n           try { update(); } catch(e) {}\r\n        };\r\n        \r\n        // OPTIMIZATION: Only listen to 'moveend' to reduce flicker and load during drag\r\n        // 'move' fires 60fps, which is unnecessary for POI updates\r\n        // target.on('move', safeUpdate); \r\n        target.on('moveend', safeUpdate);\r\n        // target.on('zoom', safeUpdate);\r\n        target.on('zoomend', safeUpdate);\r\n        \r\n        instance._poiListener = true; // Mark original instance as processed\r\n      } else if (target.addListener) { // Google Maps\r\n        const update = () => {\r\n          // console.log('[POI TITAN] Google Maps event fired');\r\n          if (typeof target.getBounds === 'function') {\r\n            const b = target.getBounds();\r\n            // Google Maps getBounds returns LatLngBounds\r\n            // getNorthEast() and getSouthWest() are standard\r\n            if (b && b.getNorthEast && b.getSouthWest) {\r\n              window.poiPortal.update({\r\n                north: b.getNorthEast().lat(), south: b.getSouthWest().lat(),\r\n                east: b.getNorthEast().lng(), west: b.getSouthWest().lng()\r\n              }, 'instance-event');\r\n            }\r\n          }\r\n        };\r\n        \r\n        // OPTIMIZATION: Only listen to 'idle' (fires when map is stable)\r\n        // target.addListener('bounds_changed', update);\r\n        target.addListener('idle', update); \r\n        // target.addListener('center_changed', update);\r\n        // target.addListener('zoom_changed', update);\r\n        instance._poiListener = true; // Mark original instance as processed\r\n      }\r\n    } catch(e) {\r\n       console.error('[POI TITAN] Failed to attach listeners', e);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Gets all active map instances as an array\r\n   * @returns {Array} Array of active map instances\r\n   */\r\n  getActiveMaps() {\r\n    return Array.from(this.activeMaps);\r\n  }\r\n\r\n  /**\r\n   * Intercepts map constructors (main initialization logic)\r\n   * Previously the apply() method\r\n   */\r\n  interceptConstructors() {\r\n    const self = this;\r\n    \r\n    // TRAP: Google Maps (window.google)\r\n    if (window.google?.maps?.Map) {\r\n       this.hijackGoogle(window.google.maps);\r\n    } else {\r\n       if (!window._poiTrappedGoogle) {\r\n          let _google = window.google;\r\n          \r\n          Object.defineProperty(window, 'google', {\r\n             get() { return _google; },\r\n             set(val) {\r\n                _google = val;\r\n                \r\n                // If maps is already there, hijack immediately\r\n                if (val?.maps) {\r\n                   if (val.maps.Map) {\r\n                      self.hijackGoogle(val.maps);\r\n                   }\r\n                   \r\n                   // ALWAYS replace google.maps with a Proxy to catch lazy definition of Map\r\n                   try {\r\n                      const mapsProxy = new Proxy(val.maps, {\r\n                         set(target, prop, value) {\r\n                            if (prop === 'Map') {\r\n                               const Original = value;\r\n                               function HijackedMap(...args) {\r\n                                  if (!new.target) return new HijackedMap(...args);\r\n                                  const instance = new Original(...args);\r\n                                  self.activeMaps.add(instance);\r\n                                  self.attachListeners(instance);\r\n                                  return instance;\r\n                               }\r\n                               HijackedMap.prototype = Original.prototype;\r\n                               HijackedMap._isHijacked = true;\r\n                               Object.assign(HijackedMap, Original);\r\n                               target[prop] = HijackedMap;\r\n                               return true;\r\n                            }\r\n                            target[prop] = value;\r\n                            return true;\r\n                         }\r\n                      });\r\n                      _google.maps = mapsProxy;\r\n                   } catch(e) {}\r\n                }\r\n             },\r\n             configurable: true\r\n          });\r\n          window._poiTrappedGoogle = true;\r\n       }\r\n    }\r\n\r\n    try {\r\n      if (window.mapboxgl?.Map && !window.mapboxgl.Map._isHijacked) {\r\n        const Original = window.mapboxgl.Map;\r\n        function HijackedMap(...args) {\r\n          const instance = new Original(...args);\r\n          self.activeMaps.add(instance);\r\n          self.attachListeners(instance);\r\n          return instance;\r\n        }\r\n        HijackedMap.prototype = Original.prototype;\r\n        HijackedMap._isHijacked = true;\r\n        Object.assign(HijackedMap, Original);\r\n        window.mapboxgl.Map = HijackedMap;\r\n      }\r\n    } catch(e) {}\r\n  }\r\n\r\n  /**\r\n   * Hijacks Google Maps constructor and prototype methods\r\n   * @param {Object} mapsObj - The google.maps object\r\n   */\r\n  hijackGoogle(mapsObj) {\r\n    const self = this;\r\n    try {\r\n       if (mapsObj.Map && !mapsObj.Map._isHijacked) {\r\n         const Original = mapsObj.Map;\r\n         function HijackedMap(...args) {\r\n           if (!new.target) return new HijackedMap(...args);\r\n           const instance = new Original(...args);\r\n           self.activeMaps.add(instance);\r\n           self.attachListeners(instance);\r\n           return instance;\r\n         }\r\n         HijackedMap.prototype = Original.prototype;\r\n         HijackedMap._isHijacked = true;\r\n         Object.assign(HijackedMap, Original);\r\n         mapsObj.Map = HijackedMap;\r\n       }\r\n       \r\n       // BACKDOOR: Prototype Hijack\r\n       // Even if constructor hijack fails (race condition), we catch the instance \r\n       // when it calls standard methods.\r\n       if (mapsObj.Map && mapsObj.Map.prototype) {\r\n          const proto = mapsObj.Map.prototype;\r\n          const methods = ['setCenter', 'setZoom', 'setOptions', 'fitBounds', 'panTo', 'panBy', 'set'];\r\n          \r\n          methods.forEach(method => {\r\n             if (proto[method] && !proto[method]._isHijacked) {\r\n                const origMethod = proto[method];\r\n                proto[method] = function(...args) {\r\n                   // Capture instance using Duck Typing\r\n                   // Use window.poiHijack.activeMaps directly to avoid scope issues\r\n                   if (this && typeof this.getDiv === 'function' && typeof this.getBounds === 'function') {\r\n                      if (window.poiHijack && window.poiHijack.activeMaps && !window.poiHijack.activeMaps.has(this)) {\r\n                         console.log('[POI TITAN] Backdoor capture via', method);\r\n                         window.poiHijack.activeMaps.add(this);\r\n                         window.poiHijack.attachListeners(this);\r\n                      }\r\n                   }\r\n                   return origMethod.apply(this, args);\r\n                };\r\n                proto[method]._isHijacked = true;\r\n             }\r\n          });\r\n       }\r\n     } catch(e) {}\r\n  }\r\n\r\n  /**\r\n   * Public method to trigger constructor interception\r\n   * (maintains backwards compatibility with existing code)\r\n   */\r\n  apply() {\r\n    this.interceptConstructors();\r\n  }\r\n}\r\n\r\n// Create singleton instance and expose on window for backwards compatibility\r\nconst hijackManager = new MapHijackManager();\r\nwindow.poiHijack = hijackManager;\r\n\r\n// Export for different module systems\r\nif (typeof module !== 'undefined' && module.exports) {\r\n  module.exports = MapHijackManager;\r\n}", "// [SOURCE: bridge/modules/discovery.js]\n/**\r\n * POI Bridge: Discovery Module\r\n * Penetrates Shadow DOM and React trees to find existing maps.\r\n * \r\n * Converted to OOP class extending ManagerBase for singleton pattern\r\n * and initialization lifecycle management.\r\n * \r\n * NOTE: Redfin-specific logic (Redux store, RF_CONTEXT) has been extracted\r\n * to RedfinOverlay.js as per Phase 5.1. This class now only handles\r\n * generic discovery.\r\n * \r\n * PHASE 6.5: This module now registers discovered maps with OverlayRegistry.\r\n * Domain detection happens AT DISCOVERY TIME, not globally.\r\n */\r\n\r\n/**\r\n * MapDiscoveryManager - Discovers map instances in the DOM\r\n * \r\n * Features:\r\n * - Shadow DOM traversal\r\n * - React Fiber scanning\r\n * - Web Components detection (gmp-map, gmp-advanced-marker)\r\n * - Multiple fallback selector strategies\r\n * - Phase 6.5: Registers maps with OverlayRegistry for domain isolation\r\n */\r\nclass MapDiscoveryManager extends ManagerBase {\r\n  constructor() {\r\n    super();\r\n    this.observers = [];\r\n    this.scanInterval = null;\r\n    this._idleCounter = 0;\r\n  }\r\n\r\n  /**\r\n   * Registers a discovered map with the OverlayRegistry\r\n   * Domain detection happens HERE at discovery time.\r\n   * @param {Object} map - The map instance\r\n   * @param {HTMLElement} [container] - The container element\r\n   * @private\r\n   */\r\n  _registerMap(map, container = null) {\r\n    if (!map) return;\r\n    \r\n    // Add to hijack's activeMaps for backwards compatibility\r\n    window.poiHijack.activeMaps.add(map);\r\n    window.poiHijack.attachListeners(map);\r\n    \r\n    // PHASE 6.5: Register with OverlayRegistry\r\n    // Domain is detected HERE and locked to this map\r\n    if (window.overlayRegistry) {\r\n      const entry = window.overlayRegistry.register(map, container);\r\n      if (entry && entry.overlay) {\r\n        this.log(`Registered map ${entry.id} with overlay for domain: ${entry.domain}`);\r\n      }\r\n    }\r\n  }\r\n\r\n  /**\r\n   * @override\r\n   * Called during initialization\r\n   */\r\n  async onInitialize() {\r\n    this.log('MapDiscoveryManager initialized');\r\n  }\r\n\r\n  /**\r\n   * @override\r\n   * Cleanup observers and intervals\r\n   */\r\n  cleanup() {\r\n    this.stopScanning();\r\n    this.observers.forEach(obs => obs.disconnect());\r\n    this.observers = [];\r\n    this.initialized = false;\r\n    this.log('MapDiscoveryManager cleaned up');\r\n  }\r\n\r\n  /**\r\n   * Starts continuous scanning for maps\r\n   */\r\n  startScanning() {\r\n    if (this.scanInterval) return;\r\n    this.scanInterval = setInterval(() => this.run(), 1000);\r\n    this.log('Started scanning');\r\n  }\r\n\r\n  /**\r\n   * Stops continuous scanning\r\n   */\r\n  stopScanning() {\r\n    if (this.scanInterval) {\r\n      clearInterval(this.scanInterval);\r\n      this.scanInterval = null;\r\n      this.log('Stopped scanning');\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Finds all elements matching selector within Shadow DOM\r\n   * @param {Node} root - Root node to search from\r\n   * @param {string} selector - CSS selector\r\n   * @param {Array} found - Accumulator array\r\n   * @returns {Array} Found elements\r\n   */\r\n  findAllInShadow(root, selector, found = []) {\r\n    if (!root) return found;\r\n    try {\r\n      const elements = root.querySelectorAll(selector);\r\n      elements.forEach(el => found.push(el));\r\n      \r\n      // Optimization: Limit shadow root crawl depth or skip common non-map containers\r\n      // This is a heavy operation.\r\n      const all = root.querySelectorAll('*');\r\n      for (const s of all) {\r\n        if (s.shadowRoot) {\r\n           // Skip known non-map custom elements if possible\r\n           if (s.tagName.includes('ICON') || s.tagName.includes('BUTTON')) continue;\r\n           this.findAllInShadow(s.shadowRoot, selector, found);\r\n        }\r\n      }\r\n    } catch(e) {}\r\n    return found;\r\n  }\r\n\r\n  /**\r\n   * Main discovery run - finds and registers maps\r\n   */\r\n  run() {\r\n    // IDLE CHECK: If we already have active maps, we don't need to scan aggressively.\r\n    // Scan only every 10th call (assuming 1s loop = every 10s)\r\n    if (window.poiHijack.activeMaps.size > 0) {\r\n       this._idleCounter = (this._idleCounter || 0) + 1;\r\n       if (this._idleCounter % 10 !== 0) return; \r\n    }\r\n    \r\n    // A. Mapbox Global Registry\r\n    this._discoverMapboxGlobal();\r\n    \r\n    // B. Web Components (Realtor/Homes)\r\n    this._discoverWebComponents();\r\n    \r\n    // C. DOM & Fiber\r\n    this._discoverDOMAndFiber();\r\n  }\r\n\r\n  /**\r\n   * Discover maps via Mapbox global registry\r\n   * @private\r\n   */\r\n  _discoverMapboxGlobal() {\r\n    try { \r\n      if (window.mapboxgl?.getInstances) {\r\n        const instances = window.mapboxgl.getInstances();\r\n        instances?.forEach(map => {\r\n          if (map && typeof map.getBounds === 'function') {\r\n            // PHASE 6.5: Use _registerMap instead of direct add\r\n            const container = map._container || null;\r\n            this._registerMap(map, container);\r\n          }\r\n        });\r\n      }\r\n    } catch(e) {}\r\n  }\r\n\r\n  /**\r\n   * Discover maps via Web Components (Shadow DOM)\r\n   * @private\r\n   */\r\n  _discoverWebComponents() {\r\n    try {\r\n      this.findAllInShadow(document, 'gmp-map, gmp-advanced-marker').forEach(el => {\r\n        const map = el.map || el.innerMap || el.getMap?.();\r\n        if (map && typeof map.getBounds === 'function') {\r\n           // PHASE 6.5: Use _registerMap, pass the element as container context\r\n           this._registerMap(map, el);\r\n        }\r\n      });\r\n    } catch(e) {}\r\n  }\r\n\r\n  /**\r\n   * Discover maps via DOM selectors and React Fiber\r\n   * @private\r\n   */\r\n  _discoverDOMAndFiber() {\r\n    const selectors = [\r\n       '.gm-style', \r\n       '.mapboxgl-map', \r\n       '.leaflet-container', \r\n       'canvas',\r\n       '#map-container',\r\n       '.map-container',\r\n       '[data-rf-test-id=\"map\"]',\r\n       'div[class*=\"Map\"]',\r\n       'div[class*=\"map\"]'\r\n    ];\r\n    const mapProps = ['map', 'mapInstance', 'innerMap', '__google_map__', 'mapObject', 'viewer'];\r\n    \r\n    selectors.forEach(sel => {\r\n      this.findAllInShadow(document, sel).forEach(el => {\r\n        let curr = el;\r\n        for (let i = 0; i < 5 && curr; i++) {\r\n          for (const p of mapProps) { \r\n            try { \r\n              if (curr[p] && typeof curr[p].getBounds === 'function') {\r\n                // PHASE 6.5: Use _registerMap with container context\r\n                this._registerMap(curr[p], el);\r\n              }\r\n            } catch(e) {} \r\n          }\r\n          const fiberKey = Object.keys(curr).find(k => k.startsWith('__reactFiber'));\r\n          if (fiberKey) {\r\n            let fiber = curr[fiberKey];\r\n            while (fiber) {\r\n              if (fiber.memoizedProps) { \r\n                for (const p of mapProps) { \r\n                  try { \r\n                    const val = fiber.memoizedProps[p];\r\n                    // Relaxed Check: getBounds OR setCenter (Duck Typing)\r\n                    if (val && (typeof val.getBounds === 'function' || typeof val.setCenter === 'function')) {\r\n                      this.log('Discovery found map via Fiber prop:', p);\r\n                      // PHASE 6.5: Use _registerMap with container context\r\n                      this._registerMap(val, el);\r\n                    }\r\n                  } catch(e) {} \r\n                } \r\n              }\r\n              fiber = fiber.return;\r\n            }\r\n          }\r\n          curr = curr.parentElement || (curr.parentNode instanceof ShadowRoot ? curr.parentNode.host : null);\r\n        }\r\n      });\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Discovers maps and returns them (for use by overlays)\r\n   * @returns {Array} Array of discovered map instances\r\n   */\r\n  discoverMaps() {\r\n    this.run();\r\n    return Array.from(window.poiHijack.activeMaps);\r\n  }\r\n}\r\n\r\n// Create singleton instance and expose on window for backwards compatibility\r\nconst discoveryManager = new MapDiscoveryManager();\r\nwindow.poiDiscovery = discoveryManager;\r\n\r\n// Export for different module systems\r\nif (typeof module !== 'undefined' && module.exports) {\r\n  module.exports = MapDiscoveryManager;\r\n}\r\n", "// [SOURCE: bridge/modules/portal.js]\n/**\r\n * POI Bridge: Portal Module\r\n * Handles cross-world communication and attribute mirroring.\r\n * \r\n * Converted to OOP class extending ManagerBase for singleton pattern\r\n * and initialization lifecycle management.\r\n */\r\n\r\n/**\r\n * PortalManager - Cross-world communication manager\r\n * \r\n * Features:\r\n * - Bounds update with priority system\r\n * - DOM attribute mirroring for isolated world access\r\n * - postMessage for content script communication\r\n */\r\nclass PortalManager extends ManagerBase {\r\n  constructor() {\r\n    super();\r\n    this.lastBounds = null;\r\n    this.lastUpdateTime = 0;\r\n    this.lastPriority = 0;\r\n    this.messageHandlers = new Map();\r\n    \r\n    // Priority levels for different data sources\r\n    this.PRIORITIES = {\r\n      'instance-event': 100,      // Highest: Direct user interaction\r\n      'redfin-redux-sub': 90,     // High: Real-time subscription\r\n      'redfin-api': 85,           // High: API response is very fresh\r\n      'instance-capture': 80,     // Medium: Extracted from active map instance\r\n      'redfin-redux': 50,         // Low: Polled state (might be slightly stale)\r\n      'redfin-global': 40,        // Lower: Polled global variable (often stale)\r\n      'network-url': 20,          // Lowest: One-off network sniff\r\n      'network-body': 20\r\n    };\r\n  }\r\n\r\n  /**\r\n   * @override\r\n   * Called during initialization\r\n   */\r\n  async onInitialize() {\r\n    this.setupMessageListeners();\r\n    this.log('PortalManager initialized');\r\n  }\r\n\r\n  /**\r\n   * @override\r\n   * Cleanup resources\r\n   */\r\n  cleanup() {\r\n    this.messageHandlers.clear();\r\n    this.initialized = false;\r\n    this.log('PortalManager cleaned up');\r\n  }\r\n\r\n  /**\r\n   * Sets up message listeners\r\n   * @private\r\n   */\r\n  setupMessageListeners() {\r\n    // Can be extended by subclasses or at runtime\r\n  }\r\n\r\n  /**\r\n   * Registers a message handler\r\n   * @param {string} type - Message type\r\n   * @param {Function} handler - Handler function\r\n   */\r\n  registerHandler(type, handler) {\r\n    this.messageHandlers.set(type, handler);\r\n  }\r\n\r\n  /**\r\n   * Extracts bounds from a map instance\r\n   * @param {Object} map - Map instance\r\n   * @returns {Object|null} Bounds object\r\n   */\r\n  extractBounds(map) {\r\n    try {\r\n      const b = map.getBounds();\r\n      if (!b) return null;\r\n      \r\n      // Google Maps format\r\n      if (b.getNorthEast) {\r\n        return {\r\n          north: b.getNorthEast().lat(),\r\n          south: b.getSouthWest().lat(),\r\n          east: b.getNorthEast().lng(),\r\n          west: b.getSouthWest().lng()\r\n        };\r\n      }\r\n      \r\n      // Mapbox format\r\n      if (b.getNorth) {\r\n        return {\r\n          north: b.getNorth(),\r\n          south: b.getSouth(),\r\n          east: b.getEast(),\r\n          west: b.getWest()\r\n        };\r\n      }\r\n    } catch(e) {}\r\n    return null;\r\n  }\r\n\r\n  /**\r\n   * Filters POIs by priority within given bounds\r\n   * @param {Array} pois - Array of POIs\r\n   * @param {Object} bounds - Bounds to filter by\r\n   * @returns {Array} Filtered POIs\r\n   */\r\n  filterByPriority(pois, bounds) {\r\n    if (!bounds || !pois) return pois;\r\n    \r\n    return pois.filter(poi => {\r\n      const lat = parseFloat(poi.latitude);\r\n      const lng = parseFloat(poi.longitude);\r\n      return (\r\n        lat >= bounds.south &&\r\n        lat <= bounds.north &&\r\n        lng >= bounds.west &&\r\n        lng <= bounds.east\r\n      );\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Sends a message to the content script\r\n   * @param {string} type - Message type\r\n   * @param {Object} data - Message data\r\n   */\r\n  notifyContentScript(type, data) {\r\n    window.postMessage({ type, ...data }, '*');\r\n  }\r\n\r\n  /**\r\n   * Updates bounds with priority checking\r\n   * @param {Object} bounds - Bounds object\r\n   * @param {string} method - Source method name\r\n   */\r\n  update(bounds, method) {\r\n    if (!bounds || typeof bounds.north !== 'number' || isNaN(bounds.north)) return;\r\n    \r\n    // Priority Check\r\n    const priority = this.PRIORITIES[method] || 30;\r\n    const now = Date.now();\r\n    \r\n    // STRICTER LOCK: If we have locked onto a high-quality source (>= 80),\r\n    // ignore any low-quality polling (< 80) PERMANENTLY unless the high-quality source goes silent for > 5 seconds.\r\n    if (this.lastPriority >= 80 && priority < 80) {\r\n       if (now - this.lastUpdateTime < 5000) return;\r\n       // Reset lock if silence for 5s\r\n       this.lastPriority = 0; \r\n    }\r\n\r\n    // Always allow high-priority updates (e.g. from user interaction or API)\r\n    // Only filter low-priority polling if a high-priority event happened very recently\r\n    if (priority <= 50 && this.lastPriority > 50 && (now - this.lastUpdateTime < 500)) {\r\n       return;\r\n    }\r\n\r\n    // Round for stability and JSON comparison\r\n    const rounded = {\r\n      north: parseFloat(bounds.north.toFixed(6)),\r\n      south: parseFloat(bounds.south.toFixed(6)),\r\n      east: parseFloat(bounds.east.toFixed(6)),\r\n      west: parseFloat(bounds.west.toFixed(6))\r\n    };\r\n\r\n    const json = JSON.stringify(rounded);\r\n    \r\n    // Update state even if bounds are same, to refresh priority timestamp if it's high priority\r\n    if (priority >= this.lastPriority) {\r\n        this.lastPriority = priority;\r\n        this.lastUpdateTime = now;\r\n    }\r\n\r\n    if (json === this.lastBounds) return;\r\n    this.lastBounds = json;\r\n\r\n    const timestamp = now.toString();\r\n\r\n    // Mirror to DOM for Isolated World access\r\n    document.documentElement.setAttribute('data-poi-bounds', json);\r\n    document.documentElement.setAttribute('data-poi-map-type', method);\r\n    document.documentElement.setAttribute('data-poi-timestamp', timestamp);\r\n    \r\n    const payload = { \r\n      type: 'POI_BOUNDS_UPDATE', \r\n      bounds: rounded, \r\n      method: method, \r\n      url: window.location.href, \r\n      isIframe: window.self !== window.top,\r\n      timestamp: timestamp\r\n    };\r\n    \r\n    window.postMessage(payload, '*');\r\n    if (window.self !== window.top) window.parent.postMessage(payload, '*');\r\n  }\r\n}\r\n\r\n// Create singleton instance and expose on window for backwards compatibility\r\nconst portalManager = new PortalManager();\r\nwindow.poiPortal = portalManager;\r\n\r\n// Export for different module systems\r\nif (typeof module !== 'undefined' && module.exports) {\r\n  module.exports = PortalManager;\r\n}\r\n", "// [SOURCE: overlays/ZillowOverlay.js]\n/**\r\n * ZillowOverlay - Site-specific overlay for Zillow.com\r\n * \r\n * Zillow uses Mapbox GL JS for their maps.\r\n * This overlay extends MapboxOverlayBase with Zillow-specific\r\n * detection and z-index handling.\r\n */\r\n\r\n/**\r\n * ZillowOverlay - Mapbox-based overlay for Zillow.com\r\n * \r\n * Features:\r\n * - Detects Zillow's Mapbox map container\r\n * - Applies proper z-index for marker visibility\r\n * - Handles Zillow's specific DOM structure\r\n */\r\nclass ZillowOverlay extends MapboxOverlayBase {\r\n  constructor(debug = false) {\r\n    super(debug);\r\n    this.siteId = 'zillow';\r\n  }\r\n\r\n  /**\r\n   * @override\r\n   * Detects the Zillow map container\r\n   * @returns {HTMLElement|null} The map container element\r\n   */\r\n  detect() {\r\n    // Zillow's map containers\r\n    const selectors = [\r\n      '.mapboxgl-map',\r\n      '#search-page-map',\r\n      '[data-testid=\"map\"]',\r\n      '.map-container',\r\n      '#map'\r\n    ];\r\n\r\n    for (const selector of selectors) {\r\n      const el = document.querySelector(selector);\r\n      if (el) {\r\n        this.log('Detected Zillow map container:', selector);\r\n        this.container = el;\r\n        return el;\r\n      }\r\n    }\r\n\r\n    return null;\r\n  }\r\n\r\n  /**\r\n   * @override\r\n   * Gets the z-index for markers (higher for Zillow to ensure visibility)\r\n   * @returns {number} The z-index value\r\n   */\r\n  getMarkerZIndex() {\r\n    return 10;\r\n  }\r\n\r\n  /**\r\n   * @override\r\n   * Creates a marker element with Zillow-specific styling\r\n   * @param {Object} poi - POI object\r\n   * @returns {HTMLElement} The marker element\r\n   */\r\n  createMarkerElement(poi) {\r\n    const el = super.createMarkerElement(poi);\r\n    \r\n    // Zillow-specific: ensure markers are above Zillow's UI\r\n    el.style.zIndex = '10';\r\n    \r\n    return el;\r\n  }\r\n}\r\n\r\n// Export for different module systems\r\nif (typeof module !== 'undefined' && module.exports) {\r\n  module.exports = ZillowOverlay;\r\n} else if (typeof window !== 'undefined') {\r\n  window.ZillowOverlay = ZillowOverlay;\r\n}\r\n", "// [SOURCE: overlays/RedfinOverlay.js]\n/**\r\n * RedfinOverlay - Site-specific overlay for Redfin.com\r\n * \r\n * Redfin uses Google Maps and has specialized data extraction methods:\r\n * - Redux store subscription for real-time bounds updates\r\n * - window.RF_CONTEXT / window.__map_bounds__ global variable scraping\r\n * - Redfin API response parsing\r\n * \r\n * This overlay extends GoogleMapsOverlayBase with all Redfin-specific\r\n * logic that was previously in discovery.js and sniff.js.\r\n */\r\n\r\n/**\r\n * RedfinOverlay - Google Maps overlay for Redfin.com\r\n * \r\n * Features:\r\n * - Redux store subscription for real-time bounds\r\n * - Global variable scraping (RF_CONTEXT, __map_bounds__)\r\n * - API response parsing\r\n * - Integrated bounds extraction\r\n */\r\nclass RedfinOverlay extends GoogleMapsOverlayBase {\r\n  constructor(debug = false) {\r\n    super(debug);\r\n    this.siteId = 'redfin';\r\n    this.reduxStore = null;\r\n    this.reduxUnsubscribe = null;\r\n    this._storeSubscribed = false;\r\n  }\r\n\r\n  /**\r\n   * @override\r\n   * Gets the CSS selector for Redfin native markers\r\n   * @returns {string} CSS selector for Redfin pushpins\r\n   * @protected\r\n   */\r\n  _getNativeMarkerSelector() {\r\n    return '.Pushpin.homePushpin, [data-rf-test-id^=\"home-marker\"]';\r\n  }\r\n\r\n  /**\r\n   * @override\r\n   * Checks if Redfin has already placed a native marker for this POI\r\n   * @param {Object} poi - POI object\r\n   * @returns {boolean} True if Redfin native marker exists\r\n   */\r\n  _hasSiteNativeMarker(poi) {\r\n    if (typeof this._hasLoggedRedfinMarker === 'undefined') {\r\n      this._hasLoggedRedfinMarker = false;\r\n    }\r\n    \r\n    // Check for Redfin pushpin with matching coordinates\r\n    const selector = `.Pushpin.homePushpin[data-latitude=\"${poi.latitude}\"][data-longitude=\"${poi.longitude}\"]`;\r\n    const found = !!document.querySelector(selector);\r\n    \r\n    if (found && !this._hasLoggedRedfinMarker) {\r\n      this.log('Redfin native marker detected');\r\n      this._hasLoggedRedfinMarker = true;\r\n    }\r\n    return found;\r\n  }\r\n\r\n  /**\r\n   * @override\r\n   * Detects the Redfin map container\r\n   * @returns {HTMLElement|null} The map container element\r\n   */\r\n  detect() {\r\n    const selectors = [\r\n      '.gm-style',\r\n      '[data-rf-test-id=\"map\"]',\r\n      '#map-container',\r\n      '.MapContainer',\r\n      '.HomeViews'\r\n    ];\r\n\r\n    for (const selector of selectors) {\r\n      const el = document.querySelector(selector);\r\n      if (el) {\r\n        this.log('Detected Redfin map container:', selector);\r\n        this.container = el;\r\n        return el;\r\n      }\r\n    }\r\n\r\n    return null;\r\n  }\r\n\r\n  /**\r\n   * @override\r\n   * Hijacks the map and sets up Redfin-specific subscriptions\r\n   * @param {Object} mapInstance - The map instance\r\n   * @returns {boolean} Success\r\n   */\r\n  hijack(mapInstance) {\r\n    const result = super.hijack(mapInstance);\r\n    \r\n    if (result) {\r\n      // Set up Redux store subscription\r\n      this.subscribeToStore();\r\n    }\r\n    \r\n    return result;\r\n  }\r\n\r\n  /**\r\n   * Subscribes to Redfin's Redux store for real-time bounds updates\r\n   */\r\n  subscribeToStore() {\r\n    if (this._storeSubscribed) return;\r\n\r\n    try {\r\n      // Find Redux store\r\n      let store = window.App?.store || window.redfin?.context?.store;\r\n      \r\n      // Fiber Probe for Store\r\n      if (!store) {\r\n        const root = document.getElementById('root') || document.querySelector('#content');\r\n        if (root) {\r\n          const key = Object.keys(root).find(k => k.startsWith('__reactContainer'));\r\n          if (key && root[key]) {\r\n            let fiber = root[key];\r\n            while (fiber && !store) {\r\n              if (fiber.stateNode && fiber.stateNode.store) store = fiber.stateNode.store;\r\n              else if (fiber.memoizedProps && fiber.memoizedProps.store) store = fiber.memoizedProps.store;\r\n              fiber = fiber.child || fiber.return;\r\n            }\r\n          }\r\n        }\r\n      }\r\n\r\n      if (store) {\r\n        this.reduxStore = store;\r\n        \r\n        // Get initial bounds\r\n        const s = store.getState();\r\n        if (s?.map?.viewport?.bounds) {\r\n          window.poiPortal.update(s.map.viewport.bounds, 'redfin-redux');\r\n        }\r\n        \r\n        // Subscribe for real-time updates\r\n        if (typeof store.subscribe === 'function') {\r\n          let lastBounds = store.getState()?.map?.viewport?.bounds;\r\n          this.reduxUnsubscribe = store.subscribe(() => {\r\n            const ns = store.getState();\r\n            const newBounds = ns?.map?.viewport?.bounds;\r\n            // Strict equality check to prevent updates if bounds object hasn't changed\r\n            if (newBounds && newBounds !== lastBounds) {\r\n              lastBounds = newBounds;\r\n              window.poiPortal.update(newBounds, 'redfin-redux-sub');\r\n            }\r\n          });\r\n          this._storeSubscribed = true;\r\n          this.log('Subscribed to Redux store');\r\n        }\r\n      }\r\n    } catch (e) {\r\n      this.log('Failed to subscribe to Redux store:', e);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Extracts bounds from global variables (RF_CONTEXT, __map_bounds__)\r\n   * @returns {Object|null} Bounds object or null\r\n   */\r\n  extractGlobalBounds() {\r\n    try {\r\n      // Check __map_bounds__ global\r\n      if (window.__map_bounds__ && window.poiPortal.lastPriority < 80) {\r\n        const b = window.__map_bounds__;\r\n        const keys = Object.keys(b).filter(k => b[k] && typeof b[k].lo === 'number' && typeof b[k].hi === 'number');\r\n        if (keys.length >= 2) {\r\n          const b1 = b[keys[0]];\r\n          const b2 = b[keys[1]];\r\n          let latB, lngB;\r\n          // Geographic Heuristic: Longitude is negative and larger magnitude in NYC/US context\r\n          if (b1.lo < 0 || Math.abs(b1.lo) > Math.abs(b2.lo)) { \r\n            lngB = b1; \r\n            latB = b2; \r\n          } else { \r\n            lngB = b2; \r\n            latB = b1; \r\n          }\r\n          \r\n          return { \r\n            north: latB.hi, \r\n            south: latB.lo, \r\n            east: lngB.hi, \r\n            west: lngB.lo \r\n          };\r\n        }\r\n      }\r\n    } catch (e) {\r\n      this.log('Failed to extract global bounds:', e);\r\n    }\r\n    return null;\r\n  }\r\n\r\n  /**\r\n   * Parses Redfin API response for bounds data\r\n   * @param {Object} data - Parsed JSON response\r\n   * @returns {Object|null} Bounds object or null\r\n   */\r\n  parseNetworkBounds(data) {\r\n    try {\r\n      // Look for Redfin specific response structure\r\n      if (data?.payload?.viewport) return data.payload.viewport;\r\n      if (data?.payload?.bounds) return data.payload.bounds;\r\n    } catch (e) {\r\n      this.log('Failed to parse network bounds:', e);\r\n    }\r\n    return null;\r\n  }\r\n\r\n  /**\r\n   * Runs Redfin-specific discovery (global bounds extraction)\r\n   * This should be called periodically to supplement Redux subscription\r\n   */\r\n  runDiscovery() {\r\n    // Extract global bounds as fallback\r\n    const bounds = this.extractGlobalBounds();\r\n    if (bounds) {\r\n      window.poiPortal.update(bounds, 'redfin-global');\r\n    }\r\n  }\r\n\r\n  /**\r\n   * @override\r\n   * Cleanup resources\r\n   */\r\n  cleanup() {\r\n    if (this.reduxUnsubscribe) {\r\n      try {\r\n        this.reduxUnsubscribe();\r\n      } catch (e) {}\r\n      this.reduxUnsubscribe = null;\r\n    }\r\n    this.reduxStore = null;\r\n    this._storeSubscribed = false;\r\n    \r\n    super.cleanup();\r\n  }\r\n}\r\n\r\n// Export for different module systems\r\nif (typeof module !== 'undefined' && module.exports) {\r\n  module.exports = RedfinOverlay;\r\n} else if (typeof window !== 'undefined') {\r\n  window.RedfinOverlay = RedfinOverlay;\r\n}\r\n", "// [SOURCE: overlays/HomesComOverlay.js]\n/**\r\n * HomesComOverlay - Site-specific overlay for Homes.com\r\n * \r\n * Homes.com uses Google Maps with Web Components (Shadow DOM).\r\n * This overlay extends GoogleMapsOverlayBase with Homes.com-specific\r\n * Shadow DOM detection.\r\n */\r\n\r\n/**\r\n * HomesComOverlay - Google Maps overlay for Homes.com\r\n * \r\n * Features:\r\n * - Detects Google Maps within Shadow DOM\r\n * - Handles gmp-map and gmp-advanced-marker elements\r\n * - Traverses Shadow DOM to find map instances\r\n */\r\nclass HomesComOverlay extends GoogleMapsOverlayBase {\r\n  constructor(debug = false) {\r\n    super(debug);\r\n    this.siteId = 'homes.com';\r\n  }\r\n\r\n  /**\r\n   * @override\r\n   * Gets the CSS selector for Homes.com/Apartments.com native markers\r\n   * @returns {string} CSS selector for custom markers\r\n   * @protected\r\n   */\r\n  _getNativeMarkerSelector() {\r\n    return '.custom-marker.gmaps-adv-marker';\r\n  }\r\n\r\n  /**\r\n   * @override\r\n   * Checks if Homes.com has already placed a native marker for this POI\r\n   * @param {Object} poi - POI object\r\n   * @returns {boolean} True if Homes.com native marker exists\r\n   */\r\n  _hasSiteNativeMarker(poi) {\r\n    if (typeof this._hasLoggedHomesMarker === 'undefined') {\r\n      this._hasLoggedHomesMarker = false;\r\n    }\r\n    \r\n    // Check for Homes.com custom marker with matching coordinates\r\n    const coord = `${poi.latitude},${poi.longitude}`;\r\n    const selector = `.custom-marker.gmaps-adv-marker[data-cuscor=\"${coord}\"]`;\r\n    const found = !!document.querySelector(selector);\r\n    \r\n    if (found && !this._hasLoggedHomesMarker) {\r\n      this.log('Homes.com native marker detected');\r\n      this._hasLoggedHomesMarker = true;\r\n    }\r\n    return found;\r\n  }\r\n\r\n  /**\r\n   * Finds elements matching selector within Shadow DOM\r\n   * @param {Node} root - Root node to search from\r\n   * @param {string} selector - CSS selector\r\n   * @param {Array} found - Accumulator array\r\n   * @returns {Array} Found elements\r\n   * @private\r\n   */\r\n  _findInShadow(root, selector, found = []) {\r\n    if (!root) return found;\r\n    try {\r\n      const elements = root.querySelectorAll(selector);\r\n      elements.forEach(el => found.push(el));\r\n      \r\n      const all = root.querySelectorAll('*');\r\n      for (const s of all) {\r\n        if (s.shadowRoot) {\r\n          // Skip known non-map custom elements\r\n          if (s.tagName.includes('ICON') || s.tagName.includes('BUTTON')) continue;\r\n          this._findInShadow(s.shadowRoot, selector, found);\r\n        }\r\n      }\r\n    } catch(e) {}\r\n    return found;\r\n  }\r\n\r\n  /**\r\n   * Checks if a native marker for this POI exists in the DOM\r\n   * Uses base class implementation\r\n   */\r\n  _hasNativeMarker(poi) {\r\n    return super._hasNativeMarker(poi);\r\n  }\r\n\r\n  /**\r\n   * @override\r\n   * Detects the Homes.com map container, including Shadow DOM\r\n   * @returns {HTMLElement|null} The map container element\r\n   */\r\n  detect() {\r\n    // Standard selectors\r\n    const selectors = [\r\n      '.gm-style',\r\n      '#map-container',\r\n      '.map-container',\r\n      'gmp-map'\r\n    ];\r\n\r\n    // First try standard DOM\r\n    for (const selector of selectors) {\r\n      const el = document.querySelector(selector);\r\n      if (el) {\r\n        this.log('Detected Homes.com map container:', selector);\r\n        this.container = el;\r\n        return el;\r\n      }\r\n    }\r\n\r\n    // Try Shadow DOM for Web Components\r\n    const shadowElements = this._findInShadow(document, 'gmp-map, gmp-advanced-marker, .gm-style');\r\n    if (shadowElements.length > 0) {\r\n      const el = shadowElements[0];\r\n      this.log('Detected Homes.com map in Shadow DOM');\r\n      this.container = el;\r\n      return el;\r\n    }\r\n\r\n    return null;\r\n  }\r\n\r\n  /**\r\n   * @override\r\n   * Hijacks the map, handling Web Component maps\r\n   * @param {Object} mapInstance - The map instance\r\n   * @returns {boolean} Success\r\n   */\r\n  hijack(mapInstance) {\r\n    // Handle gmp-map Web Component\r\n    if (mapInstance && !mapInstance.getBounds && mapInstance.map) {\r\n      mapInstance = mapInstance.map;\r\n    }\r\n    if (mapInstance && !mapInstance.getBounds && mapInstance.innerMap) {\r\n      mapInstance = mapInstance.innerMap;\r\n    }\r\n    if (mapInstance && !mapInstance.getBounds && typeof mapInstance.getMap === 'function') {\r\n      mapInstance = mapInstance.getMap();\r\n    }\r\n\r\n    return super.hijack(mapInstance);\r\n  }\r\n}\r\n\r\n// Export for different module systems\r\nif (typeof module !== 'undefined' && module.exports) {\r\n  module.exports = HomesComOverlay;\r\n} else if (typeof window !== 'undefined') {\r\n  window.HomesComOverlay = HomesComOverlay;\r\n}\r\n", "// [SOURCE: overlays/OneKeyOverlay.js]\n/**\r\n * OneKeyOverlay - Site-specific overlay for OneKeyMLS.com\r\n * \r\n * OneKey MLS uses Mapbox GL JS for their maps.\r\n * This overlay extends MapboxOverlayBase with OneKey-specific\r\n * z-index handling to ensure markers stack below property popups.\r\n */\r\n\r\n/**\r\n * OneKeyOverlay - Mapbox-based overlay for OneKeyMLS.com\r\n * \r\n * Features:\r\n * - Detects OneKey's Mapbox map container\r\n * - Applies z-index to stack markers below property popups\r\n * - Handles OneKey's popup parent for correct stacking context\r\n */\r\nclass OneKeyOverlay extends MapboxOverlayBase {\r\n  constructor(debug = false) {\r\n    super(debug);\r\n    this.siteId = 'onekey';\r\n  }\r\n\r\n  /**\r\n   * @override\r\n   * Detects the OneKey map container\r\n   * @returns {HTMLElement|null} The map container element\r\n   */\r\n  detect() {\r\n    const selectors = [\r\n      '.mapboxgl-map',\r\n      '#map',\r\n      '.map-container',\r\n      '[class*=\"MapContainer\"]'\r\n    ];\r\n\r\n    for (const selector of selectors) {\r\n      const el = document.querySelector(selector);\r\n      if (el) {\r\n        this.log('Detected OneKey map container:', selector);\r\n        this.container = el;\r\n        \r\n        // Also find popup parent for stacking context\r\n        this._findPopupParent();\r\n        \r\n        return el;\r\n      }\r\n    }\r\n\r\n    return null;\r\n  }\r\n\r\n  /**\r\n   * Finds the popup parent element for stacking context\r\n   * @private\r\n   */\r\n  _findPopupParent() {\r\n    // OneKey often has popups in a specific container\r\n    const popupParent = document.querySelector('.mapboxgl-popup-content, [class*=\"PropertyCard\"], [class*=\"popup\"]');\r\n    if (popupParent) {\r\n      this.log('Found popup parent for stacking context');\r\n    }\r\n  }\r\n\r\n  /**\r\n   * @override\r\n   * Gets the z-index for markers (10 to stack below popups)\r\n   * @returns {number} The z-index value\r\n   */\r\n  getMarkerZIndex() {\r\n    return 10;\r\n  }\r\n\r\n  /**\r\n   * @override\r\n   * Creates a marker element with OneKey-specific styling\r\n   * @param {Object} poi - POI object\r\n   * @returns {HTMLElement} The marker element\r\n   */\r\n  createMarkerElement(poi) {\r\n    const el = super.createMarkerElement(poi);\r\n    \r\n    // OneKey-specific: explicit inline styles for stacking\r\n    el.style.position = 'relative';\r\n    el.style.zIndex = '10';\r\n    \r\n    return el;\r\n  }\r\n}\r\n\r\n// Export for different module systems\r\nif (typeof module !== 'undefined' && module.exports) {\r\n  module.exports = OneKeyOverlay;\r\n} else if (typeof window !== 'undefined') {\r\n  window.OneKeyOverlay = OneKeyOverlay;\r\n}\r\n", "// [SOURCE: overlays/RealtorOverlay.js]\n/**\r\n * RealtorOverlay - Site-specific overlay for Realtor.com\r\n * \r\n * Realtor.com uses a mix of map technologies depending on the page.\r\n * This overlay extends MapOverlayBase and handles both Google Maps\r\n * and Mapbox instances, with Realtor-specific detection.\r\n */\r\n\r\n/**\r\n * RealtorOverlay - Multi-map overlay for Realtor.com\r\n * \r\n * Features:\r\n * - Detects both Google Maps and Mapbox on Realtor.com\r\n * - Web Component / Shadow DOM support\r\n * - Handles Realtor's specific DOM structure\r\n */\r\nclass RealtorOverlay extends MapOverlayBase {\r\n  constructor(debug = false) {\r\n    super(debug);\r\n    this.siteId = 'realtor';\r\n    this.detectedMapType = null; // 'google' or 'mapbox'\r\n    \r\n    // For Mapbox rendering\r\n    this.activeMarkers = new Map();\r\n    \r\n    // For Google rendering\r\n    this.markerPool = new MarkerPool();\r\n    this.activeElements = new Map();\r\n  }\r\n\r\n  /**\r\n   * Finds elements matching selector within Shadow DOM\r\n   * @param {Node} root - Root node to search from\r\n   * @param {string} selector - CSS selector\r\n   * @param {Array} found - Accumulator array\r\n   * @returns {Array} Found elements\r\n   * @private\r\n   */\r\n  _findInShadow(root, selector, found = []) {\r\n    if (!root) return found;\r\n    try {\r\n      const elements = root.querySelectorAll(selector);\r\n      elements.forEach(el => found.push(el));\r\n      \r\n      const all = root.querySelectorAll('*');\r\n      for (const s of all) {\r\n        if (s.shadowRoot) {\r\n          if (s.tagName.includes('ICON') || s.tagName.includes('BUTTON')) continue;\r\n          this._findInShadow(s.shadowRoot, selector, found);\r\n        }\r\n      }\r\n    } catch(e) {}\r\n    return found;\r\n  }\r\n\r\n  /**\r\n   * @override\r\n   * Detects the Realtor.com map container\r\n   * @returns {HTMLElement|null} The map container element\r\n   */\r\n  detect() {\r\n    // Realtor.com selectors (may use either Google Maps or Mapbox)\r\n    const selectors = [\r\n      '.mapboxgl-map',\r\n      '.gm-style',\r\n      'gmp-map',\r\n      '#map-container',\r\n      '[data-testid=\"map\"]',\r\n      '.map-container',\r\n      '#mapboxgl-map'\r\n    ];\r\n\r\n    // First try standard DOM\r\n    for (const selector of selectors) {\r\n      const el = document.querySelector(selector);\r\n      if (el) {\r\n        this.log('Detected Realtor map container:', selector);\r\n        this.container = el;\r\n        \r\n        // Determine map type from selector\r\n        if (selector.includes('mapbox')) {\r\n          this.detectedMapType = 'mapbox';\r\n        } else if (selector.includes('gm-style') || selector.includes('gmp-')) {\r\n          this.detectedMapType = 'google';\r\n        }\r\n        \r\n        return el;\r\n      }\r\n    }\r\n\r\n    // Try Shadow DOM for Web Components\r\n    const shadowElements = this._findInShadow(document, 'gmp-map, .gm-style, .mapboxgl-map');\r\n    if (shadowElements.length > 0) {\r\n      const el = shadowElements[0];\r\n      this.log('Detected Realtor map in Shadow DOM');\r\n      this.container = el;\r\n      return el;\r\n    }\r\n\r\n    return null;\r\n  }\r\n\r\n  /**\r\n   * @override\r\n   * Checks if the given map instance is compatible\r\n   * @param {Object} mapInstance - The map instance to check\r\n   * @returns {boolean} True if compatible\r\n   */\r\n  isCompatibleMap(mapInstance) {\r\n    if (MapTypeDetector.isGoogleMap(mapInstance)) {\r\n      this.detectedMapType = 'google';\r\n      return true;\r\n    }\r\n    if (MapTypeDetector.isMapbox(mapInstance)) {\r\n      this.detectedMapType = 'mapbox';\r\n      return true;\r\n    }\r\n    return false;\r\n  }\r\n\r\n  /**\r\n   * Checks if a native marker for this POI exists in the DOM\r\n   * Uses base class implementation which looks for any poi-native-marker class\r\n   * @param {Object} poi - POI object\r\n   * @returns {boolean} True if native marker exists\r\n   */\r\n  _hasNativeMarker(poi) {\r\n    // Use base class implementation which looks for any [class^=\"poi-native-marker\"]\r\n    return super._hasNativeMarker(poi);\r\n  }\r\n\r\n  /**\r\n   * @override\r\n   * Renders markers, delegating to the appropriate renderer\r\n   * @param {Array} pois - Array of POI objects\r\n   * @param {Object} mapInstance - The map instance\r\n   */\r\n  renderMarkers(pois, mapInstance) {\r\n    if (!mapInstance) {\r\n      this.log('No map instance provided');\r\n      return;\r\n    }\r\n\r\n    // Determine map type if not already known\r\n    if (!this.detectedMapType) {\r\n      if (MapTypeDetector.isGoogleMap(mapInstance)) {\r\n        this.detectedMapType = 'google';\r\n      } else if (MapTypeDetector.isMapbox(mapInstance)) {\r\n        this.detectedMapType = 'mapbox';\r\n      } else {\r\n        this.log('Unknown map type, cannot render');\r\n        return;\r\n      }\r\n    }\r\n\r\n    // Filter out POIs that already have a native marker\r\n    const filteredPois = this._filterNativePois(pois);\r\n\r\n    if (this.detectedMapType === 'google') {\r\n      this._renderGoogleMarkers(filteredPois, mapInstance);\r\n    } else if (this.detectedMapType === 'mapbox') {\r\n      this._renderMapboxMarkers(filteredPois, mapInstance);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Renders markers on Google Maps\r\n   * @private\r\n   */\r\n  _renderGoogleMarkers(pois, mapInstance) {\r\n    if (!window.google || !window.google.maps) {\r\n      this.log('Google Maps API not available');\r\n      return;\r\n    }\r\n\r\n    // Reuse batch overlay if available\r\n    if (!mapInstance._poiBatchLayer && window.PoiBatchOverlay) {\r\n      mapInstance._poiBatchLayer = new window.PoiBatchOverlay(mapInstance);\r\n      mapInstance._poiBatchLayer.setMap(mapInstance);\r\n    }\r\n\r\n    if (mapInstance._poiBatchLayer) {\r\n      mapInstance._poiBatchLayer.updatePois(pois);\r\n      this.log(`Rendered ${pois.length} Google markers`);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Renders markers on Mapbox\r\n   * @private\r\n   */\r\n  _renderMapboxMarkers(pois, mapInstance) {\r\n    if (!window.mapboxgl || !window.mapboxgl.Marker) {\r\n      this.log('Mapbox GL JS not available');\r\n      return;\r\n    }\r\n\r\n    if (!mapInstance._poiUid) {\r\n      mapInstance._poiUid = Math.random().toString(36).substr(2, 9);\r\n    }\r\n\r\n    const usedIds = new Set();\r\n\r\n    pois.forEach(poi => {\r\n      const id = `${mapInstance._poiUid}-${MapUtils.getPoiId(poi)}`;\r\n      usedIds.add(id);\r\n\r\n      if (this.activeMarkers.has(id)) return;\r\n\r\n      const el = this.createMarker(poi, mapInstance);\r\n      const marker = new window.mapboxgl.Marker({ element: el })\r\n        .setLngLat([parseFloat(poi.longitude), parseFloat(poi.latitude)])\r\n        .addTo(mapInstance);\r\n\r\n      this.activeMarkers.set(id, marker);\r\n    });\r\n\r\n    // Cleanup old markers\r\n    this.activeMarkers.forEach((marker, id) => {\r\n      if (id.startsWith(mapInstance._poiUid) && !usedIds.has(id)) {\r\n        marker.remove();\r\n        this.activeMarkers.delete(id);\r\n      }\r\n    });\r\n\r\n    this.log(`Rendered ${pois.length} Mapbox markers`);\r\n  }\r\n\r\n  /**\r\n   * @override\r\n   * Creates a marker element\r\n   * @param {Object} poi - POI object\r\n   * @param {Object} map - Map instance\r\n   * @returns {HTMLElement} The marker element\r\n   */\r\n  createMarker(poi, map) {\r\n    const el = document.createElement('div');\r\n    el.className = 'poi-native-marker-realtor';\r\n\r\n    const color = poi.color || '#ff0000';\r\n    const secondaryColor = poi.secondaryColor || '#ffffff';\r\n    const logo = poi.logoData;\r\n    const fallbackSvg = MapUtils.generateFallbackSVG(color, secondaryColor, 32);\r\n\r\n    el.style.cssText = `\r\n      width: 32px;\r\n      height: 32px;\r\n      cursor: pointer;\r\n      position: relative;\r\n      z-index: 10;\r\n      background-image: url('${logo || fallbackSvg}');\r\n      background-size: contain;\r\n      background-repeat: no-repeat;\r\n      filter: drop-shadow(0px 2px 4px rgba(0,0,0,0.4));\r\n    `;\r\n\r\n    el.setAttribute('data-id', MapUtils.getPoiId(poi));\r\n    el.setAttribute('data-lat', poi.latitude);\r\n    el.setAttribute('data-lng', poi.longitude);\r\n\r\n    // Click handler\r\n    el.onclick = (e) => {\r\n      e.stopPropagation();\r\n      window.postMessage({\r\n        type: 'POI_MARKER_CLICK',\r\n        id: poi.id,\r\n        lat: poi.latitude,\r\n        lng: poi.longitude\r\n      }, '*');\r\n    };\r\n\r\n    // Hover handlers\r\n    el.onmouseenter = () => {\r\n      el.style.zIndex = '1000000';\r\n      window.postMessage({\r\n        type: 'POI_MARKER_HOVER',\r\n        id: poi.id,\r\n        lat: poi.latitude,\r\n        lng: poi.longitude\r\n      }, '*');\r\n    };\r\n\r\n    el.onmouseleave = () => {\r\n      el.style.zIndex = '10';\r\n      window.postMessage({\r\n        type: 'POI_MARKER_LEAVE',\r\n        id: poi.id\r\n      }, '*');\r\n    };\r\n\r\n    return el;\r\n  }\r\n\r\n  /**\r\n   * @override\r\n   * Clears all markers\r\n   */\r\n  clear() {\r\n    this.activeMarkers.forEach((marker) => {\r\n      marker.remove();\r\n    });\r\n    this.activeMarkers.clear();\r\n    \r\n    this.activeElements.forEach((el) => {\r\n      this.markerPool.release(el);\r\n    });\r\n    this.activeElements.clear();\r\n\r\n    super.clear();\r\n  }\r\n\r\n  /**\r\n   * @override\r\n   * Cleanup resources\r\n   */\r\n  cleanup() {\r\n    this.clear();\r\n    this.markerPool.clear();\r\n    this.detectedMapType = null;\r\n    super.cleanup();\r\n  }\r\n}\r\n\r\n// Export for different module systems\r\nif (typeof module !== 'undefined' && module.exports) {\r\n  module.exports = RealtorOverlay;\r\n} else if (typeof window !== 'undefined') {\r\n  window.RealtorOverlay = RealtorOverlay;\r\n}\r\n", "// [SOURCE: overlays/GenericMapOverlay.js]\n/**\r\n * GenericMapOverlay - Fallback overlay for unknown sites\r\n * \r\n * This overlay handles both Google Maps and Mapbox instances,\r\n * detecting the map type and delegating rendering appropriately.\r\n * Uses all 8 fallback strategies from the original discovery module.\r\n */\r\n\r\n/**\r\n * GenericMapOverlay - Universal fallback overlay\r\n * \r\n * Features:\r\n * - Detects both Google Maps and Mapbox instances\r\n * - Uses 8 fallback detection strategies\r\n * - Delegates rendering to appropriate base class methods\r\n */\r\nclass GenericMapOverlay extends MapOverlayBase {\r\n  constructor(debug = false) {\r\n    super(debug);\r\n    this.siteId = 'generic';\r\n    this.detectedMapType = null; // 'google' or 'mapbox'\r\n\r\n    // For Google Maps rendering\r\n    this.markerPool = new MarkerPool();\r\n    this.activeElements = new Map();\r\n    this.batchOverlay = null;\r\n\r\n    // For Mapbox rendering\r\n    this.activeMarkers = new Map();\r\n\r\n    // Suppress repeated logs\r\n    this._hasLoggedGoogleMarkers = false;\r\n    this._hasLoggedMapboxMarkers = false;\r\n  }\r\n\r\n  /**\r\n   * @override\r\n   * Detects map container using multiple fallback strategies\r\n   * @returns {HTMLElement|null} The map container element\r\n   */\r\n  detect() {\r\n    // 8 fallback detection strategies\r\n    const selectors = [\r\n      '.gm-style',           // Google Maps\r\n      '.mapboxgl-map',       // Mapbox GL JS\r\n      '.leaflet-container',  // Leaflet\r\n      'canvas',              // Canvas-based maps\r\n      '#map-container',      // Common ID\r\n      '.map-container',      // Common class\r\n      '[data-rf-test-id=\"map\"]', // Redfin specific\r\n      'div[class*=\"Map\"]',   // Generic Map class\r\n      'div[class*=\"map\"]'    // Generic map class (lowercase)\r\n    ];\r\n\r\n    for (const selector of selectors) {\r\n      const el = document.querySelector(selector);\r\n      if (el) {\r\n        this.log('Detected generic map container:', selector);\r\n        this.container = el;\r\n        return el;\r\n      }\r\n    }\r\n\r\n    return null;\r\n  }\r\n\r\n  /**\r\n   * @override\r\n   * Checks if the given map instance is compatible (Google or Mapbox)\r\n   * @param {Object} mapInstance - The map instance to check\r\n   * @returns {boolean} True if compatible\r\n   */\r\n  isCompatibleMap(mapInstance) {\r\n    if (MapTypeDetector.isGoogleMap(mapInstance)) {\r\n      this.detectedMapType = 'google';\r\n      return true;\r\n    }\r\n    if (MapTypeDetector.isMapbox(mapInstance)) {\r\n      this.detectedMapType = 'mapbox';\r\n      return true;\r\n    }\r\n    return false;\r\n  }\r\n\r\n  /**\r\n   * @override\r\n   * Renders markers for generic overlays\r\n   * @param {Array} pois - Array of POI objects\r\n   * @param {Object} mapInstance - The map instance\r\n   */\r\n  renderMarkers(pois, mapInstance) {\r\n    const filteredPois = this._filterNativePois(pois);\r\n    if (!mapInstance) {\r\n      this.log('No map instance provided');\r\n      return;\r\n    }\r\n\r\n    // Determine map type if not already known\r\n    if (!this.detectedMapType) {\r\n      if (MapTypeDetector.isGoogleMap(mapInstance)) {\r\n        this.detectedMapType = 'google';\r\n      } else if (MapTypeDetector.isMapbox(mapInstance)) {\r\n        this.detectedMapType = 'mapbox';\r\n      } else {\r\n        this.log('Unknown map type, cannot render');\r\n        return;\r\n      }\r\n    }\r\n\r\n    if (this.detectedMapType === 'google') {\r\n      this._renderGoogleMarkers(filteredPois, mapInstance);\r\n    } else if (this.detectedMapType === 'mapbox') {\r\n      this._renderMapboxMarkers(filteredPois, mapInstance);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Renders markers on Google Maps\r\n   * @param {Array} pois - Array of POI objects\r\n   * @param {Object} mapInstance - Google Maps instance\r\n   * @private\r\n   */\r\n  _renderGoogleMarkers(pois, mapInstance) {\r\n    if (!window.google || !window.google.maps || !window.google.maps.OverlayView) {\r\n      if (!this._hasLoggedGoogleMarkers) {\r\n        this.log('Google Maps API not available');\r\n        this._hasLoggedGoogleMarkers = true;\r\n      }\r\n      return;\r\n    }\r\n\r\n    // Reuse GoogleMapsOverlayBase rendering logic\r\n    // Create batch overlay if it doesn't exist\r\n    if (!mapInstance._poiBatchLayer && window.PoiBatchOverlay) {\r\n      mapInstance._poiBatchLayer = new window.PoiBatchOverlay(mapInstance);\r\n      mapInstance._poiBatchLayer.setMap(mapInstance);\r\n    }\r\n\r\n    if (mapInstance._poiBatchLayer) {\r\n      mapInstance._poiBatchLayer.updatePois(pois);\r\n      if (pois.length > 0) {\r\n        if (!this._hasLoggedGoogleMarkers) {\r\n          this.log(`Rendered ${pois.length} Google markers`);\r\n          this._hasLoggedGoogleMarkers = true;\r\n        }\r\n      } else {\r\n        this._hasLoggedGoogleMarkers = false;\r\n      }\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Renders markers on Mapbox\r\n   * @param {Array} pois - Array of POI objects\r\n   * @param {Object} mapInstance - Mapbox instance\r\n   * @private\r\n   */\r\n  _renderMapboxMarkers(pois, mapInstance) {\r\n    if (!window.mapboxgl || !window.mapboxgl.Marker) {\r\n      if (!this._hasLoggedMapboxMarkers) {\r\n        this.log('Mapbox GL JS not available');\r\n        this._hasLoggedMapboxMarkers = true;\r\n      }\r\n      return;\r\n    }\r\n\r\n    // Generate unique ID for this map\r\n    if (!mapInstance._poiUid) {\r\n      mapInstance._poiUid = Math.random().toString(36).substr(2, 9);\r\n    }\r\n\r\n    const usedIds = new Set();\r\n\r\n    pois.forEach(poi => {\r\n      const id = `${mapInstance._poiUid}-${MapUtils.getPoiId(poi)}`;\r\n      usedIds.add(id);\r\n\r\n      if (this.activeMarkers.has(id)) return;\r\n\r\n      const el = this.createMarker(poi, mapInstance);\r\n      const marker = new window.mapboxgl.Marker({ element: el })\r\n        .setLngLat([parseFloat(poi.longitude), parseFloat(poi.latitude)])\r\n        .addTo(mapInstance);\r\n\r\n      this.activeMarkers.set(id, marker);\r\n    });\r\n\r\n    // Cleanup old markers\r\n    this.activeMarkers.forEach((marker, id) => {\r\n      if (id.startsWith(mapInstance._poiUid) && !usedIds.has(id)) {\r\n        marker.remove();\r\n        this.activeMarkers.delete(id);\r\n      }\r\n    });\r\n\r\n    if (pois.length > 0) {\r\n      if (!this._hasLoggedMapboxMarkers) {\r\n        this.log(`Rendered ${pois.length} Mapbox markers`);\r\n        this._hasLoggedMapboxMarkers = true;\r\n      }\r\n    } else {\r\n      this._hasLoggedMapboxMarkers = false;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * @override\r\n   * Creates a marker element\r\n   * @param {Object} poi - POI object\r\n   * @param {Object} map - Map instance\r\n   * @returns {HTMLElement} The marker element\r\n   */\r\n  createMarker(poi, map) {\r\n    const el = document.createElement('div');\r\n    el.className = 'poi-native-marker-generic';\r\n\r\n    const color = poi.color || '#ff0000';\r\n    const secondaryColor = poi.secondaryColor || '#ffffff';\r\n    const logo = poi.logoData;\r\n    const fallbackSvg = MapUtils.generateFallbackSVG(color, secondaryColor, 32);\r\n\r\n    el.style.cssText = `\r\n      width: 32px;\r\n      height: 32px;\r\n      cursor: pointer;\r\n      position: relative;\r\n      z-index: 10;\r\n      background-image: url('${logo || fallbackSvg}');\r\n      background-size: contain;\r\n      background-repeat: no-repeat;\r\n      filter: drop-shadow(0px 2px 4px rgba(0,0,0,0.4));\r\n    `;\r\n\r\n    el.setAttribute('data-id', MapUtils.getPoiId(poi));\r\n    el.setAttribute('data-lat', poi.latitude);\r\n    el.setAttribute('data-lng', poi.longitude);\r\n\r\n    // Click handler\r\n    el.onclick = (e) => {\r\n      e.stopPropagation();\r\n      window.postMessage({\r\n        type: 'POI_MARKER_CLICK',\r\n        id: poi.id,\r\n        lat: poi.latitude,\r\n        lng: poi.longitude\r\n      }, '*');\r\n    };\r\n\r\n    // Hover handlers\r\n    el.onmouseenter = () => {\r\n      el.style.zIndex = '1000000';\r\n      window.postMessage({\r\n        type: 'POI_MARKER_HOVER',\r\n        id: poi.id,\r\n        lat: poi.latitude,\r\n        lng: poi.longitude\r\n      }, '*');\r\n    };\r\n\r\n    el.onmouseleave = () => {\r\n      el.style.zIndex = '10';\r\n      window.postMessage({\r\n        type: 'POI_MARKER_LEAVE',\r\n        id: poi.id\r\n      }, '*');\r\n    };\r\n\r\n    return el;\r\n  }\r\n\r\n  /**\r\n   * @override\r\n   * Clears all markers\r\n   */\r\n  clear() {\r\n    // Clear Mapbox markers\r\n    this.activeMarkers.forEach((marker, id) => {\r\n      marker.remove();\r\n    });\r\n    this.activeMarkers.clear();\r\n\r\n    // Clear Google markers (via pool)\r\n    this.activeElements.forEach((el, id) => {\r\n      this.markerPool.release(el);\r\n    });\r\n    this.activeElements.clear();\r\n\r\n    super.clear();\r\n  }\r\n\r\n  /**\r\n   * @override\r\n   * Cleanup resources\r\n   */\r\n  cleanup() {\r\n    this.clear();\r\n    this.markerPool.clear();\r\n    this.detectedMapType = null;\r\n    super.cleanup();\r\n  }\r\n}\r\n\r\n// Export for different module systems\r\nif (typeof module !== 'undefined' && module.exports) {\r\n  module.exports = GenericMapOverlay;\r\n} else if (typeof window !== 'undefined') {\r\n  window.GenericMapOverlay = GenericMapOverlay;\r\n}\r\n", "// [SOURCE: overlays/OverlayRegistry.js]\n/**\r\n * OverlayRegistry.js - Registry for map instances and their associated overlays\r\n * \r\n * CRITICAL: This registry implements Phase 6.5 - Multi-Map Isolation\r\n * \r\n * Problem Being Solved:\r\n * When loading sites like realtor.com, scripts would read DOM elements and see\r\n * domains from iframes/ads (not realtor.com), which would overwrite the global\r\n * domain variable, causing the incorrect overlay class to be instantiated.\r\n * \r\n * Solution:\r\n * - Each map instance gets a unique ID at discovery time\r\n * - Domain detection happens at discovery time for THAT specific map\r\n * - The overlay assignment is locked to that map and cannot be changed\r\n * - Network requests cannot change the overlay assignment\r\n * - Each map maintains its own isolated overlay instance\r\n */\r\n\r\n/**\r\n * MapEntry - Represents a registered map instance\r\n */\r\nclass MapEntry {\r\n  /**\r\n   * @param {string} id - Unique map identifier\r\n   * @param {Object} mapInstance - The map instance\r\n   * @param {string} domain - Domain detected at discovery time\r\n   * @param {MapOverlayBase} overlay - The overlay instance\r\n   */\r\n  constructor(id, mapInstance, domain, overlay) {\r\n    this.id = id;\r\n    this.mapInstance = mapInstance;\r\n    this.domain = domain;\r\n    this.overlay = overlay;\r\n    this.createdAt = Date.now();\r\n    this.lastUpdate = Date.now();\r\n    this.bounds = null;\r\n    this.isActive = true;\r\n    \r\n    // Lock the domain - it cannot be changed after creation\r\n    Object.defineProperty(this, 'domain', {\r\n      value: domain,\r\n      writable: false,\r\n      configurable: false\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Updates the last activity timestamp\r\n   */\r\n  touch() {\r\n    this.lastUpdate = Date.now();\r\n  }\r\n\r\n  /**\r\n   * Deactivates this entry\r\n   */\r\n  deactivate() {\r\n    this.isActive = false;\r\n    if (this.overlay && typeof this.overlay.cleanup === 'function') {\r\n      this.overlay.cleanup();\r\n    }\r\n  }\r\n}\r\n\r\n/**\r\n * OverlayRegistry - Singleton registry for map-overlay associations\r\n * \r\n * Key guarantees:\r\n * 1. Domain is detected once at registration time\r\n * 2. Domain cannot be changed after registration\r\n * 3. Each map has exactly one overlay\r\n * 4. Network activity cannot affect domain/overlay assignments\r\n */\r\nclass OverlayRegistry {\r\n  constructor() {\r\n    /**\r\n     * Map from map ID to MapEntry\r\n     * @type {Map<string, MapEntry>}\r\n     */\r\n    this.entries = new Map();\r\n    \r\n    /**\r\n     * WeakMap from map instance to map ID (for reverse lookup)\r\n     * @type {WeakMap<Object, string>}\r\n     */\r\n    this.instanceToId = new WeakMap();\r\n    \r\n    /**\r\n     * Counter for generating unique IDs\r\n     */\r\n    this.idCounter = 0;\r\n    \r\n    /**\r\n     * Reference to the overlay factory\r\n     */\r\n    this.factory = null;\r\n    \r\n    /**\r\n     * Debug mode\r\n     */\r\n    this.debug = false;\r\n  }\r\n\r\n  /**\r\n   * Sets the overlay factory\r\n   * @param {OverlayFactory} factory - The factory instance\r\n   */\r\n  setFactory(factory) {\r\n    this.factory = factory;\r\n  }\r\n\r\n  /**\r\n   * Enable/disable debug logging\r\n   * @param {boolean} enabled - Debug flag\r\n   */\r\n  setDebug(enabled) {\r\n    this.debug = enabled;\r\n    if (this.factory) {\r\n      this.factory.setDebug(enabled);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Log helper\r\n   * @param {...any} args - Arguments to log\r\n   */\r\n  log(...args) {\r\n    if (this.debug) {\r\n      console.log('[OverlayRegistry]', ...args);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Generates a unique map ID\r\n   * @returns {string} Unique ID\r\n   */\r\n  generateId() {\r\n    return `map_${++this.idCounter}_${Date.now()}`;\r\n  }\r\n\r\n  /**\r\n   * Extracts the domain from a map instance's container context\r\n   * This is called ONCE at registration time and cannot be changed.\r\n   * \r\n   * @param {Object} mapInstance - The map instance\r\n   * @param {HTMLElement} [container] - Optional container element\r\n   * @returns {string} The detected domain (empty string if unknown)\r\n   * @private\r\n   */\r\n  _extractDomainFromMap(mapInstance, container = null) {\r\n    let domain = '';\r\n    \r\n    // Priority 1: Explicit container\r\n    if (container && container.ownerDocument) {\r\n      try {\r\n        const doc = container.ownerDocument;\r\n        // Only trust if same-origin\r\n        if (doc.location) {\r\n          domain = doc.location.hostname;\r\n        }\r\n      } catch (e) {\r\n        // Cross-origin, ignore\r\n      }\r\n    }\r\n    \r\n    // Priority 2: Map's getDiv (Google Maps)\r\n    if (!domain && mapInstance && typeof mapInstance.getDiv === 'function') {\r\n      try {\r\n        const div = mapInstance.getDiv();\r\n        if (div && div.ownerDocument && div.ownerDocument.location) {\r\n          domain = div.ownerDocument.location.hostname;\r\n        }\r\n      } catch (e) {}\r\n    }\r\n    \r\n    // Priority 3: Map's _container (Mapbox)\r\n    if (!domain && mapInstance && mapInstance._container) {\r\n      try {\r\n        const c = mapInstance._container;\r\n        if (c.ownerDocument && c.ownerDocument.location) {\r\n          domain = c.ownerDocument.location.hostname;\r\n        }\r\n      } catch (e) {}\r\n    }\r\n    \r\n    // Priority 4: Map's container property (generic)\r\n    if (!domain && mapInstance && mapInstance.container) {\r\n      try {\r\n        const c = mapInstance.container;\r\n        const el = (typeof c === 'string') ? document.getElementById(c) : c;\r\n        if (el && el.ownerDocument && el.ownerDocument.location) {\r\n          domain = el.ownerDocument.location.hostname;\r\n        }\r\n      } catch (e) {}\r\n    }\r\n    \r\n    // Priority 5: Top-level window (ONLY if in main frame)\r\n    if (!domain) {\r\n      try {\r\n        if (window === window.top) {\r\n          domain = window.location.hostname;\r\n        }\r\n      } catch (e) {\r\n        // Cross-origin iframe\r\n      }\r\n    }\r\n    \r\n    this.log(`Extracted domain for map: ${domain || '(unknown)'}`);\r\n    return domain || '';\r\n  }\r\n\r\n  /**\r\n   * Registers a map instance with the registry\r\n   * Domain detection happens HERE and is locked.\r\n   * \r\n   * @param {Object} mapInstance - The map instance\r\n   * @param {HTMLElement} [container] - Optional container element\r\n   * @returns {MapEntry} The registry entry\r\n   */\r\n  register(mapInstance, container = null) {\r\n    // Log registration attempt\r\n    console.log('[OverlayRegistry] register() called for mapInstance:', mapInstance, 'container:', container);\r\n\r\n    // Check if already registered\r\n    if (this.instanceToId.has(mapInstance)) {\r\n      const existingId = this.instanceToId.get(mapInstance);\r\n      const entry = this.entries.get(existingId);\r\n      if (entry) {\r\n        entry.touch();\r\n        this.log(`Map already registered: ${existingId}`);\r\n        return entry;\r\n      }\r\n    }\r\n\r\n    // Generate unique ID\r\n    const id = this.generateId();\r\n\r\n    // Extract domain AT THIS MOMENT - this is locked and cannot change\r\n    const domain = this._extractDomainFromMap(mapInstance, container);\r\n    console.log('[OverlayRegistry] Extracted domain:', domain);\r\n\r\n    // Create overlay using factory or fallback\r\n    let overlay = null;\r\n    if (this.factory) {\r\n      overlay = this.factory.createOverlay(domain);\r\n      console.log('[OverlayRegistry] Created overlay via this.factory:', overlay, 'for domain:', domain);\r\n    } else if (typeof window.overlayFactory !== 'undefined' && window.overlayFactory) {\r\n      overlay = window.overlayFactory.createOverlay(domain);\r\n      console.log('[OverlayRegistry] Created overlay via window.overlayFactory:', overlay, 'for domain:', domain);\r\n      // Fallback if overlay is still null\r\n      if (!overlay && typeof window.GenericMapOverlay !== 'undefined') {\r\n        overlay = new window.GenericMapOverlay();\r\n        console.warn('[OverlayRegistry] Fallback: Created GenericMapOverlay for domain:', domain);\r\n      }\r\n    } else if (typeof window.GenericMapOverlay !== 'undefined') {\r\n      overlay = new window.GenericMapOverlay();\r\n      console.warn('[OverlayRegistry] Fallback: Created GenericMapOverlay for domain:', domain);\r\n    } else {\r\n      console.warn('[OverlayRegistry] No overlay factory or GenericMapOverlay found for domain:', domain);\r\n    }\r\n\r\n    // Create entry\r\n    const entry = new MapEntry(id, mapInstance, domain, overlay);\r\n    console.log('[OverlayRegistry] MapEntry created:', entry);\r\n\r\n    // Store in registries\r\n    this.entries.set(id, entry);\r\n    this.instanceToId.set(mapInstance, id);\r\n\r\n    // Tag the map instance with its ID\r\n    if (mapInstance) {\r\n      try {\r\n        mapInstance._poiRegistryId = id;\r\n      } catch (e) {}\r\n    }\r\n\r\n    this.log(`Registered map: ${id} for domain: ${domain}`);\r\n    \r\n    return entry;\r\n  }\r\n\r\n  /**\r\n   * Gets a map entry by map instance\r\n   * @param {Object} mapInstance - The map instance\r\n   * @returns {MapEntry|null} The entry or null\r\n   */\r\n  getByInstance(mapInstance) {\r\n    const id = this.instanceToId.get(mapInstance);\r\n    return id ? this.entries.get(id) : null;\r\n  }\r\n\r\n  /**\r\n   * Gets a map entry by ID\r\n   * @param {string} id - The map ID\r\n   * @returns {MapEntry|null} The entry or null\r\n   */\r\n  getById(id) {\r\n    return this.entries.get(id) || null;\r\n  }\r\n\r\n  /**\r\n   * Gets the overlay for a map instance\r\n   * @param {Object} mapInstance - The map instance\r\n   * @returns {MapOverlayBase|null} The overlay or null\r\n   */\r\n  getOverlay(mapInstance) {\r\n    const entry = this.getByInstance(mapInstance);\r\n    return entry ? entry.overlay : null;\r\n  }\r\n\r\n  /**\r\n   * Gets all active entries\r\n   * @returns {MapEntry[]} Array of active entries\r\n   */\r\n  getActiveEntries() {\r\n    return Array.from(this.entries.values()).filter(e => e.isActive);\r\n  }\r\n\r\n  /**\r\n   * Gets all entries for a specific domain\r\n   * @param {string} domain - The domain to filter by\r\n   * @returns {MapEntry[]} Array of entries\r\n   */\r\n  getByDomain(domain) {\r\n    const normalized = domain.toLowerCase().replace(/^www\\./, '');\r\n    return Array.from(this.entries.values()).filter(e => {\r\n      const entryDomain = e.domain.toLowerCase().replace(/^www\\./, '');\r\n      return entryDomain === normalized || entryDomain.endsWith(`.${normalized}`);\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Unregisters a map instance\r\n   * @param {Object} mapInstance - The map instance\r\n   * @returns {boolean} True if successfully unregistered\r\n   */\r\n  unregister(mapInstance) {\r\n    const id = this.instanceToId.get(mapInstance);\r\n    if (!id) return false;\r\n    \r\n    const entry = this.entries.get(id);\r\n    if (entry) {\r\n      entry.deactivate();\r\n      this.entries.delete(id);\r\n    }\r\n    \r\n    this.instanceToId.delete(mapInstance);\r\n    this.log(`Unregistered map: ${id}`);\r\n    return true;\r\n  }\r\n\r\n  /**\r\n   * Updates bounds for a map entry\r\n   * NOTE: This does NOT change the domain or overlay!\r\n   * \r\n   * @param {Object} mapInstance - The map instance\r\n   * @param {Object} bounds - The bounds object\r\n   */\r\n  updateBounds(mapInstance, bounds) {\r\n    const entry = this.getByInstance(mapInstance);\r\n    if (entry) {\r\n      entry.bounds = bounds;\r\n      entry.touch();\r\n      // Do NOT change entry.domain or entry.overlay - they are locked\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Cleans up stale entries (maps that have been removed)\r\n   * @param {number} [maxAge=300000] - Maximum age in milliseconds (default 5 minutes)\r\n   */\r\n  cleanup(maxAge = 300000) {\r\n    const now = Date.now();\r\n    const toRemove = [];\r\n    \r\n    this.entries.forEach((entry, id) => {\r\n      // Check if map instance is still valid\r\n      let isValid = false;\r\n      try {\r\n        const map = entry.mapInstance;\r\n        if (map) {\r\n          // Google Maps\r\n          if (typeof map.getDiv === 'function') {\r\n            const div = map.getDiv();\r\n            isValid = div && document.contains(div);\r\n          }\r\n          // Mapbox\r\n          else if (map._container) {\r\n            isValid = document.contains(map._container);\r\n          }\r\n          // Generic\r\n          else if (map.container) {\r\n            const c = typeof map.container === 'string' \r\n              ? document.getElementById(map.container) \r\n              : map.container;\r\n            isValid = c && document.contains(c);\r\n          }\r\n        }\r\n      } catch (e) {}\r\n      \r\n      // Remove if invalid or too old\r\n      if (!isValid || (now - entry.lastUpdate > maxAge)) {\r\n        toRemove.push(id);\r\n      }\r\n    });\r\n    \r\n    for (const id of toRemove) {\r\n      const entry = this.entries.get(id);\r\n      if (entry) {\r\n        entry.deactivate();\r\n        this.entries.delete(id);\r\n        // Note: Can't remove from WeakMap, but that's fine - it'll be garbage collected\r\n      }\r\n      this.log(`Cleaned up stale entry: ${id}`);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Gets registry statistics\r\n   * @returns {Object} Stats object\r\n   */\r\n  getStats() {\r\n    const entries = Array.from(this.entries.values());\r\n    return {\r\n      total: entries.length,\r\n      active: entries.filter(e => e.isActive).length,\r\n      domains: [...new Set(entries.map(e => e.domain))],\r\n      oldestEntry: entries.length > 0 \r\n        ? Math.min(...entries.map(e => e.createdAt))\r\n        : null\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Clears all entries\r\n   */\r\n  clear() {\r\n    this.entries.forEach(entry => entry.deactivate());\r\n    this.entries.clear();\r\n    // WeakMap entries will be garbage collected\r\n    this.idCounter = 0;\r\n    this.log('Registry cleared');\r\n  }\r\n\r\n  /**\r\n   * Get debug info about all registered overlays\r\n   * Useful for debugging map detection issues\r\n   */\r\n  getDebugInfo() {\r\n    const info = [];\r\n    this.entries.forEach((entry, id) => {\r\n      info.push({\r\n        id: entry.id,\r\n        domain: entry.domain,\r\n        overlayClass: entry.overlay ? entry.overlay.constructor.name : 'none',\r\n        overlayId: entry.overlay ? entry.overlay.siteId : 'none',\r\n        nativeMarkersInjected: entry.overlay ? entry.overlay._nativeMarkersInjected : 'N/A',\r\n        isActive: entry.isActive,\r\n        createdAt: new Date(entry.createdAt).toISOString(),\r\n        lastUpdate: new Date(entry.lastUpdate).toISOString(),\r\n        poiCount: entry.overlay ? (entry.overlay.pois ? entry.overlay.pois.length : 0) : 0\r\n      });\r\n    });\r\n    return info;\r\n  }\r\n\r\n  /**\r\n   * Log all overlays info to console\r\n   */\r\n  logDebugInfo() {\r\n    const info = this.getDebugInfo();\r\n    console.log('[OverlayRegistry] Current overlays:', info);\r\n    return info;\r\n  }\r\n}\r\n\r\n// Singleton instance\r\nconst overlayRegistry = new OverlayRegistry();\r\n\r\n// Export for different module systems\r\nif (typeof module !== 'undefined' && module.exports) {\r\n  module.exports = { OverlayRegistry, MapEntry, overlayRegistry };\r\n}\r\n// Always attach to window if available (for debugging)\r\nif (typeof window !== 'undefined') {\r\n  window.OverlayRegistry = OverlayRegistry;\r\n  window.MapEntry = MapEntry;\r\n  window.overlayRegistry = overlayRegistry;\r\n  if (window.overlayRegistry) {\r\n    console.log('[OverlayRegistry] overlayRegistry attached to window:', window.overlayRegistry);\r\n  }\r\n}\r\n", "// [SOURCE: overlays/overlayFactory.js]\n/**\r\n * overlayFactory.js - Factory for creating site-specific overlay instances\r\n * \r\n * This factory uses the overlay configuration to determine which overlay class\r\n * to instantiate for a given domain. It supports domain detection at map\r\n * discovery time (not globally) to prevent interference from ads/iframes.\r\n */\r\n\r\n/**\r\n * OverlayFactory - Creates appropriate overlay instances for each site\r\n */\r\nclass OverlayFactory {\r\n  constructor() {\r\n    /**\r\n     * Registry of overlay classes\r\n     * Maps class names to constructors\r\n     */\r\n    this.overlayClasses = {};\r\n    \r\n    /**\r\n     * Site configuration (loaded from overlayConfig.json or inline)\r\n     */\r\n    this.config = null;\r\n    \r\n    /**\r\n     * Debug mode\r\n     */\r\n    this.debug = false;\r\n  }\r\n\r\n  /**\r\n   * Enable/disable debug logging\r\n   * @param {boolean} enabled - Debug flag\r\n   */\r\n  setDebug(enabled) {\r\n    this.debug = enabled;\r\n  }\r\n\r\n  /**\r\n   * Log helper\r\n   * @param {...any} args - Arguments to log\r\n   */\r\n  log(...args) {\r\n    if (this.debug) {\r\n      console.log('[OverlayFactory]', ...args);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Loads the overlay configuration\r\n   * In a browser extension context, this may be embedded or fetched\r\n   * @param {Object} [configOverride] - Optional config to use instead of fetching\r\n   */\r\n  loadConfig(configOverride = null) {\r\n    if (configOverride) {\r\n      this.config = configOverride;\r\n      return;\r\n    }\r\n\r\n    // Default inline config (mirrors overlayConfig.json)\r\n    this.config = {\r\n      sites: {\r\n        'zillow.com': { overlay: 'ZillowOverlay', mapType: 'mapbox', priority: 100 },\r\n        'redfin.com': { overlay: 'RedfinOverlay', mapType: 'google', priority: 100 },\r\n        'homes.com': { overlay: 'HomesComOverlay', mapType: 'google', priority: 100 },\r\n        'onekeymls.com': { overlay: 'OneKeyOverlay', mapType: 'mapbox', priority: 100 },\r\n        'realtor.com': { overlay: 'RealtorOverlay', mapType: 'auto', priority: 100 }\r\n      },\r\n      defaults: { overlay: 'GenericMapOverlay', mapType: 'auto', priority: 1 },\r\n      domainAliases: {\r\n        'www.zillow.com': 'zillow.com',\r\n        'www.redfin.com': 'redfin.com',\r\n        'www.homes.com': 'homes.com',\r\n        'www.onekeymls.com': 'onekeymls.com',\r\n        'www.realtor.com': 'realtor.com'\r\n      }\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Registers an overlay class with the factory\r\n   * @param {string} name - Class name (e.g., 'ZillowOverlay')\r\n   * @param {Function} overlayClass - The overlay class constructor\r\n   */\r\n  registerOverlay(name, overlayClass) {\r\n    this.overlayClasses[name] = overlayClass;\r\n    this.log(`Registered overlay: ${name}`);\r\n  }\r\n\r\n  /**\r\n   * Registers all known overlay classes from the window object\r\n   * Call this after all overlay scripts have loaded\r\n   */\r\n  registerFromWindow() {\r\n    const overlayNames = [\r\n      'ZillowOverlay',\r\n      'RedfinOverlay',\r\n      'HomesComOverlay',\r\n      'OneKeyOverlay',\r\n      'RealtorOverlay',\r\n      'GenericMapOverlay',\r\n      'MapOverlayBase',\r\n      'GoogleMapsOverlayBase',\r\n      'MapboxOverlayBase'\r\n    ];\r\n\r\n    for (const name of overlayNames) {\r\n      if (typeof window[name] === 'function') {\r\n        this.registerOverlay(name, window[name]);\r\n      }\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Normalizes a domain name (removes www, handles aliases)\r\n   * @param {string} domain - The domain to normalize\r\n   * @returns {string} Normalized domain\r\n   */\r\n  normalizeDomain(domain) {\r\n    if (!domain) return '';\r\n    \r\n    // Lowercase\r\n    domain = domain.toLowerCase();\r\n    \r\n    // Check aliases\r\n    if (this.config && this.config.domainAliases && this.config.domainAliases[domain]) {\r\n      return this.config.domainAliases[domain];\r\n    }\r\n    \r\n    // Remove www prefix\r\n    if (domain.startsWith('www.')) {\r\n      domain = domain.substring(4);\r\n    }\r\n    \r\n    return domain;\r\n  }\r\n\r\n  /**\r\n   * Gets the site configuration for a domain\r\n   * @param {string} domain - The domain to look up\r\n   * @returns {Object} Site config or defaults\r\n   */\r\n  getSiteConfig(domain) {\r\n    if (!this.config) {\r\n      this.loadConfig();\r\n    }\r\n\r\n    const normalized = this.normalizeDomain(domain);\r\n    \r\n    // Direct match\r\n    if (this.config.sites[normalized]) {\r\n      return this.config.sites[normalized];\r\n    }\r\n    \r\n    // Partial match (e.g., 'zillow.com' matches 'maps.zillow.com')\r\n    for (const siteDomain of Object.keys(this.config.sites)) {\r\n      if (normalized.endsWith(siteDomain) || normalized.includes(siteDomain)) {\r\n        return this.config.sites[siteDomain];\r\n      }\r\n    }\r\n    \r\n    // Return defaults\r\n    return this.config.defaults;\r\n  }\r\n\r\n  /**\r\n   * Creates an overlay instance for the given domain\r\n   * @param {string} domain - The domain to create an overlay for\r\n   * @returns {MapOverlayBase|null} The overlay instance, or null if unavailable\r\n   */\r\n  createOverlay(domain) {\r\n    const siteConfig = this.getSiteConfig(domain);\r\n    const overlayName = siteConfig.overlay;\r\n    \r\n    console.log(`Creating overlay for ${domain}: ${overlayName}`);\r\n    \r\n    const OverlayClass = this.overlayClasses[overlayName];\r\n    if (!OverlayClass) {\r\n      this.log(`Overlay class not found: ${overlayName}, falling back to GenericMapOverlay`);\r\n      \r\n      const FallbackClass = this.overlayClasses['GenericMapOverlay'];\r\n      if (FallbackClass) {\r\n        return new FallbackClass(this.debug);\r\n      }\r\n      \r\n      return null;\r\n    }\r\n    \r\n    return new OverlayClass(this.debug);\r\n  }\r\n\r\n  /**\r\n   * Creates an overlay for a specific map instance, determining domain\r\n   * from the map's container element context.\r\n   * \r\n   * This is the key method for Phase 6.5 - it determines the domain\r\n   * at discovery time based on the map's location in the DOM, not\r\n   * from global state that could be polluted by iframes/ads.\r\n   * \r\n   * @param {Object} mapInstance - The map instance\r\n   * @param {HTMLElement} [container] - Optional container element\r\n   * @returns {MapOverlayBase|null} The overlay instance\r\n   */\r\n  createOverlayForMap(mapInstance, container = null) {\r\n    // Get domain from the map's document context\r\n    let domain = null;\r\n    \r\n    // Method 1: From container's ownerDocument\r\n    if (container && container.ownerDocument) {\r\n      try {\r\n        domain = container.ownerDocument.location?.hostname;\r\n      } catch (e) {}\r\n    }\r\n    \r\n    // Method 2: From map's container (if it has one)\r\n    if (!domain && mapInstance) {\r\n      try {\r\n        // Google Maps\r\n        if (typeof mapInstance.getDiv === 'function') {\r\n          const div = mapInstance.getDiv();\r\n          domain = div?.ownerDocument?.location?.hostname;\r\n        }\r\n        // Mapbox\r\n        else if (mapInstance._container) {\r\n          domain = mapInstance._container.ownerDocument?.location?.hostname;\r\n        }\r\n        // Generic container reference\r\n        else if (mapInstance.container) {\r\n          const c = mapInstance.container;\r\n          const el = (typeof c === 'string') ? document.getElementById(c) : c;\r\n          domain = el?.ownerDocument?.location?.hostname;\r\n        }\r\n      } catch (e) {\r\n        this.log('Failed to extract domain from map:', e);\r\n      }\r\n    }\r\n    \r\n    // Method 3: Fallback to current window (main page only)\r\n    if (!domain) {\r\n      try {\r\n        // Only use window.location if we're in the top frame\r\n        if (window === window.top) {\r\n          domain = window.location.hostname;\r\n        }\r\n      } catch (e) {\r\n        // Cross-origin iframe, ignore\r\n      }\r\n    }\r\n    \r\n    if (!domain) {\r\n      this.log('Could not determine domain for map, using generic overlay');\r\n      domain = '';\r\n    }\r\n    \r\n    return this.createOverlay(domain);\r\n  }\r\n\r\n  /**\r\n   * Gets all registered overlay class names\r\n   * @returns {string[]} Array of overlay class names\r\n   */\r\n  getRegisteredOverlays() {\r\n    return Object.keys(this.overlayClasses);\r\n  }\r\n\r\n  /**\r\n   * Gets all configured site domains\r\n   * @returns {string[]} Array of domain names\r\n   */\r\n  getConfiguredSites() {\r\n    if (!this.config) {\r\n      this.loadConfig();\r\n    }\r\n    return Object.keys(this.config.sites);\r\n  }\r\n}\r\n\r\n// Singleton instance\r\nconst overlayFactory = new OverlayFactory();\r\n\r\n// Auto-initialize config\r\noverlayFactory.loadConfig();\r\n\r\n// Export for different module systems\r\nif (typeof module !== 'undefined' && module.exports) {\r\n  module.exports = { OverlayFactory, overlayFactory };\r\n} else if (typeof window !== 'undefined') {\r\n  window.OverlayFactory = OverlayFactory;\r\n  window.overlayFactory = overlayFactory;\r\n}\r\n", "// [SOURCE: bridge/main.js]\n/**\r\n * POI Bridge: Main Entry\r\n * Orchestrates the lifecycle of the bridge.\r\n * \r\n * Updated for Phase 7.1: Uses new manager classes and OverlayRegistry\r\n */\r\n(function() {\r\n  const PREFIX = ' [POI TITAN] ';\r\n  let attempts = 0;\r\n  let registryInitialized = false;\r\n\r\n  function extractBounds(map) {\r\n    try {\r\n      const b = map.getBounds();\r\n      if (!b) return null;\r\n      if (b.getNorthEast) return { north: b.getNorthEast().lat(), south: b.getSouthWest().lat(), east: b.getNorthEast().lng(), west: b.getSouthWest().lng() };\r\n      if (b.getNorth) return { north: b.getNorth(), south: b.getSouth(), east: b.getEast(), west: b.getWest() };\r\n    } catch(e) {}\r\n    return null;\r\n  }\r\n\r\n  /**\r\n   * Initializes the overlay registry with factory\r\n   * Only called once when all dependencies are ready\r\n   */\r\n  function initializeRegistry() {\r\n    if (registryInitialized) return;\r\n    \r\n    if (window.overlayRegistry && window.overlayFactory) {\r\n      // Link registry to factory\r\n      window.overlayRegistry.setFactory(window.overlayFactory);\r\n      \r\n      // Register all overlay classes from window\r\n      window.overlayFactory.registerFromWindow();\r\n      \r\n      registryInitialized = true;\r\n      console.log(PREFIX + 'OverlayRegistry initialized with factory');\r\n    }\r\n  }\r\n\r\n  function loop() {\r\n    // 1. Dependency Guard\r\n    if (!window.poiHijack || !window.poiDiscovery || !window.poiPortal) {\r\n      if (attempts < 20) {\r\n         attempts++;\r\n         return; \r\n      }\r\n      console.warn(PREFIX + 'Bridge modules missing after 20s. Manual check required.');\r\n      return;\r\n    }\r\n\r\n    // 1.5. Initialize Registry (Phase 7.1)\r\n    initializeRegistry();\r\n\r\n    // 2. Setup Bridge Status\r\n    if (!window.poiBridgeReady) {\r\n       window.poiBridgeReady = true;\r\n       console.log(PREFIX + 'POI Bridge v7.1 Active (Secure Mode - No Network Sniffing)');\r\n       document.documentElement.setAttribute('data-poi-bridge-status', 'ONLINE');\r\n    }\r\n\r\n    // 3. Capture & Discovery\r\n    try {\r\n      // Force immediate hijack attempt (crucial for document_start)\r\n      window.poiHijack.apply();\r\n      \r\n      // Also apply discovery (throttled inside run() if maps exist)\r\n      window.poiDiscovery.run();\r\n      \r\n    // 4. Update Portal from captured instances\r\n      for (const map of window.poiHijack.activeMaps) {\r\n        const res = extractBounds(map);\r\n        if (res && res.north) { \r\n          window.poiPortal.update(res, 'instance-capture'); \r\n          \r\n          // Phase 6.5: Also update bounds in registry (does NOT change domain/overlay)\r\n          if (window.overlayRegistry) {\r\n            window.overlayRegistry.updateBounds(map, res);\r\n          }\r\n          break; \r\n        }\r\n      }\r\n      \r\n      // 5. Renderer Check - Use registry-based overlays first, fallback to legacy renderer\r\n      if (window.overlayRegistry) {\r\n        const activeEntries = window.overlayRegistry.getActiveEntries();\r\n        for (const entry of activeEntries) {\r\n          if (entry.overlay && window.poiRenderer?.lastPoiData?.length > 0) {\r\n            // Use the entry's overlay for rendering\r\n            entry.overlay.renderMarkers(window.poiRenderer.lastPoiData, entry.mapInstance);\r\n          }\r\n        }\r\n      } else if (window.poiRenderer && window.poiRenderer.lastPoiData.length > 0) {\r\n         // Legacy fallback\r\n         window.poiRenderer.update(window.poiRenderer.lastPoiData);\r\n      }\r\n    } catch(e) {\r\n      console.error(PREFIX + 'Main loop failure:', e);\r\n    }\r\n  }\r\n\r\n  // Start Orchestration\r\n  // 1000ms interval: Reduced frequency as native markers are persistent and fluid\r\n  setInterval(loop, 1000); \r\n  \r\n  // Periodic registry cleanup (every 5 minutes)\r\n  setInterval(() => {\r\n    if (window.overlayRegistry) {\r\n      window.overlayRegistry.cleanup();\r\n    }\r\n  }, 300000);\r\n  \r\n  // Listen for Data from Content Script\r\n  window.addEventListener('message', (event) => {\r\n    if (event.data && event.data.type === 'POI_DATA_UPDATE') {\r\n       // Phase 7.1: Route to registry-based overlays first\r\n       if (window.overlayRegistry) {\r\n          const entries = window.overlayRegistry.getActiveEntries();\r\n          for (const entry of entries) {\r\n            if (entry.overlay) {\r\n              entry.overlay.renderMarkers(event.data.pois, entry.mapInstance);\r\n            }\r\n          }\r\n       }\r\n       \r\n       // Legacy fallback\r\n       if (window.poiRenderer) {\r\n          window.poiRenderer.update(event.data.pois);\r\n          // Signal back success that native renderer is active\r\n          if (window.poiHijack.activeMaps.size > 0) {\r\n             window.postMessage({ type: 'POI_NATIVE_ACTIVE' }, '*');\r\n          }\r\n       }\r\n    }\r\n  });\r\n  \r\n  // Force immediate apply on script load\r\n  if (window.poiHijack) window.poiHijack.apply();\r\n  \r\n  loop();\r\n})();\r\n", "// [SOURCE: bridge/modules/ManagerBase.js]\n/**\r\n * POI Bridge: Manager Base Class\r\n * Base class for all manager singletons with initialization lifecycle.\r\n */\r\n\r\n/**\r\n * ManagerBase - Abstract base class for manager singletons\r\n * \r\n * Provides:\r\n * - Singleton pattern enforcement\r\n * - Initialization lifecycle management\r\n * - Cleanup interface\r\n * \r\n * @abstract\r\n */\r\nclass ManagerBase {\r\n  /**\r\n   * Creates a new ManagerBase instance (or returns existing singleton)\r\n   */\r\n  constructor() {\r\n    // Singleton pattern enforcement\r\n    if (this.constructor.instance) {\r\n      return this.constructor.instance;\r\n    }\r\n    this.constructor.instance = this;\r\n    \r\n    this.initialized = false;\r\n    this.initializing = false;\r\n    this._debug = false;\r\n  }\r\n\r\n  /**\r\n   * Enable or disable debug logging\r\n   * @param {boolean} enabled - Enable debug mode\r\n   */\r\n  setDebug(enabled) {\r\n    this._debug = enabled;\r\n  }\r\n\r\n  /**\r\n   * Logs debug messages if debug mode is enabled\r\n   * @param {...any} args - Arguments to log\r\n   */\r\n  log(...args) {\r\n    if (this._debug) {\r\n      console.log(`[${this.constructor.name}]`, ...args);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Logs warnings regardless of debug mode\r\n   * @param {...any} args - Arguments to log\r\n   */\r\n  warn(...args) {\r\n    console.warn(`[${this.constructor.name}]`, ...args);\r\n  }\r\n\r\n  /**\r\n   * Logs errors regardless of debug mode\r\n   * @param {...any} args - Arguments to log\r\n   */\r\n  error(...args) {\r\n    console.error(`[${this.constructor.name}]`, ...args);\r\n  }\r\n\r\n  /**\r\n   * Initializes the manager (idempotent - only runs once)\r\n   * @returns {Promise<void>}\r\n   */\r\n  async initialize() {\r\n    if (this.initialized) {\r\n      this.log('Already initialized, skipping');\r\n      return;\r\n    }\r\n\r\n    if (this.initializing) {\r\n      this.log('Initialization in progress, waiting...');\r\n      // Wait for existing initialization to complete\r\n      while (this.initializing) {\r\n        await new Promise(resolve => setTimeout(resolve, 10));\r\n      }\r\n      return;\r\n    }\r\n\r\n    this.initializing = true;\r\n    this.log('Initializing...');\r\n\r\n    try {\r\n      await this.onInitialize();\r\n      this.initialized = true;\r\n      this.log('Initialization complete');\r\n    } catch (e) {\r\n      this.error('Initialization failed:', e);\r\n      throw e;\r\n    } finally {\r\n      this.initializing = false;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Called during initialization - must be implemented by subclasses\r\n   * @abstract\r\n   * @returns {Promise<void>}\r\n   */\r\n  async onInitialize() {\r\n    throw new Error('Must implement onInitialize()');\r\n  }\r\n\r\n  /**\r\n   * Cleans up resources and resets state\r\n   * @abstract\r\n   */\r\n  cleanup() {\r\n    throw new Error('Must implement cleanup()');\r\n  }\r\n\r\n  /**\r\n   * Resets the singleton instance (useful for testing)\r\n   */\r\n  static reset() {\r\n    if (this.instance) {\r\n      try {\r\n        this.instance.cleanup();\r\n      } catch (e) {\r\n        console.warn('Cleanup during reset failed:', e);\r\n      }\r\n      this.instance = null;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Gets the singleton instance\r\n   * @returns {ManagerBase} The singleton instance\r\n   */\r\n  static getInstance() {\r\n    if (!this.instance) {\r\n      this.instance = new this();\r\n    }\r\n    return this.instance;\r\n  }\r\n}\r\n\r\nif (typeof window !== 'undefined') {\r\n  window.ManagerBase = ManagerBase;\r\n}\r\n", "// [SOURCE: bridge/entry.js]\n// bridge/entry.js\r\n// Imports all bridge modules and overlays for bundling\r\n\r\nimport '../bridge/main.js';\r\n\r\n// Bridge modules (base classes first)\r\nimport '../bridge/modules/ManagerBase.js';\r\nimport '../bridge/modules/mapUtilities.js';\r\nimport '../bridge/modules/hijack.js';\r\nimport '../bridge/modules/discovery.js';\r\n// import '../bridge/modules/sniff.js'; // DISABLED: Network sniffing removed for security (bounds tracked via instance events)\r\nimport '../bridge/modules/portal.js';\r\nimport '../bridge/modules/renderer.js';\r\n\r\n// Overlays (base classes first)\r\nimport '../overlays/MapOverlayBase.js';\r\nimport '../overlays/GoogleMapsOverlayBase.js';\r\nimport '../overlays/MapboxOverlayBase.js';\r\nimport '../overlays/ZillowOverlay.js';\r\nimport '../overlays/RedfinOverlay.js';\r\nimport '../overlays/HomesComOverlay.js';\r\nimport '../overlays/OneKeyOverlay.js';\r\nimport '../overlays/RealtorOverlay.js';\r\nimport '../overlays/GenericMapOverlay.js';\r\nimport '../overlays/OverlayRegistry.js';\r\nimport '../overlays/overlayFactory.js';\r\n", "// [SOURCE: bridge/modules/renderer.js]\n/**\r\n * POI Bridge: Renderer Module\r\n * Handles injecting native map markers into hijacked map instances.\r\n * \r\n * @deprecated Phase 7.3 - This module is deprecated.\r\n * Rendering is now handled by site-specific overlay classes in the overlays/ folder:\r\n * - ZillowOverlay.js\r\n * - RedfinOverlay.js\r\n * - HomesComOverlay.js\r\n * - OneKeyOverlay.js\r\n * - RealtorOverlay.js\r\n * - GenericMapOverlay.js\r\n * \r\n * These overlays are managed by OverlayRegistry and instantiated by OverlayFactory.\r\n * This file is kept for backwards compatibility only and will be removed in a future version.\r\n * \r\n * Migration Path:\r\n * 1. bridge/main.js now routes POI_DATA_UPDATE to overlayRegistry-based overlays first\r\n * 2. This renderer is only used as a fallback when the registry is not available\r\n */\r\nwindow.poiRenderer = {\r\n  activeMarkers: new Map(), // Map<id, NativeMarker>\r\n  lastPoiData: [],\r\n  \r\n  update(pois) {\r\n    this.lastPoiData = pois;\r\n    \r\n    // We iterate over all active maps found by Hijack module\r\n    if (!window.poiHijack || !window.poiHijack.activeMaps) return;\r\n    \r\n    for (const map of window.poiHijack.activeMaps) {\r\n      if (this.isGoogleMap(map)) {\r\n        this.renderGoogle(map, pois);\r\n      } else if (this.isMapbox(map)) {\r\n        this.renderMapbox(map, pois);\r\n      }\r\n    }\r\n  },\r\n\r\n  isGoogleMap(map) {\r\n    return (map.overlayMapTypes !== undefined || typeof map.getDiv === 'function');\r\n  },\r\n\r\n  isMapbox(map) {\r\n    return (map.addSource !== undefined && map.addLayer !== undefined && map.on !== undefined);\r\n  },\r\n\r\n  renderGoogle(map, pois) {\r\n    // Check if OverlayView is available\r\n    if (!window.google || !window.google.maps || !window.google.maps.OverlayView) return;\r\n\r\n    // Define Custom Overlay Class if not defined\r\n    if (!window.PoiCustomOverlay) {\r\n       class PoiCustomOverlay extends window.google.maps.OverlayView {\r\n          constructor(poi, element) {\r\n             super();\r\n             this.poi = poi;\r\n             this.element = element;\r\n          }\r\n          onAdd() {\r\n             this.getPanes().floatPane.appendChild(this.element);\r\n          }\r\n          draw() {\r\n             const overlayProjection = this.getProjection();\r\n             const position = new window.google.maps.LatLng(this.poi.latitude, this.poi.longitude);\r\n             const pos = overlayProjection.fromLatLngToDivPixel(position);\r\n             if (pos) {\r\n                this.element.style.left = pos.x + 'px';\r\n                this.element.style.top = pos.y + 'px';\r\n             }\r\n          }\r\n          onRemove() {\r\n             if (this.element.parentNode) this.element.parentNode.removeChild(this.element);\r\n          }\r\n       }\r\n       window.PoiCustomOverlay = PoiCustomOverlay;\r\n    }\r\n\r\n    // NEW: Batch Overlay for Massive Performance\r\n    // Instead of N overlay views, we use ONE overlay view for ALL markers on this map.\r\n    if (!window.PoiBatchOverlay) {\r\n       class PoiBatchOverlay extends window.google.maps.OverlayView {\r\n          constructor(mapInstance) {\r\n             super();\r\n             this.mapInstance = mapInstance;\r\n             this.container = document.createElement('div');\r\n             this.container.style.cssText = 'position: absolute; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none;';\r\n             this.pois = [];\r\n             this.markerPool = []; // Pool of DIVs\r\n             this.activeElements = new Map(); // POI ID -> Element\r\n             this.hasPendingDraw = false;\r\n             \r\n             // Event Delegation\r\n             this.container.addEventListener('click', (e) => {\r\n                const target = e.target.closest('.poi-native-marker');\r\n                if (target) {\r\n                   e.stopPropagation();\r\n                   // Read data attributes\r\n                   const id = target.getAttribute('data-id');\r\n                   const lat = parseFloat(target.getAttribute('data-lat'));\r\n                   const lng = parseFloat(target.getAttribute('data-lng'));\r\n                   window.postMessage({ type: 'POI_MARKER_CLICK', id, lat, lng }, '*');\r\n                }\r\n             }, true); // Capture phase to beat Google Maps listeners\r\n             \r\n             this.container.addEventListener('mouseenter', (e) => {\r\n                const target = e.target.closest('.poi-native-marker');\r\n                if (target) {\r\n                   target.style.zIndex = '1000000';\r\n                   const id = target.getAttribute('data-id');\r\n                   const lat = parseFloat(target.getAttribute('data-lat'));\r\n                   const lng = parseFloat(target.getAttribute('data-lng'));\r\n                   window.postMessage({ type: 'POI_MARKER_HOVER', id, lat, lng }, '*');\r\n                }\r\n             }, true);\r\n             \r\n             this.container.addEventListener('mouseleave', (e) => {\r\n                const target = e.target.closest('.poi-native-marker');\r\n                if (target) {\r\n                   target.style.zIndex = '102'; // Restore base z-index\r\n                   const id = target.getAttribute('data-id');\r\n                   window.postMessage({ type: 'POI_MARKER_LEAVE', id }, '*');\r\n                }\r\n             }, true);\r\n          }\r\n          \r\n          updatePois(newPois) {\r\n             this.pois = newPois;\r\n             // Trigger redraw\r\n             if (this.getProjection()) this.draw();\r\n          }\r\n\r\n          onAdd() {\r\n             this.getPanes().floatPane.appendChild(this.container);\r\n          }\r\n\r\n          onRemove() {\r\n             if (this.container.parentNode) this.container.parentNode.removeChild(this.container);\r\n          }\r\n\r\n          draw() {\r\n             if (this.hasPendingDraw) return;\r\n             this.hasPendingDraw = true;\r\n             \r\n             requestAnimationFrame(() => {\r\n                this.hasPendingDraw = false;\r\n                this._drawBatch();\r\n             });\r\n          }\r\n          \r\n          _drawBatch() {\r\n             const projection = this.getProjection();\r\n             if (!projection) return;\r\n             \r\n             const bounds = this.mapInstance.getBounds();\r\n             if (!bounds) return;\r\n             \r\n             // Diff Strategy:\r\n             // 1. Identify POIs currently in view\r\n             // 2. Recycle elements for POIs no longer in view\r\n             // 3. Create/Reuse elements for POIs now in view\r\n             \r\n             const visibleIds = new Set();\r\n             const fragment = document.createDocumentFragment();\r\n             \r\n             this.pois.forEach(poi => {\r\n                const lat = parseFloat(poi.latitude);\r\n                const lng = parseFloat(poi.longitude);\r\n                const latLng = new window.google.maps.LatLng(lat, lng);\r\n                \r\n                // Bounds Check\r\n                if (!bounds.contains(latLng)) return;\r\n                \r\n                const id = poi.id || poi.name;\r\n                visibleIds.add(id);\r\n                \r\n                const pos = projection.fromLatLngToDivPixel(latLng);\r\n                \r\n                let el = this.activeElements.get(id);\r\n                \r\n                if (!el) {\r\n                   // Get from pool or create\r\n                   if (this.markerPool.length > 0) {\r\n                      el = this.markerPool.pop();\r\n                   } else {\r\n                      el = document.createElement('div');\r\n                      el.className = 'poi-native-marker';\r\n                      // Styles are set once, only transform changes\r\n                      el.style.cssText = `\r\n                        position: absolute; width: 32px; height: 32px;\r\n                        background-size: contain; background-repeat: no-repeat;\r\n                        pointer-events: auto; cursor: pointer; z-index: 102;\r\n                        will-change: transform; top: 0; left: 0;\r\n                        filter: drop-shadow(0px 2px 4px rgba(0,0,0,0.4));\r\n                      `;\r\n                   }\r\n                   \r\n                   // Update visual content (Logo/Color)\r\n                   const color = poi.color || '#ff0000';\r\n                   const secondaryColor = poi.secondaryColor || '#ffffff';\r\n                   // Inline SVG construction (optimized string concat)\r\n                   const svg = `data:image/svg+xml;charset=utf-8,` + encodeURIComponent(`\r\n                     <svg width=\"32\" height=\"32\" viewBox=\"0 0 24 24\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\r\n                       <path d=\"M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z\" fill=\"${color}\" stroke=\"${secondaryColor}\" stroke-width=\"1\"/>\r\n                     </svg>`);\r\n                   el.style.backgroundImage = `url('${poi.logoData || svg}')`;\r\n                   \r\n                   // Store Data Attributes for Delegation\r\n                   el.setAttribute('data-id', id);\r\n                   el.setAttribute('data-lat', lat);\r\n                   el.setAttribute('data-lng', lng);\r\n                   \r\n                   this.activeElements.set(id, el);\r\n                   fragment.appendChild(el);\r\n                } else {\r\n                   // Ensure it's attached (might be re-added if logic changes, but usually stays in DOM)\r\n                   // If we are reusing, we don't append to fragment unless it was detached.\r\n                   // Here we assume it stays attached.\r\n                }\r\n                \r\n                // Update Position (Transform is faster than top/left)\r\n                // translate(-50%, -100%) handles the anchor point (bottom center)\r\n                el.style.transform = `translate(-50%, -100%) translate(${Math.round(pos.x)}px, ${Math.round(pos.y)}px)`;\r\n             });\r\n             \r\n             // Append new elements\r\n             if (fragment.childElementCount > 0) {\r\n                this.container.appendChild(fragment);\r\n             }\r\n             \r\n             // Cleanup hidden elements (Return to pool)\r\n             this.activeElements.forEach((el, id) => {\r\n                if (!visibleIds.has(id)) {\r\n                   el.remove(); // Detach from DOM\r\n                   this.markerPool.push(el); // Add to pool\r\n                   this.activeElements.delete(id);\r\n                }\r\n             });\r\n          }\r\n       }\r\n       window.PoiBatchOverlay = PoiBatchOverlay;\r\n    }\r\n\r\n    // Identify/Create Batch Layer for this map instance\r\n    if (!map._poiBatchLayer) {\r\n       map._poiBatchLayer = new window.PoiBatchOverlay(map);\r\n       map._poiBatchLayer.setMap(map);\r\n    }\r\n    \r\n    // Update Data\r\n    map._poiBatchLayer.updatePois(pois);\r\n  },\r\n\r\n  renderMapbox(map, pois) {\r\n    if (!window.mapboxgl || !window.mapboxgl.Marker) return;\r\n    \r\n    if (!map._poiUid) map._poiUid = Math.random().toString(36).substr(2, 9);\r\n    const usedIds = new Set();\r\n\r\n    pois.forEach(poi => {\r\n       const id = `${map._poiUid}-${poi.id || poi.name}`;\r\n       usedIds.add(id);\r\n       \r\n       if (this.activeMarkers.has(id)) return;\r\n\r\n       const el = document.createElement('div');\r\n       el.className = 'poi-native-marker-mapbox';\r\n       const color = poi.color || '#ff0000';\r\n       const secondaryColor = poi.secondaryColor || '#ffffff';\r\n       const logo = poi.logoData;\r\n       \r\n       // Fallback SVG if no logo\r\n       const fallbackSvg = `data:image/svg+xml;charset=utf-8,${encodeURIComponent(`\r\n         <svg width=\"32\" height=\"32\" viewBox=\"0 0 24 24\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\r\n           <path d=\"M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z\" fill=\"${color}\" stroke=\"${secondaryColor}\" stroke-width=\"1\"/>\r\n         </svg>\r\n       `)}`;\r\n\r\n       el.style.cssText = `\r\n         width: 32px; height: 32px; cursor: pointer; z-index: 5000;\r\n         background-image: url('${logo || fallbackSvg}');\r\n         background-size: contain; background-repeat: no-repeat;\r\n         filter: drop-shadow(0px 2px 4px rgba(0,0,0,0.4));\r\n       `;\r\n       \r\n       el.onclick = (e) => {\r\n          e.stopPropagation();\r\n          window.postMessage({ type: 'POI_MARKER_CLICK', id: poi.id, lat: poi.latitude, lng: poi.longitude }, '*');\r\n       };\r\n       \r\n       // Hover Listeners\r\n       el.onmouseenter = () => {\r\n          el.style.zIndex = '1000000';\r\n          window.postMessage({ type: 'POI_MARKER_HOVER', id: poi.id, lat: poi.latitude, lng: poi.longitude }, '*');\r\n       };\r\n       \r\n       el.onmouseleave = () => {\r\n          el.style.zIndex = '5000';\r\n          window.postMessage({ type: 'POI_MARKER_LEAVE', id: poi.id }, '*');\r\n       };\r\n\r\n       const marker = new window.mapboxgl.Marker({ element: el })\r\n          .setLngLat([parseFloat(poi.longitude), parseFloat(poi.latitude)])\r\n          .addTo(map);\r\n          \r\n       this.activeMarkers.set(id, marker);\r\n    });\r\n\r\n    for (const [id, marker] of this.activeMarkers) {\r\n       if (id.startsWith(map._poiUid) && !usedIds.has(id)) {\r\n          marker.remove();\r\n          this.activeMarkers.delete(id);\r\n       }\r\n    }\r\n  }\r\n};\r\n", "// [SOURCE: overlays/MapOverlayBase.js]\n/**\r\n * MapOverlayBase - Base class for all site-specific map overlays\r\n * \r\n * This abstract base class provides the foundation for rendering POI markers\r\n * on different mapping platforms (Google Maps, Mapbox, etc.). Site-specific\r\n * overlays should extend this class and implement the abstract methods.\r\n * \r\n * @abstract\r\n */\r\nclass MapOverlayBase {\r\n  /**\r\n   * Creates a new MapOverlayBase instance\r\n   * @param {boolean} debug - Enable debug logging\r\n   */\r\n  constructor(debug = false) {\r\n    if (new.target === MapOverlayBase) {\r\n      throw new Error('MapOverlayBase is abstract and cannot be instantiated directly');\r\n    }\r\n    \r\n    this.debug = debug;\r\n    this.mapInstance = null;\r\n    this.container = null;\r\n    this.isActive = false;\r\n    this.pois = [];\r\n    this.markers = new Map(); // id -> marker instance\r\n    this.mapId = null; // Unique identifier for this map instance\r\n    this.domain = null; // Domain this overlay was instantiated for\r\n    this.detectedAt = null; // Timestamp when map was detected\r\n  }\r\n\r\n  /**\r\n   * Logs debug messages if debug mode is enabled\r\n   * @param {...any} args - Arguments to log\r\n   */\r\n  log(...args) {\r\n    if (this.debug) {\r\n      console.log(`[${this.constructor.name}]`, ...args);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Generates a unique map ID for this overlay instance\r\n   * @returns {string} Unique map identifier\r\n   */\r\n  generateMapId() {\r\n    return `map_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`;\r\n  }\r\n\r\n  // ============================================\r\n  // Abstract Methods - Must be implemented by subclasses\r\n  // ============================================\r\n\r\n  /**\r\n   * Detects and returns the map container element for this site\r\n   * @abstract\r\n   * @returns {HTMLElement|null} The map container element or null if not found\r\n   */\r\n  detect() {\r\n    throw new Error('Must implement detect() - returns the map container element');\r\n  }\r\n\r\n  /**\r\n   * Checks if the given map instance is compatible with this overlay\r\n   * @abstract\r\n   * @param {Object} mapInstance - The map instance to check\r\n   * @returns {boolean} True if compatible, false otherwise\r\n   */\r\n  isCompatibleMap(mapInstance) {\r\n    throw new Error('Must implement isCompatibleMap(mapInstance)');\r\n  }\r\n\r\n  /**\r\n   * Renders markers for the given POIs on the map\r\n   * @abstract\r\n   * @param {Array} pois - Array of POI objects with latitude, longitude, and metadata\r\n   * @param {Object} mapInstance - The map instance to render on\r\n   */\r\n  renderMarkers(pois, mapInstance) {\r\n    throw new Error('Must implement renderMarkers(pois, mapInstance)');\r\n  }\r\n\r\n  /**\r\n   * Creates a single marker for a POI\r\n   * @abstract\r\n   * @param {Object} poi - POI object with latitude, longitude, and metadata\r\n   * @param {Object} map - The map instance\r\n   * @returns {Object} The created marker instance\r\n   */\r\n  createMarker(poi, map) {\r\n    throw new Error('Must implement createMarker(poi, map)');\r\n  }\r\n\r\n  // ============================================\r\n  // Optional Override Methods\r\n  // ============================================\r\n\r\n  /**\r\n   * Updates an existing marker with new POI data\r\n   * Override in subclass if needed\r\n   * @param {Object} marker - The marker instance to update\r\n   * @param {Object} poi - Updated POI data\r\n   */\r\n  updateMarker(marker, poi) {\r\n    // Default: no-op, subclasses can override\r\n  }\r\n\r\n  /**\r\n   * Removes a marker from the map\r\n   * Override in subclass if needed\r\n   * @param {Object} marker - The marker instance to remove\r\n   */\r\n  removeMarker(marker) {\r\n    // Default implementation - subclasses should override for proper cleanup\r\n    if (marker && marker.remove) {\r\n      marker.remove();\r\n    } else if (marker && marker.setMap) {\r\n      marker.setMap(null);\r\n    }\r\n  }\r\n\r\n  // ============================================\r\n  // Core Lifecycle Methods\r\n  // ============================================\r\n\r\n  /**\r\n   * Hijacks/initializes the map instance for this overlay\r\n   * Called after detect() successfully finds a container\r\n   * @param {Object} mapInstance - The map instance to hijack\r\n   */\r\n  hijack(mapInstance) {\r\n    if (!mapInstance) {\r\n      this.log('hijack() called with null map instance');\r\n      return false;\r\n    }\r\n\r\n    if (!this.isCompatibleMap(mapInstance)) {\r\n      this.log('Map instance is not compatible with this overlay');\r\n      return false;\r\n    }\r\n\r\n    this.mapInstance = mapInstance;\r\n    this.mapId = this.generateMapId();\r\n    this.detectedAt = Date.now();\r\n    this.isActive = true;\r\n\r\n    this.log('Map hijacked successfully, mapId:', this.mapId);\r\n    return true;\r\n  }\r\n\r\n  /**\r\n   * Inserts POI markers into the map\r\n   * This is the main entry point called by the system\r\n   * @param {Array} pois - Array of POI objects\r\n   */\r\n  insert(pois) {\r\n    if (!this.mapInstance) {\r\n      this.log('insert() called but no map instance available');\r\n      return;\r\n    }\r\n\r\n    if (!Array.isArray(pois)) {\r\n      this.log('insert() called with non-array pois');\r\n      return;\r\n    }\r\n\r\n    this.pois = pois;\r\n    this.renderMarkers(pois, this.mapInstance);\r\n  }\r\n\r\n  /**\r\n   * Legacy render method - now delegates to renderMarkers\r\n   * @deprecated Use insert() or renderMarkers() instead\r\n   */\r\n  render() {\r\n    if (this.pois.length > 0 && this.mapInstance) {\r\n      this.renderMarkers(this.pois, this.mapInstance);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Clears all markers from the map\r\n   */\r\n  clear() {\r\n    this.markers.forEach((marker, id) => {\r\n      this.removeMarker(marker);\r\n    });\r\n    this.markers.clear();\r\n    this.log('All markers cleared');\r\n  }\r\n\r\n  /**\r\n   * Cleans up the overlay and releases resources\r\n   */\r\n  cleanup() {\r\n    this.clear();\r\n    this.mapInstance = null;\r\n    this.container = null;\r\n    this.isActive = false;\r\n    this.pois = [];\r\n    this.log('Overlay cleaned up');\r\n  }\r\n\r\n  /**\r\n   * Gets the current map bounds\r\n   * @returns {Object|null} Bounds object with north, south, east, west or null\r\n   */\r\n  getBounds() {\r\n    if (!this.mapInstance) return null;\r\n\r\n    try {\r\n      const b = this.mapInstance.getBounds();\r\n      if (!b) return null;\r\n\r\n      // Google Maps format\r\n      if (b.getNorthEast && b.getSouthWest) {\r\n        return {\r\n          north: b.getNorthEast().lat(),\r\n          south: b.getSouthWest().lat(),\r\n          east: b.getNorthEast().lng(),\r\n          west: b.getSouthWest().lng()\r\n        };\r\n      }\r\n\r\n      // Mapbox format\r\n      if (b.getNorth) {\r\n        return {\r\n          north: b.getNorth(),\r\n          south: b.getSouth(),\r\n          east: b.getEast(),\r\n          west: b.getWest()\r\n        };\r\n      }\r\n    } catch (e) {\r\n      this.log('Error getting bounds:', e);\r\n    }\r\n\r\n    return null;\r\n  }\r\n\r\n  /**\r\n   * Checks if the extension has already rendered a marker for this POI\r\n   * Used to prevent duplicate overlay rendering\r\n   * @param {Object} poi - POI object\r\n   * @returns {boolean} True if extension marker exists\r\n   * @protected\r\n   */\r\n  _hasExtensionMarker(poi) {\r\n    // Check for extension's own overlay markers\r\n    // Classes: poi-overlay-marker, poi-native-marker-mapbox, poi-native-marker-realtor, poi-native-marker-generic\r\n    const selector = `[class*=\"poi-\"], [data-poi-id=\"${MapUtils.getPoiId(poi)}\"]`;\r\n    return !!document.querySelector(selector);\r\n  }\r\n\r\n  /**\r\n   * Checks if the site has already placed a native marker for this POI\r\n   * Used to skip rendering if site's own pins are visible\r\n   * Should be overridden by subclasses for site-specific detection\r\n   * @param {Object} poi - POI object\r\n   * @returns {boolean} True if site native marker exists\r\n   * @protected\r\n   */\r\n  _hasSiteNativeMarker(poi) {\r\n    // Base class: no site-specific markers to check\r\n    // Subclasses should override this method for site-specific detection\r\n    return false;\r\n  }\r\n\r\n  /**\r\n   * Checks if a marker (extension or site) already exists for this POI\r\n   * Combines both extension and site marker checks\r\n   * @param {Object} poi - POI object\r\n   * @returns {boolean} True if any marker exists\r\n   */\r\n  _hasNativeMarker(poi) {\r\n    if (typeof this._hasLoggedSiteMarker === 'undefined') {\r\n      this._hasLoggedSiteMarker = false;\r\n    }\r\n    \r\n    // Check if site has its own native marker\r\n    if (this._hasSiteNativeMarker(poi)) {\r\n      if (!this._hasLoggedSiteMarker) {\r\n        this.log('Site native marker detected, skipping overlay render');\r\n        this._hasLoggedSiteMarker = true;\r\n      }\r\n      return true;\r\n    }\r\n    \r\n    // Check if extension already rendered this marker\r\n    if (this._hasExtensionMarker(poi)) {\r\n      return true;\r\n    }\r\n    \r\n    return false;\r\n  }\r\n\r\n  /**\r\n   * Filters POIs to exclude those with native markers (site or extension)\r\n   * @param {Array} pois - Array of POI objects\r\n   * @returns {Array} Filtered POIs\r\n   */\r\n  _filterNativePois(pois) {\r\n    return pois.filter(poi => !this._hasNativeMarker(poi));\r\n  }\r\n\r\n  /**\r\n   * Filters POIs to only those within the current map bounds\r\n   * @param {Array} pois - Array of POI objects\r\n   * @returns {Array} Filtered POIs within bounds\r\n   */\r\n  filterByBounds(pois) {\r\n    const bounds = this.getBounds();\r\n    if (!bounds) return pois;\r\n\r\n    return pois.filter(poi => {\r\n      const lat = parseFloat(poi.latitude);\r\n      const lng = parseFloat(poi.longitude);\r\n      return (\r\n        lat >= bounds.south &&\r\n        lat <= bounds.north &&\r\n        lng >= bounds.west &&\r\n        lng <= bounds.east\r\n      );\r\n    });\r\n  }\r\n}\r\n\r\n// Export for ES modules and window global for script tag inclusion\r\nif (typeof window !== 'undefined') {\r\n  window.MapOverlayBase = MapOverlayBase;\r\n}\r\n", "// [SOURCE: overlays/GoogleMapsOverlayBase.js]\n/**\r\n * GoogleMapsOverlayBase - Base class for Google Maps overlays\r\n * \r\n * Extends MapOverlayBase with Google Maps-specific rendering using\r\n * a batched OverlayView for optimal performance.\r\n */\r\n\r\n// Ensure MapOverlayBase is available\r\nif (typeof MapOverlayBase === 'undefined' && typeof window !== 'undefined') {\r\n  // Will be loaded via script tag order in manifest\r\n}\r\n\r\n/**\r\n * GoogleMapsOverlayBase - Google Maps specific overlay implementation\r\n * \r\n * Features:\r\n * - Uses single OverlayView for all markers (batched rendering)\r\n * - Marker element pooling for performance\r\n * - Viewport culling (only renders visible markers)\r\n * - Event delegation for click/hover\r\n */\r\nclass GoogleMapsOverlayBase extends MapOverlayBase {\r\n  /**\r\n   * Creates a new GoogleMapsOverlayBase instance\r\n   * @param {boolean} debug - Enable debug logging\r\n   */\r\n  constructor(debug = false) {\r\n    super(debug);\r\n    this.markerPool = new MarkerPool();\r\n    this.batchOverlay = null;\r\n    this.activeElements = new Map(); // POI ID -> Element\r\n    this._nativeMarkersInjected = false; // Flag to track native marker injection\r\n    this._nativeMarkerPollInterval = null; // Periodic check for native markers\r\n\r\n    this.log(`[${this.constructor.name}] instance created. Debug:`, debug);\r\n\r\n    // --- Automatic native marker detection and overlay clearing ---\r\n    this._nativeMarkerObserver = null;\r\n    this._startNativeMarkerObserver();\r\n    this._startNativeMarkerPolling();\r\n  }\r\n\r\n  /**\r\n   * Sets up a MutationObserver to watch for native marker insertion and auto-clear overlays\r\n   * Subclasses should override _getNativeMarkerSelector() to provide site-specific selectors\r\n   */\r\n  _startNativeMarkerObserver() {\r\n    if (typeof window === 'undefined' || typeof document === 'undefined') return;\r\n    if (this._nativeMarkerObserver) return;\r\n    const callback = (mutationsList) => {\r\n      this.log('MutationObserver callback fired', mutationsList);\r\n      if (this._nativeMarkersInjected) return;\r\n      \r\n      // Use subclass-specific selector for native markers\r\n      const selector = this._getNativeMarkerSelector();\r\n      if (selector && document.querySelector(selector)) {\r\n        this._nativeMarkersInjected = true;\r\n        this.log('Native marker detected by MutationObserver, clearing overlay markers');\r\n        this.clear();\r\n      }\r\n    };\r\n    this._nativeMarkerObserver = new MutationObserver(callback);\r\n    this._nativeMarkerObserver.observe(document.body, { childList: true, subtree: true });\r\n  }\r\n\r\n  /**\r\n   * Gets the CSS selector for native markers on this site\r\n   * Override in subclass to provide site-specific selectors\r\n   * @returns {string|null} CSS selector or null if no native markers expected\r\n   * @protected\r\n   */\r\n  _getNativeMarkerSelector() {\r\n    return null; // Base class doesn't know about native markers\r\n  }\r\n\r\n  /**\r\n   * Starts periodic polling to check if native markers have appeared\r\n   * This catches cases where native markers are injected after overlay initialization\r\n   * (e.g., when debug window is opened, or after user interaction)\r\n   * Subclasses should override _getNativeMarkerSelector() to provide site-specific selectors\r\n   * @private\r\n   */\r\n  _startNativeMarkerPolling() {\r\n    if (typeof window === 'undefined' || typeof document === 'undefined') return;\r\n    if (this._nativeMarkerPollInterval) return;\r\n    \r\n    this.log('Starting native marker polling...');\r\n    \r\n    this._nativeMarkerPollInterval = setInterval(() => {\r\n      try {\r\n        // If already using native markers, stop polling\r\n        if (this._nativeMarkersInjected) {\r\n          this._stopNativeMarkerPolling();\r\n          return;\r\n        }\r\n        \r\n        // Use subclass-specific selector for native markers\r\n        const selector = this._getNativeMarkerSelector();\r\n        if (!selector) {\r\n          // No selector defined for this site, nothing to poll for\r\n          return;\r\n        }\r\n        \r\n        const nativeMarkers = document.querySelectorAll(selector);\r\n        if (nativeMarkers.length > 0) {\r\n          this._nativeMarkersInjected = true;\r\n          this.log(`Native markers detected by polling (${nativeMarkers.length} found), clearing overlay markers`);\r\n          this.clear();\r\n          this._stopNativeMarkerPolling();\r\n        }\r\n      } catch (e) {\r\n        this.log('Error during native marker polling:', e);\r\n      }\r\n    }, 1000); // Poll every 1 second\r\n  }\r\n\r\n  /**\r\n   * Stops the periodic native marker polling\r\n   * @private\r\n   */\r\n  _stopNativeMarkerPolling() {\r\n    if (this._nativeMarkerPollInterval) {\r\n      clearInterval(this._nativeMarkerPollInterval);\r\n      this._nativeMarkerPollInterval = null;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Disconnects the MutationObserver (call on cleanup)\r\n   */\r\n  _stopNativeMarkerObserver() {\r\n    if (this._nativeMarkerObserver) {\r\n      this._nativeMarkerObserver.disconnect();\r\n      this._nativeMarkerObserver = null;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * @override\r\n   * Checks if the given map instance is a Google Maps instance\r\n   * @param {Object} mapInstance - The map instance to check\r\n   * @returns {boolean} True if Google Maps\r\n   */\r\n  isCompatibleMap(mapInstance) {\r\n    return MapTypeDetector.isGoogleMap(mapInstance);\r\n  }\r\n\r\n  /**\r\n   * Creates the PoiBatchOverlay class (Google Maps OverlayView)\r\n   * This is created dynamically because it depends on google.maps being loaded\r\n   * @returns {Function} The PoiBatchOverlay class\r\n   * @private\r\n   */\r\n  _createBatchOverlayClass() {\r\n    if (window.PoiBatchOverlay) {\r\n      return window.PoiBatchOverlay;\r\n    }\r\n\r\n    if (!window.google || !window.google.maps || !window.google.maps.OverlayView) {\r\n      this.log('Google Maps API not available');\r\n      return null;\r\n    }\r\n\r\n    const self = this;\r\n\r\n    class PoiBatchOverlay extends window.google.maps.OverlayView {\r\n      constructor(mapInstance) {\r\n        super();\r\n        this.mapInstance = mapInstance;\r\n        this.container = document.createElement('div');\r\n        this.container.style.cssText = 'position: absolute; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none;';\r\n        this.pois = [];\r\n        this.hasPendingDraw = false;\r\n\r\n        // Event Delegation - Click\r\n        this.container.addEventListener('click', (e) => {\r\n          const target = e.target.closest('.poi-native-marker');\r\n          if (target) {\r\n            e.stopPropagation();\r\n            const id = target.getAttribute('data-id');\r\n            const lat = parseFloat(target.getAttribute('data-lat'));\r\n            const lng = parseFloat(target.getAttribute('data-lng'));\r\n            window.postMessage({ type: 'POI_MARKER_CLICK', id, lat, lng }, '*');\r\n          }\r\n        }, true);\r\n\r\n        // Event Delegation - Mouse Enter\r\n        this.container.addEventListener('mouseenter', (e) => {\r\n          const target = e.target.closest('.poi-native-marker');\r\n          if (target) {\r\n            target.style.zIndex = '1000000';\r\n            const id = target.getAttribute('data-id');\r\n            const lat = parseFloat(target.getAttribute('data-lat'));\r\n            const lng = parseFloat(target.getAttribute('data-lng'));\r\n            window.postMessage({ type: 'POI_MARKER_HOVER', id, lat, lng }, '*');\r\n          }\r\n        }, true);\r\n\r\n        // Event Delegation - Mouse Leave\r\n        this.container.addEventListener('mouseleave', (e) => {\r\n          const target = e.target.closest('.poi-native-marker');\r\n          if (target) {\r\n            target.style.zIndex = '102';\r\n            const id = target.getAttribute('data-id');\r\n            window.postMessage({ type: 'POI_MARKER_LEAVE', id }, '*');\r\n          }\r\n        }, true);\r\n      }\r\n\r\n      updatePois(newPois) {\r\n        this.pois = newPois;\r\n        if (newPois && newPois.length > 0) {\r\n          // Set flag to indicate native markers are injected\r\n          self._nativeMarkersInjected = true;\r\n        }\r\n        if (this.getProjection()) this.draw();\r\n      }\r\n\r\n      onAdd() {\r\n        this.getPanes().floatPane.appendChild(this.container);\r\n      }\r\n\r\n      onRemove() {\r\n        if (this.container.parentNode) {\r\n          this.container.parentNode.removeChild(this.container);\r\n        }\r\n      }\r\n\r\n      draw() {\r\n        if (this.hasPendingDraw) return;\r\n        this.hasPendingDraw = true;\r\n\r\n        requestAnimationFrame(() => {\r\n          this.hasPendingDraw = false;\r\n          this._drawBatch();\r\n        });\r\n      }\r\n\r\n      _drawBatch() {\r\n        const projection = this.getProjection();\r\n        if (!projection) return;\r\n\r\n        const bounds = this.mapInstance.getBounds();\r\n        if (!bounds) return;\r\n\r\n        const visibleIds = new Set();\r\n        const fragment = document.createDocumentFragment();\r\n\r\n        this.pois.forEach(poi => {\r\n          const lat = parseFloat(poi.latitude);\r\n          const lng = parseFloat(poi.longitude);\r\n          const latLng = new window.google.maps.LatLng(lat, lng);\r\n\r\n          // Bounds Check - skip markers outside viewport\r\n          if (!bounds.contains(latLng)) return;\r\n\r\n          const id = MapUtils.getPoiId(poi);\r\n          visibleIds.add(id);\r\n\r\n          const pos = projection.fromLatLngToDivPixel(latLng);\r\n\r\n          let el = self.activeElements.get(id);\r\n\r\n          if (!el) {\r\n            // Get from pool or create new\r\n            el = self.markerPool.acquire(() => {\r\n              const div = document.createElement('div');\r\n              div.className = 'poi-overlay-marker';\r\n              div.style.cssText = `\r\n                position: absolute; width: 32px; height: 32px;\r\n                background-size: contain; background-repeat: no-repeat;\r\n                pointer-events: auto; cursor: pointer; z-index: 102;\r\n                will-change: transform; top: 0; left: 0;\r\n                filter: drop-shadow(0px 2px 4px rgba(0,0,0,0.4));\r\n              `;\r\n              return div;\r\n            });\r\n\r\n            // Update visual content\r\n            const color = poi.color || '#ff0000';\r\n            const secondaryColor = poi.secondaryColor || '#ffffff';\r\n            const svg = MapUtils.generateFallbackSVG(color, secondaryColor, 32);\r\n            el.style.backgroundImage = `url('${poi.logoData || svg}')`;\r\n\r\n            // Store data attributes for delegation\r\n            el.setAttribute('data-id', id);\r\n            el.setAttribute('data-lat', lat);\r\n            el.setAttribute('data-lng', lng);\r\n\r\n            self.activeElements.set(id, el);\r\n            fragment.appendChild(el);\r\n          }\r\n\r\n          // Update position using transform (faster than top/left)\r\n          el.style.transform = `translate(-50%, -100%) translate(${Math.round(pos.x)}px, ${Math.round(pos.y)}px)`;\r\n        });\r\n\r\n        // Append new elements\r\n        if (fragment.childElementCount > 0) {\r\n          this.container.appendChild(fragment);\r\n        }\r\n\r\n        // Cleanup hidden elements (return to pool)\r\n        self.activeElements.forEach((el, id) => {\r\n          if (!visibleIds.has(id)) {\r\n            self.markerPool.release(el);\r\n            self.activeElements.delete(id);\r\n          }\r\n        });\r\n      }\r\n    }\r\n\r\n    window.PoiBatchOverlay = PoiBatchOverlay;\r\n    return PoiBatchOverlay;\r\n  }\r\n\r\n  /**\r\n   * @override\r\n   * Renders markers for Google Maps overlays\r\n   * @param {Array} pois - Array of POI objects\r\n   * @param {Object} mapInstance - The map instance\r\n   */\r\n  renderMarkers(pois, mapInstance) {\r\n    // If native markers have been injected, proactively clear overlays\r\n    if (this._nativeMarkersInjected) {\r\n      this.log('Native markers injected, clearing overlay markers');\r\n      this.clear(); // Remove overlay markers immediately\r\n      return;\r\n    }\r\n    const filteredPois = this._filterNativePois(pois);\r\n    if (!mapInstance) {\r\n      this.log('No map instance provided');\r\n      return;\r\n    }\r\n\r\n    // Ensure OverlayView class is created\r\n    const PoiBatchOverlay = this._createBatchOverlayClass();\r\n    if (!PoiBatchOverlay) {\r\n      this.log('Could not create PoiBatchOverlay class');\r\n      return;\r\n    }\r\n\r\n    // Create or get the batch layer for this map\r\n    if (!mapInstance._poiBatchLayer) {\r\n      mapInstance._poiBatchLayer = new PoiBatchOverlay(mapInstance);\r\n      mapInstance._poiBatchLayer.setMap(mapInstance);\r\n      this.batchOverlay = mapInstance._poiBatchLayer;\r\n    }\r\n\r\n    // Update POI data\r\n    mapInstance._poiBatchLayer.updatePois(filteredPois);\r\n    this.log(`Rendered ${filteredPois.length} markers`);\r\n  }\r\n\r\n  /**\r\n   * @override\r\n   * Creates a single marker element (used for individual marker creation)\r\n   * @param {Object} poi - POI object\r\n   * @param {Object} map - Google Maps instance\r\n   * @returns {HTMLElement} The marker element\r\n   */\r\n  createMarker(poi, map) {\r\n    const el = document.createElement('div');\r\n    el.className = 'poi-overlay-marker';\r\n    \r\n    const color = poi.color || '#ff0000';\r\n    const secondaryColor = poi.secondaryColor || '#ffffff';\r\n    const svg = MapUtils.generateFallbackSVG(color, secondaryColor, 32);\r\n    \r\n    el.style.cssText = `\r\n      position: absolute; width: 32px; height: 32px;\r\n      background-image: url('${poi.logoData || svg}');\r\n      background-size: contain; background-repeat: no-repeat;\r\n      pointer-events: auto; cursor: pointer; z-index: 102;\r\n      filter: drop-shadow(0px 2px 4px rgba(0,0,0,0.4));\r\n    `;\r\n    \r\n    el.setAttribute('data-id', MapUtils.getPoiId(poi));\r\n    el.setAttribute('data-lat', poi.latitude);\r\n    el.setAttribute('data-lng', poi.longitude);\r\n\r\n    return el;\r\n  }\r\n\r\n  /**\r\n   * @override\r\n   * Clears all markers\r\n   */\r\n  clear() {\r\n    // Return all active elements to pool\r\n    this.activeElements.forEach((el, id) => {\r\n      this.markerPool.release(el);\r\n    });\r\n    this.activeElements.clear();\r\n\r\n    // Clear batch overlay if exists\r\n    if (this.batchOverlay) {\r\n      this.batchOverlay.updatePois([]);\r\n    }\r\n\r\n    super.clear();\r\n  }\r\n\r\n  /**\r\n   * @override\r\n   * Cleanup resources\r\n   */\r\n  cleanup() {\r\n    this.clear();\r\n    this.markerPool.clear();\r\n    \r\n    if (this.batchOverlay) {\r\n      this.batchOverlay.setMap(null);\r\n      this.batchOverlay = null;\r\n    }\r\n\r\n    this._stopNativeMarkerObserver();\r\n    this._stopNativeMarkerPolling();\r\n\r\n    super.cleanup();\r\n  }\r\n}\r\n\r\n// Export for different module systems\r\nif (typeof window !== 'undefined') {\r\n  window.GoogleMapsOverlayBase = GoogleMapsOverlayBase;\r\n}\r\n", "// [SOURCE: overlays/MapboxOverlayBase.js]\n/**\r\n * MapboxOverlayBase - Base class for Mapbox GL JS overlays\r\n * \r\n * Extends MapOverlayBase with Mapbox-specific rendering using\r\n * native Mapbox markers with custom HTML elements.\r\n */\r\n\r\n// Ensure MapOverlayBase is available\r\nif (typeof MapOverlayBase === 'undefined' && typeof window !== 'undefined') {\r\n  // Will be loaded via script tag order in manifest\r\n}\r\n\r\n/**\r\n * MapboxOverlayBase - Mapbox GL JS specific overlay implementation\r\n * \r\n * Features:\r\n * - Uses native Mapbox markers with custom elements\r\n * - Automatic marker lifecycle management\r\n * - Click/hover event handling\r\n * - Inline z-index styles for proper stacking\r\n */\r\nclass MapboxOverlayBase extends MapOverlayBase {\r\n  /**\r\n   * Creates a new MapboxOverlayBase instance\r\n   * @param {boolean} debug - Enable debug logging\r\n   */\r\n  constructor(debug = false) {\r\n    super(debug);\r\n    this.activeMarkers = new Map(); // POI ID -> Mapbox Marker instance\r\n    this._nativeMarkersInjected = false; // Flag to track native marker injection\r\n    this._nativeMarkerObserver = null;\r\n    this._nativeMarkerPollInterval = null; // Periodic check for native markers\r\n\r\n    this.log(`[${this.constructor.name}] instance created. Debug:`, debug);\r\n\r\n    // --- Automatic native marker detection and overlay clearing ---\r\n    this._startNativeMarkerObserver();\r\n    this._startNativeMarkerPolling();\r\n  }\r\n\r\n  /**\r\n   * Sets up a MutationObserver to watch for native marker insertion and auto-clear overlays\r\n   * Subclasses should override _getNativeMarkerSelector() to provide site-specific selectors\r\n   */\r\n  _startNativeMarkerObserver() {\r\n    if (typeof window === 'undefined' || typeof document === 'undefined') return;\r\n    if (this._nativeMarkerObserver) return;\r\n    const callback = (mutationsList) => {\r\n      if (this._nativeMarkersInjected) return;\r\n      \r\n      // Use subclass-specific selector for native markers\r\n      const selector = this._getNativeMarkerSelector();\r\n      if (selector && document.querySelector(selector)) {\r\n        this._nativeMarkersInjected = true;\r\n        this.log('Native marker detected by MutationObserver, clearing overlay markers');\r\n        this.clear();\r\n      }\r\n    };\r\n    this._nativeMarkerObserver = new MutationObserver(callback);\r\n    this._nativeMarkerObserver.observe(document.body, { childList: true, subtree: true });\r\n  }\r\n\r\n  /**\r\n   * Stops the periodic native marker polling\r\n   * @private\r\n   */\r\n  _stopNativeMarkerPolling() {\r\n    if (this._nativeMarkerPollInterval) {\r\n      clearInterval(this._nativeMarkerPollInterval);\r\n      this._nativeMarkerPollInterval = null;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Starts periodic polling to check if native markers have appeared\r\n   * Subclasses should override _getNativeMarkerSelector() to provide site-specific selectors\r\n   * @private\r\n   */\r\n  _startNativeMarkerPolling() {\r\n    if (typeof window === 'undefined' || typeof document === 'undefined') return;\r\n    if (this._nativeMarkerPollInterval) return;\r\n    \r\n    this.log('Starting native marker polling...');\r\n    \r\n    this._nativeMarkerPollInterval = setInterval(() => {\r\n      try {\r\n        // If already using native markers, stop polling\r\n        if (this._nativeMarkersInjected) {\r\n          this._stopNativeMarkerPolling();\r\n          return;\r\n        }\r\n        \r\n        // Use subclass-specific selector for native markers\r\n        const selector = this._getNativeMarkerSelector();\r\n        if (!selector) {\r\n          // No selector defined for this site, nothing to poll for\r\n          return;\r\n        }\r\n        \r\n        const nativeMarkers = document.querySelectorAll(selector);\r\n        if (nativeMarkers.length > 0) {\r\n          this._nativeMarkersInjected = true;\r\n          this.log(`Native markers detected by polling (${nativeMarkers.length} found), clearing overlay markers`);\r\n          this.clear();\r\n          this._stopNativeMarkerPolling();\r\n        }\r\n      } catch (e) {\r\n        this.log('Error during native marker polling:', e);\r\n      }\r\n    }, 1000); // Poll every 1 second\r\n  }\r\n\r\n  /**\r\n   * Gets the CSS selector for native markers on this site\r\n   * Override in subclass to provide site-specific selectors\r\n   * @returns {string|null} CSS selector or null if no native markers expected\r\n   * @protected\r\n   */\r\n  _getNativeMarkerSelector() {\r\n    return null; // Base class doesn't know about native markers\r\n  }\r\n\r\n  /**\r\n   * Disconnects the MutationObserver (call on cleanup)\r\n   */\r\n  _stopNativeMarkerObserver() {\r\n    if (this._nativeMarkerObserver) {\r\n      this._nativeMarkerObserver.disconnect();\r\n      this._nativeMarkerObserver = null;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * @override\r\n   * Checks if the given map instance is a Mapbox GL JS instance\r\n   * @param {Object} mapInstance - The map instance to check\r\n   * @returns {boolean} True if Mapbox GL JS\r\n   */\r\n  isCompatibleMap(mapInstance) {\r\n    return MapTypeDetector.isMapbox(mapInstance);\r\n  }\r\n\r\n  /**\r\n   * Gets the z-index for markers (can be overridden by subclasses)\r\n   * @returns {number} The z-index value\r\n   */\r\n  getMarkerZIndex() {\r\n    return 10;\r\n  }\r\n\r\n  /**\r\n   * @override\r\n   * Renders markers for Mapbox overlays\r\n   * @param {Array} pois - Array of POI objects\r\n   * @param {Object} mapInstance - The map instance\r\n   */\r\n  renderMarkers(pois, mapInstance) {\r\n    // If native markers have been injected, proactively clear overlays\r\n    if (this._nativeMarkersInjected) {\r\n      this.log('Native markers injected, clearing overlay markers');\r\n      this.clear();\r\n      return;\r\n    }\r\n\r\n    // Check if native mode is active via state\r\n    if (typeof window !== 'undefined' && window.poiState && window.poiState.nativeMode) {\r\n      this.log('Native mode active, clearing overlay markers');\r\n      this.clear();\r\n      return;\r\n    }\r\n\r\n    const filteredPois = this._filterNativePois(pois);\r\n\r\n    if (!mapInstance) {\r\n      this.log('No map instance provided');\r\n      return;\r\n    }\r\n\r\n    if (!window.mapboxgl || !window.mapboxgl.Marker) {\r\n      this.log('Mapbox GL JS not available');\r\n      return;\r\n    }\r\n\r\n    // Generate unique ID for this map if not exists\r\n    if (!mapInstance._poiUid) {\r\n      mapInstance._poiUid = Math.random().toString(36).substr(2, 9);\r\n    }\r\n\r\n    const usedIds = new Set();\r\n\r\n    filteredPois.forEach(poi => {\r\n      const id = `${mapInstance._poiUid}-${MapUtils.getPoiId(poi)}`;\r\n      usedIds.add(id);\r\n\r\n      // Skip if marker already exists\r\n      if (this.activeMarkers.has(id)) {\r\n        return;\r\n      }\r\n\r\n      // Create marker element and Mapbox marker\r\n      const marker = this.createMarker(poi, mapInstance);\r\n      \r\n      // Store reference\r\n      this.activeMarkers.set(id, marker);\r\n      this.markers.set(id, marker);\r\n    });\r\n\r\n    // Cleanup markers no longer in POI list\r\n    this.activeMarkers.forEach((marker, id) => {\r\n      if (id.startsWith(mapInstance._poiUid) && !usedIds.has(id)) {\r\n        this.removeMarker(marker);\r\n        this.activeMarkers.delete(id);\r\n        this.markers.delete(id);\r\n      }\r\n    });\r\n\r\n    this.log(`Rendered ${filteredPois.length} markers, active: ${this.activeMarkers.size}`);\r\n  }\r\n\r\n  /**\r\n   * @override\r\n   * Creates a single Mapbox marker for a POI\r\n   * @param {Object} poi - POI object\r\n   * @param {Object} map - Mapbox GL JS instance\r\n   * @returns {Object} The Mapbox Marker instance\r\n   */\r\n  createMarker(poi, map) {\r\n    const el = this.createMarkerElement(poi);\r\n    \r\n    // Create Mapbox marker with custom element\r\n    const marker = new window.mapboxgl.Marker({ element: el })\r\n      .setLngLat([parseFloat(poi.longitude), parseFloat(poi.latitude)])\r\n      .addTo(map);\r\n\r\n    return marker;\r\n  }\r\n\r\n  /**\r\n   * Creates the DOM element for a marker\r\n   * Can be overridden by subclasses for custom styling\r\n   * @param {Object} poi - POI object\r\n   * @returns {HTMLElement} The marker element\r\n   */\r\n  createMarkerElement(poi) {\r\n    const el = document.createElement('div');\r\n    el.className = 'poi-native-marker-mapbox';\r\n\r\n    const color = poi.color || '#ff0000';\r\n    const secondaryColor = poi.secondaryColor || '#ffffff';\r\n    const logo = poi.logoData;\r\n    const zIndex = this.getMarkerZIndex();\r\n\r\n    // Fallback SVG if no logo\r\n    const fallbackSvg = MapUtils.generateFallbackSVG(color, secondaryColor, 32);\r\n\r\n    el.style.cssText = `\r\n      width: 32px;\r\n      height: 32px;\r\n      cursor: pointer;\r\n      position: relative;\r\n      z-index: ${zIndex};\r\n      background-image: url('${logo || fallbackSvg}');\r\n      background-size: contain;\r\n      background-repeat: no-repeat;\r\n      filter: drop-shadow(0px 2px 4px rgba(0,0,0,0.4));\r\n    `;\r\n\r\n    // Store POI data on element\r\n    el.setAttribute('data-id', MapUtils.getPoiId(poi));\r\n    el.setAttribute('data-lat', poi.latitude);\r\n    el.setAttribute('data-lng', poi.longitude);\r\n\r\n    // Click handler\r\n    el.onclick = (e) => {\r\n      e.stopPropagation();\r\n      window.postMessage({\r\n        type: 'POI_MARKER_CLICK',\r\n        id: poi.id,\r\n        lat: poi.latitude,\r\n        lng: poi.longitude\r\n      }, '*');\r\n    };\r\n\r\n    // Hover handlers\r\n    el.onmouseenter = () => {\r\n      el.style.zIndex = '1000000';\r\n      window.postMessage({\r\n        type: 'POI_MARKER_HOVER',\r\n        id: poi.id,\r\n        lat: poi.latitude,\r\n        lng: poi.longitude\r\n      }, '*');\r\n    };\r\n\r\n    el.onmouseleave = () => {\r\n      el.style.zIndex = String(zIndex);\r\n      window.postMessage({\r\n        type: 'POI_MARKER_LEAVE',\r\n        id: poi.id\r\n      }, '*');\r\n    };\r\n\r\n    return el;\r\n  }\r\n\r\n  /**\r\n   * @override\r\n   * Removes a Mapbox marker\r\n   * @param {Object} marker - The Mapbox Marker instance\r\n   */\r\n  removeMarker(marker) {\r\n    if (marker && typeof marker.remove === 'function') {\r\n      marker.remove();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * @override\r\n   * Clears all markers\r\n   */\r\n  clear() {\r\n    this.activeMarkers.forEach((marker, id) => {\r\n      this.removeMarker(marker);\r\n    });\r\n    this.activeMarkers.clear();\r\n    super.clear();\r\n  }\r\n\r\n  /**\r\n   * @override\r\n   * Cleanup resources\r\n   */\r\n  cleanup() {\r\n    this.clear();\r\n    this._stopNativeMarkerObserver();\r\n    this._stopNativeMarkerPolling();\r\n    super.cleanup();\r\n  }\r\n\r\n  /**\r\n   * @override\r\n   * Gets the current map bounds from a Mapbox map\r\n   * @returns {Object|null} Bounds object with north, south, east, west or null\r\n   */\r\n  getBounds() {\r\n    if (!this.mapInstance) return null;\r\n\r\n    try {\r\n      const b = this.mapInstance.getBounds();\r\n      if (!b) return null;\r\n\r\n      return {\r\n        north: b.getNorth(),\r\n        south: b.getSouth(),\r\n        east: b.getEast(),\r\n        west: b.getWest()\r\n      };\r\n    } catch (e) {\r\n      this.log('Error getting bounds:', e);\r\n    }\r\n\r\n    return null;\r\n  }\r\n\r\n  /**\r\n   * Filters out POIs with native markers\r\n   * @param {Array} pois - Array of POI objects\r\n   * @returns {Array} Filtered POI objects\r\n   */\r\n  _filterNativePois(pois) {\r\n    return pois.filter(poi => !this._hasNativeMarker(poi));\r\n  }\r\n\r\n  /**\r\n   * Checks if a POI has a native marker in the DOM\r\n   * Queries the DOM for markers with any native-marker class variant\r\n   * @param {Object} poi - POI object\r\n   * @returns {boolean} True if the POI has a native marker\r\n   */\r\n  _hasNativeMarker(poi) {\r\n    if (typeof this._hasLoggedNativeMarker === 'undefined') {\r\n      this._hasLoggedNativeMarker = false;\r\n      this._nativeMarkerPreviouslyFound = false;\r\n    }\r\n\r\n    // Check for EXACT class \"poi-native-marker\" - only Google Maps batch overlay creates this\r\n    const selector = `.poi-native-marker[data-id=\"${MapUtils.getPoiId(poi)}\"]`;\r\n    const found = !!document.querySelector(selector);\r\n\r\n    // Only log once when native marker is first detected\r\n    if (found && !this._hasLoggedNativeMarker && !this._nativeMarkerPreviouslyFound) {\r\n      this.log('Native marker detected');\r\n      this._hasLoggedNativeMarker = true;\r\n    }\r\n    // Track if native marker was ever found\r\n    if (found) {\r\n      this._nativeMarkerPreviouslyFound = true;\r\n    }\r\n    return found;\r\n  }\r\n}\r\n\r\n// Export for different module systems\r\nif (typeof window !== 'undefined') {\r\n  window.MapboxOverlayBase = MapboxOverlayBase;\r\n}\r\n"],
  "mappings": "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",
  "names": ["MapUtils", "MarkerPool", "MapTypeDetector", "HijackedMap", "entry", "ManagerBase", "MapOverlayBase", "GoogleMapsOverlayBase", "MapboxOverlayBase"]
}
